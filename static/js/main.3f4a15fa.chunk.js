(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{149:function(e,t,a){e.exports=a.p+"static/media/banner.ed2bb0d2.png"},150:function(e,t,a){e.exports=a.p+"static/media/work_flow.195ff4f9.png"},157:function(e,t,a){e.exports=a(298)},264:function(e,t,a){},286:function(e,t,a){},298:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(24),o=a.n(c),s=a(14),l=a(12),i=a(93),u=a(143),p=a.n(u),m=a(153),d=!1,h=!1,f=!0,g=!1,b="0.70.0",v="https://staging.osmcha.org/api/v1";f&&(v="https://osmcha.org/api/v1"),window.debug_info=function(){return"isDev=".concat(d.toString()," isStaging=").concat(h.toString()," isProd=").concat(f.toString()," isLocal=").concat(g.toString()," stack=").concat("PRODUCTION"," appVersion=").concat(b||"null"," url=").concat(v)};var y=v,x={};d&&(x.basename="/osmcha-frontend");var E=Object(m.a)(x),k=a(53),O=a(4),A=a(37);function j(e){try{return localStorage.getItem(e)||null}catch(t){return console.warn("Could not read from localStorage."),null}}function w(e,t){try{localStorage.setItem(e,t)}catch(a){console.warn("Could not write to localStorage.")}}function N(e){try{localStorage.removeItem(e)}catch(t){console.warn("Could not delete from localStorage.")}}var C=a(10),I=a.n(C),S=a(13),T=a(2),D=a(95),R=a.n(D),_=75,M="pk.eyJ1Ijoib3BlbnN0cmVldG1hcCIsImEiOiJjam10OXpmc2YwMXI5M3BqeTRiMDBqMHVyIn0.LIcIDe3TZLSDdTWDoojzNg",P="https://raw.githubusercontent.com/mapbox/osmcha-frontend/status/status.json",U="".concat(y,"/social-auth/"),F="https://www.openstreetmap.org/oauth/authorize",B="https://api.openstreetmap.org/api/0.6",L="https://rksbsqdel4.execute-api.us-east-1.amazonaws.com/testing?action=names&id=",H="https://nominatim.openstreetmap.org/search.php",G=7,V=5;function W(e){return"object"===typeof e?JSON.stringify(e):e}function J(e){return e.ok?e:e.json().then(function(t){if(401===e.status)throw new Error("Authentication error. Sign in again and repeat the operation.");if(401===e.status)throw new Error("Operation not allowed.");if(404===e.status)throw new Error("Resource not found.");if(t&&t.detail)throw new Error(t.detail);if(e.statusText)throw new Error(e.statusText);return Promise.reject("network request failed")})}function z(e,t,a){var n={};return a.forEach(function(e,t){if(O.Iterable.isIterable(e)){var a=e;n[t]=a.filter(function(e){return O.Iterable.isIterable(e)&&""!==e.get("value")}).map(function(e){return W(e.get("value"))}).join(",")}}),fetch("".concat(y,"/aoi/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""},body:JSON.stringify({name:t,filters:n})}).then(J).then(function(e){return e.json()})}function Y(e,t){return fetch("".concat(y,"/aoi/").concat(t,"/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""}}).then(J).then(function(e){return e.json()})}function K(e){return null==e?Promise.resolve():fetch("".concat(y,"/aoi/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""}}).then(J).then(function(e){return e.json()})}function Q(e,t,a,n){var r={};return n.forEach(function(e,t){if(O.Iterable.isIterable(e)){var a=e;r[t]=a.filter(function(e){return O.Iterable.isIterable(e)&&""!==e.get("value")}).map(function(e){return W(e.get("value"))}).join(",")}}),fetch("".concat(y,"/aoi/").concat(t,"/"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""},body:JSON.stringify({name:a,filters:r})}).then(J).then(function(e){return e.json()})}function q(e,t){return fetch("".concat(y,"/aoi/").concat(t,"/"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""}}).then(J)}function X(e,t,a){return R.a.post(U).type("form").send({oauth_token:e}).send({oauth_verifier:a}).send({oauth_token_secret:t}).then(function(e){return e.body}).catch(function(e){return console.error(e),Promise.reject(e)})}function Z(){return R.a.post(U).type("form").then(function(e){return e.body}).catch(function(e){return console.error(e),Promise.reject(e)})}function $(e){return fetch("".concat(y,"/users/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""}}).then(J).then(function(e){return e.json()})}function ee(e,t,a,n){return fetch("".concat(y,"/users/"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""},body:JSON.stringify({message_good:t,message_bad:a,comment_feature:n})}).then(J).then(function(e){return e.json()})}function te(e,t){return fetch("".concat(P),{method:"GET"}).then(J).then(function(e){return e.json()})}function ae(e,t){return fetch("".concat(y,"/changesets/").concat(e,"/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:t?"Token ".concat(t):""}}).then(J).then(function(e){return e.json()})}function ne(e,t,a){var n;return n=-1===a?"".concat(y,"/changesets/").concat(e,"/uncheck/"):"".concat(y,"/changesets/").concat(e,"/").concat(a?"set-harmful":"set-good","/"),fetch(n,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:t?"Token ".concat(t):""}}).then(J).then(function(e){return e.json()})}var re=function(e){var t=new FormData;return Object.keys(e).forEach(function(a){t.append(a,e[a])}),t};function ce(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Number.isNaN(parseInt(a.value,10)))throw new Error("tag is not a valid number");return fetch("".concat(y,"/changesets/").concat(e,"/tags/").concat(a.value,"/"),{method:n?"DELETE":"POST",headers:{"Content-Type":"application/json",Authorization:t?"Token ".concat(t):""},body:re({tag_pk:a,id:e})}).then(J).then(function(e){return e.json()})}function oe(e){return fetch("".concat(y,"/blacklisted-users/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""}}).then(J).then(function(e){return e.json()})}function se(e,t){return fetch("".concat(y,"/blacklisted-users/").concat(t,"/"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""}}).then(J)}function le(e,t){return fetch("".concat(y,"/blacklisted-users/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""},body:JSON.stringify({username:t.blacklist_user.username,uid:t.blacklist_user.uid})}).then(J).then(function(e){return e.json()})}var ie=a(71),ue=I.a.mark(be),pe=I.a.mark(ve),me="SHOW_MODAL",de="ACTIVATE_MODAL_CALLBACK",he="DISMISS_MODAL";function fe(e){var t=e.kind,a=void 0===t?"error":t,n=e.error,r=e.title,c=e.dismiss,o=void 0===c||c,s=e.autoDismiss,l=void 0===s?5:s,i=e.position,u=void 0===i?"tr":i,p=e.description,m=void 0===p?"Please reload the application. If it still doesnt work please refer to usage guide.":p,d=e.callback,h=e.callbackArgs,f=e.callbackLabel;return n&&n.message&&(m=n.message),n&&n.name&&(r=n.name),"error"===a&&(l=10),{type:"INIT_MODAL",payload:{kind:a,error:n,callbackLabel:f,title:r,dismiss:o,autoDismiss:l,position:u,description:m},callback:d,callbackArgs:h}}function ge(e,t){return Object(S.a)({type:e},t)}function be(){return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(T.h)("INIT_MODAL",ve);case 2:case"end":return e.stop()}},ue)}function ve(e){var t,a,n,r,c,o,s;return I.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=e.payload,a=e.callback,n=e.callbackArgs,r=(new Date).getTime()+parseInt(1e3*Math.random(),10),t.uid=r,l.next=5,Object(T.e)(ge(me,t));case 5:if(a){l.next=7;break}return l.abrupt("return");case 7:return l.next=10,Object(T.g)([de,he]);case 10:if(c=l.sent,o=c.type,s=c.uid,o!==he||r!==s){l.next=15;break}return l.abrupt("return");case 15:if(o!==de||r!==s){l.next=21;break}return l.next=18,Object(T.b)(A.b,500);case 18:return l.next=20,Object(T.e)(a.apply(void 0,Object(ie.a)(n)));case 20:return l.abrupt("return");case 21:l.next=7;break;case 23:case"end":return l.stop()}},pe)}function ye(e,t){return fetch("".concat(y,"/whitelist-user/").concat(t,"/"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""}}).then(J)}function xe(e,t){return fetch("".concat(y,"/whitelist-user/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""},body:JSON.stringify({whitelist_user:t})}).then(J).then(function(e){return e.json()})}var Ee=I.a.mark(Ie),ke=I.a.mark(Se),Oe=I.a.mark(Te),Ae={define:"WHITELIST.define",add:"WHITELIST.add",remove:"WHITELIST.remove",clear:"WHITELIST.clear"};function je(e,t){return Object(S.a)({type:e},t)}var we=function(e){return e.auth.get("token")},Ne=function(e){return je(Ae.add,{whitelist_user:e})},Ce=function(e){return je(Ae.remove,{whitelist_user:e})};function Ie(){return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(T.a)([Object(T.h)(Ae.add,Se),Object(T.h)(Ae.remove,Te)]);case 2:case"end":return e.stop()}},Ee)}function Se(e){var t;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(T.f)(we);case 3:return t=a.sent,a.next=6,Object(T.b)(xe,t,e.whitelist_user);case 6:return a.next=8,Object(T.e)(fe({title:"Success",description:"User ".concat(e.whitelist_user," added to your Trusted Users list."),kind:"success"}));case 8:a.next=15;break;case 10:return a.prev=10,a.t0=a.catch(0),console.error(a.t0),a.next=15,Object(T.e)(fe({error:a.t0}));case 15:case"end":return a.stop()}},ke,null,[[0,10]])}function Te(e){var t;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(T.f)(we);case 3:return t=a.sent,a.next=6,Object(T.b)(ye,t,e.whitelist_user);case 6:return a.next=8,Object(T.e)(fe({title:"Success",description:"User ".concat(e.whitelist_user," removed from your Trusted Users list."),kind:"success"}));case 8:a.next=15;break;case 10:return a.prev=10,a.t0=a.catch(0),console.error(a.t0),a.next=15,Object(T.e)(fe({error:a.t0}));case 15:case"end":return a.stop()}},Oe,null,[[0,10]])}var De=I.a.mark(Le),Re=I.a.mark(He),_e=I.a.mark(Ge),Me={define:"BLACKLIST.define",add:"BLACKLIST.add",remove:"BLACKLIST.remove",clear:"BLACKLIST.clear"};function Pe(e,t){return Object(S.a)({type:e},t)}var Ue=function(e){return e.auth.get("token")},Fe=function(e,t){return Pe(Me.add,{blacklist_user:e,uid:t})},Be=function(e){return Pe(Me.remove,{blacklist_user:e})};function Le(){return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(T.a)([Object(T.h)(Me.add,He),Object(T.h)(Me.remove,Ge)]);case 2:case"end":return e.stop()}},De)}function He(e){var t;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(T.f)(Ue);case 3:return t=a.sent,a.next=6,Object(T.b)(le,t,e);case 6:return a.next=8,Object(T.e)(fe({title:"Success",description:"User ".concat(e.blacklist_user.username," (").concat(e.blacklist_user.uid,") added to your watchlist."),kind:"success"}));case 8:a.next=15;break;case 10:return a.prev=10,a.t0=a.catch(0),console.error(a.t0),a.next=15,Object(T.e)(fe({error:a.t0}));case 15:case"end":return a.stop()}},Re,null,[[0,10]])}function Ge(e){var t;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(T.f)(Ue);case 3:return t=a.sent,a.next=6,Object(T.b)(se,t,e.blacklist_user);case 6:return a.next=8,Object(T.e)(fe({title:"Success",description:"User ".concat(e.blacklist_user," removed from your watchlist."),kind:"success"}));case 8:a.next=15;break;case 10:return a.prev=10,a.t0=a.catch(0),console.error(a.t0),a.next=15,Object(T.e)(fe({error:a.t0}));case 15:case"end":return a.stop()}},_e,null,[[0,10]])}var Ve=a(42),We=a(21),Je=a.n(We);function ze(e){if(function(){if(!O.Map.isMap(e))return!1;var t=!0;return e.forEach(function(e,a){O.List.isList(e)?e.forEach(function(e){O.Map.isMap(e)&&e.has("label")&&e.has("value")||(t=!1),O.Map.isMap(e)||(t=!1)}):t=!1}),t}())return!0;throw new Error("The filters that you applied were not correct.")}function Ye(){var e=Je()().subtract(G,"days").format("YYYY-MM-DD");return Object(O.fromJS)({date__gte:[{label:e,value:e}]})}function Ke(e){return!e||e.has("date__gte")||e.has("date__lte")||(e=e.merge(Ye())),e&&!e.has("date__lte")&&(e=e.merge(function(){var e=Je()().subtract(V,"minutes").utc().format("YYYY-MM-DD HH:mm");return Object(O.fromJS)({date__lte:[{label:"",value:e}]})}())),e}function Qe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(O.Map)(),a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,c="";(t=Ke(t)).forEach(function(e,t){if(O.Iterable.isIterable(e)){var a=e.filter(function(e){return O.Iterable.isIterable(e)&&""!==e.get("value")}).map(function(e){return W(e.get("value"))}).join(",");""!==a&&(c+="&".concat(t,"=").concat(encodeURIComponent(a)))}});var o="".concat(y,"/changesets/?").concat(n?"page_size=".concat(_,"&page=").concat(e+1):"page=".concat(e+1,"&page_size=").concat(_)).concat(c);return r&&(o="".concat(y,"/aoi/").concat(r,"/changesets/?").concat(n?"page_size=".concat(_,"&page=").concat(e+1):"page=".concat(e+1,"&page_size=").concat(_))),fetch(o,{method:"GET",headers:{"Content-Type":"application/json",Authorization:a?"Token ".concat(a):""}}).then(function(e){return 401===e.status?Promise.reject(Error("Authentication error. Sign in again and repeat the operation.")):403===e.status?Promise.reject(Error("Operation not allowed.")):e.status>=400&&e.status<600?Promise.reject(Error("Bad request. Please check your filters or your network connection.")):e.json()})}var qe=a(67),Xe=a(96);function Ze(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={};try{(t=Object(Xe.parse)(e)).filters&&(t.filters=JSON.parse(t.filters))}catch(a){console.error(a)}finally{return Object(O.fromJS)(t)}}function $e(e,t){return t&&0!==Object.keys(t).length?Object(Xe.stringify)(Object(qe.a)({},e,JSON.stringify(t))):""}function et(e){return fetch("".concat(y,"/suspicion-reasons/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""}}).then(J).then(function(e){return e.json()})}function tt(e){return fetch("".concat(y,"/tags/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""}}).then(J).then(function(e){return e.json()})}var at=I.a.mark(lt),nt=I.a.mark(it),rt=I.a.mark(ut),ct=I.a.mark(pt),ot={fetch:"AOI.fetch",clear:"AOI.clear",fetched:"AOI.fetched",create:"AOI.create",update:"AOI.update",loading:"AOI.loading",error:"AOI.error"};function st(e,t){return Object(S.a)({type:e},t)}function lt(){return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(T.a)([Object(T.i)(ot.update,pt),Object(T.i)(ot.create,ut)]);case 2:case"end":return e.stop()}},at)}function it(e){var t,a,n,r,c,o;return I.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(T.e)(st(ot.loading,{loading:!0}));case 2:return s.next=4,Object(T.f)(Ca);case 4:return t=s.sent,s.next=7,Object(T.b)(Y,t,e);case 7:return a=s.sent,s.next=10,Object(T.b)(et,t);case 10:return n=s.sent,s.next=13,Object(T.b)(tt,t);case 13:return r=s.sent,c=Object(O.fromJS)(a),s.next=17,Object(T.e)(st(ot.fetched,{aoi:c}));case 17:return o=(o=c.getIn(["properties","filters"],Object(O.Map)())).map(function(e,t){if("reasons"===t)return Object(O.fromJS)(e.split(",").map(function(e){return{value:e,label:n.filter(function(t){return t.id==e})[0].name}}));if("tags"===t)return Object(O.fromJS)(e.split(",").map(function(e){return{value:e,label:r.filter(function(t){return t.id==e})[0].name}}));try{if(JSON.parse(e)&&JSON.parse(e).hasOwnProperty("coordinates"))return Object(O.fromJS)([{value:JSON.parse(e),label:JSON.parse(e)}]);throw SyntaxError}catch(c){var a=e.split(",");return Object(O.fromJS)(a.map(function(e){return{value:e,label:e}}))}}),s.abrupt("return",o);case 20:case"end":return s.stop()}},nt)}function ut(e){var t,a,n,r,c,o;return I.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=e.name,a=e.filters,l.prev=1,l.next=4,Object(T.e)(st(ot.loading,{loading:!0}));case 4:return l.next=6,Object(T.f)(Ca);case 6:return n=l.sent,l.next=9,Object(T.b)(z,n,t,a);case 9:return r=l.sent,c=Object(O.fromJS)(r),l.next=13,Object(T.e)(st(ot.fetched,{aoi:c}));case 13:return l.next=15,Object(T.f)(mt);case 15:return o=l.sent,l.next=18,Object(T.e)(Object(s.c)(Object(S.a)({},o,{pathname:o.pathname,search:"aoi=".concat(r.id)})));case 18:l.next=25;break;case 20:return l.prev=20,l.t0=l.catch(1),console.error(l.t0),l.next=25,Object(T.e)(fe({error:l.t0}));case 25:case"end":return l.stop()}},rt,null,[[1,20]])}function pt(e){var t,a,n,r,c,o;return I.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.aoiId,a=e.name,n=e.filters,s.prev=1,s.next=4,Object(T.e)(st(ot.loading,{loading:!0}));case 4:return s.next=6,Object(T.f)(Ca);case 6:return r=s.sent,s.next=9,Object(T.b)(Q,r,t,a,n);case 9:return c=s.sent,o=Object(O.fromJS)(c),s.next=13,Object(T.e)(st(ot.fetched,{aoi:o}));case 13:return s.next=15,Object(T.b)(ze,n);case 15:return s.next=17,Object(T.e)(st(vt.set,{filters:n}));case 17:return s.next=19,Object(T.e)(st(bt.fetch,{pageIndex:0,aoiId:t,filters:n}));case 19:s.next=26;break;case 21:return s.prev=21,s.t0=s.catch(1),console.error(s.t0),s.next=26,Object(T.e)(fe({error:s.t0}));case 26:case"end":return s.stop()}},ct,null,[[1,21]])}var mt=function(e){return e.routing.location},dt=I.a.mark(Et),ht=I.a.mark(kt),ft=I.a.mark(Ot),gt=I.a.mark(At),bt={fetch:"CHANGESETS_PAGE_FETCH",fetched:"CHANGESETS_PAGE_FETCHED",modify:"CHANGESETS_PAGE_MODIFY_CHANGESET",loading:"CHANGESETS_PAGE_LOADING",error:"CHANGESETS_PAGE_ERROR",checkNew:"CHANGESETS_PAGE_CHECK_NEW_CHANGESETS",updateNewCount:"CHANGESETS_PAGE_UPDATE_NEW_COUNT",checkNewLoading:"CHANGESETS_PAGE_CHECK_NEW_LOADING"},vt={set:"FILTERS_SET",apply:"FILTERS_APPLY"};function yt(e,t){return Object(S.a)({type:e},t)}var xt=function(e,t){return yt(vt.apply,{filters:e,pathname:t})};function Et(){return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(T.a)([kt(),Object(T.i)(vt.apply,Ot)]);case 2:case"end":return e.stop()}},dt)}function kt(){var e,t,a,n;return I.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=3,Object(T.g)(s.b);case 3:if(a=r.sent,n=a.payload,t!==n.search){r.next=7;break}return r.abrupt("continue",0);case 7:if(t=n.search,!e){r.next=11;break}return r.next=11,Object(T.c)(e);case 11:return r.next=13,Object(T.d)(At,n);case 13:e=r.sent,r.next=0;break;case 16:case"end":return r.stop()}},ht)}function Ot(e){var t,a,n,r;return I.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.filters,a=e.pathname,n=$e("filters",t.toJS()),c.next=4,Object(T.f)(jt);case 4:return r=c.sent,c.next=7,Object(T.e)(Object(s.c)(Object(S.a)({},r,{pathname:a||r.pathname,search:n})));case 7:case"end":return c.stop()}},ft)}function At(e){var t,a,n,r;return I.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(c.prev=0,t=Ze(e.search).toObject(),a=t.filters,n=t.aoi,a||(a=Object(O.Map)()),!n){c.next=9;break}return c.next=6,Object(T.b)(it,n);case 6:a=c.sent,c.next=11;break;case 9:return c.next=11,Object(T.e)(yt(ot.clear));case 11:return c.next=13,Object(T.b)(ze,a);case 13:return c.next=15,Object(T.e)(yt(vt.set,{filters:a}));case 15:if(!n){c.next=20;break}return c.next=18,Object(T.e)(yt(bt.fetch,{pageIndex:0,filters:a,aoiId:n}));case 18:c.next=22;break;case 20:return c.next=22,Object(T.e)(yt(bt.fetch,{pageIndex:0,filters:a}));case 22:c.next=33;break;case 24:return c.prev=24,c.t0=c.catch(0),console.error(c.t0),c.next=29,Object(T.f)(jt);case 29:return(r=c.sent).search="",c.next=33,Object(T.a)([Object(T.e)(fe({error:c.t0})),Object(T.e)(Object(s.c)(r))]);case 33:case"end":return c.stop()}},gt,null,[[0,24]])}var jt=function(e){return e.routing.location},wt=function(e){return e.filters.get("filters")},Nt=I.a.mark(Mt),Ct=I.a.mark(Bt),It=I.a.mark(Ht),St=I.a.mark(Gt),Tt={fetch:"CHANGESETS_PAGE_FETCH",fetched:"CHANGESETS_PAGE_FETCHED",modify:"CHANGESETS_PAGE_MODIFY_CHANGESET",loading:"CHANGESETS_PAGE_LOADING",error:"CHANGESETS_PAGE_ERROR",checkNew:"CHANGESETS_PAGE_CHECK_NEW_CHANGESETS",updateNewCount:"CHANGESETS_PAGE_UPDATE_NEW_COUNT",checkNewLoading:"CHANGESETS_PAGE_CHECK_NEW_LOADING"};function Dt(e,t){return Object(S.a)({type:e},t)}var Rt=function(e,t){return Dt(Tt.fetch,{pageIndex:e,nocache:t})},_t=function(e){return Dt(Tt.checkNew,{nocache:e})};function Mt(){return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(T.a)([Object(T.i)(Tt.fetch,Bt),Object(T.i)(Tt.modify,Ht),Object(T.i)(Tt.checkNew,Gt)]);case 2:case"end":return e.stop()}},Nt)}var Pt=function(e){return[e.changesetsPage.getIn(["pageIndex"],0)]},Ut=function(e){return e.auth.get("token")},Ft=function(e){return e.aoi.getIn(["aoi","id"])};function Bt(e){var t,a,n,r,c,o,s;return I.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(t=e.pageIndex,a=e.nocache,n=e.filters,r=e.aoiId,n){l.next=5;break}return l.next=4,Object(T.f)(wt);case 4:n=l.sent;case 5:if(r){l.next=9;break}return l.next=8,Object(T.f)(Ft);case 8:r=l.sent;case 9:return l.next=11,Object(T.f)(Pt);case 11:return c=l.sent,null==t&&(t=c),l.next=15,Object(T.e)(Dt(Tt.loading,{pageIndex:t}));case 15:return l.prev=15,l.next=18,Object(T.f)(Ut);case 18:if(o=l.sent,!r){l.next=25;break}return l.next=22,Object(T.b)(Qe,t,n,o,a,r);case 22:s=l.sent,l.next=28;break;case 25:return l.next=27,Object(T.b)(Qe,t,n,o,a);case 27:s=l.sent;case 28:return l.next=30,Object(T.e)(Dt(Tt.fetched,{data:Object(O.fromJS)(s),pageIndex:t}));case 30:l.next=39;break;case 32:return l.prev=32,l.t0=l.catch(15),l.next=36,Object(T.e)(Dt(Tt.error,{pageIndex:c,error:l.t0}));case 36:return l.t0.name="Failed to load page ".concat(t),l.next=39,Object(T.e)(fe({error:l.t0,callback:Dt,callbackLabel:"Retry",callbackArgs:[Tt.fetch,{pageIndex:t}]}));case 39:case"end":return l.stop()}},Ct,null,[[15,32]])}var Lt=function(e){return[e.changesetsPage.getIn(["currentPage"],Object(O.Map)()),e.changesetsPage.getIn(["pageIndex"],0)]};function Ht(e){var t,a,n,r,c,o,s,l;return I.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.changesetId,a=e.changeset,i.prev=1,i.next=4,Object(T.f)(Lt);case 4:if(n=i.sent,r=Object(Ve.a)(n,2),c=r[0],o=r[1],s=c.get("features"),!((l=s.findIndex(function(e){return e.get("id")===t}))>-1)){i.next=16;break}return c=c.setIn(["features",l],a),i.next=14,Object(T.e)(Dt(Tt.fetched,{data:c,pageIndex:o}));case 14:return i.next=16,Object(T.e)(Dt(Tt.checkNew));case 16:i.next=21;break;case 18:i.prev=18,i.t0=i.catch(1),console.error(i.t0);case 21:case"end":return i.stop()}},It,null,[[1,18]])}function Gt(e){var t,a,n,r,c,o,s,l,i,u;return I.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return t=e.nocache,p.prev=1,p.next=4,Object(T.e)(Dt(Tt.checkNewLoading));case 4:return p.next=6,Object(T.b)(A.b,3e3+2e3*Math.random());case 6:return p.next=8,Object(T.f)(function(e){return[e.filters.get("filters"),e.changesetsPage.get("pageIndex"),e.auth.get("token"),e.aoi.get("aoi").get("id")]});case 8:return a=p.sent,n=Object(Ve.a)(a,4),r=n[0],c=n[1],o=n[2],s=n[3],p.next=16,Object(T.b)(Qe,c,r,o,t,s);case 16:return l=p.sent,p.next=19,Object(T.f)(function(e){return e.changesetsPage.get("currentPage")});case 19:return i=p.sent,u=0,i&&(l=Object(O.fromJS)(l.features.map(function(e){return e.id})).toSet(),i=i.get("features").map(function(e){return e.get("id")}).toSet(),u=l.subtract(i).size),p.next=24,Object(T.e)(Dt(Tt.updateNewCount,{diff:u}));case 24:p.next=29;break;case 26:p.prev=26,p.t0=p.catch(1),console.error(p.t0);case 29:case"end":return p.stop()}},St,null,[[1,26]])}var Vt,Wt={NOT_LOGGED_IN:{kind:"error",title:"Sign in required",description:"This action requires you to sign in first."},MODIFY_SUCCESS:{kind:"success",title:"Successful",autoDismiss:2,description:function(e){return"The changeset ".concat(e," was successfully modified.")}}};function Jt(e){return Vt?Promise.resolve(Vt[e]):a.e(3).then(a.t.bind(null,308,7)).then(function(t){return(Vt=t)[e]}).catch(function(e){console.error(e),console.log("Failed to load module changeset-map")})}var zt=a(138);function Yt(e,t,a){var n=Object(zt.a)(t.pathname,a);return n?n.params[e]:null}function Kt(e){var t=parseInt(Yt("id",e,"/changesets/:id"),10);return!t||Number.isNaN(t)?null:t}function Qt(e){var t=parseInt(Yt("id",e,"/:id"),10);return!t||Number.isNaN(t)?null:t}var qt=I.a.mark(sa),Xt=I.a.mark(la),Zt=I.a.mark(ia),$t=I.a.mark(da),ea=I.a.mark(ga),ta=I.a.mark(ba),aa=I.a.mark(va),na={fetch:"CHANGESET.fetch",fetched:"CHANGESET.fetched",change:"CHANGESET.change",loading:"CHANGESET.loading",error:"CHANGESET.error"},ra={modify:"CHANGESET_MODIFY.modify",harmful:"CHANGESET_MODIFY.harmful",revert:"CHANGESET_MODIFY.revert",tag:"CHANGESET_MODIFY.tag"},ca={fetched:"CHANGESET_MAP.fetched",loading:"CHANGESET_MAP.loading",change:"CHANGESET_MAP.change",error:"CHANGESET_MAP.error"};function oa(e,t){return Object(S.a)({type:e},t)}function sa(){var e,t,a,n,r;return I.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=3,Object(T.g)(s.b);case 3:return a=c.sent,n=a.payload,c.next=7,Object(T.b)(la,n);case 7:if(!(r=c.sent)){c.next=21;break}if(!e){c.next=12;break}return c.next=12,Object(T.c)(e);case 12:if(!t){c.next=15;break}return c.next=15,Object(T.c)(t);case 15:return c.next=17,Object(T.d)(da,r);case 17:return e=c.sent,c.next=20,Object(T.d)(ga,r);case 20:t=c.sent;case 21:c.next=0;break;case 23:case"end":return c.stop()}},qt)}function la(e){var t,a;return I.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(t=Qt(e))){n.next=5;break}return n.next=4,Object(T.e)(Object(s.d)(Object(S.a)({},e,{pathname:"/changesets/"+t})));case 4:return n.abrupt("return",!1);case 5:if(a=Kt(e)){n.next=8;break}return n.abrupt("return",!1);case 8:return n.next=10,Object(T.f)(function(e){return!e.changeset.get("errorChangeset")&&!e.changeset.get("errorChangesetMap")&&e.changeset.get("changesetId")});case 10:if(n.sent===a){n.next=13;break}return n.abrupt("return",a);case 13:case"end":return n.stop()}},Xt)}function ia(){var e,t,a,n,r,c,o,s,l,i;return I.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=3,Object(T.g)([ra.harmful,ra.tag]);case 3:return e=u.sent,u.next=6,Object(T.f)(function(e){return{token:e.auth.get("token"),username:e.auth.getIn(["userDetails","username"])}});case 6:if(t=u.sent,a=t.token,n=t.username,a){u.next=13;break}return u.next=12,Object(T.e)(fe(Object(S.a)({},Wt.NOT_LOGGED_IN)));case 12:return u.abrupt("continue",0);case 13:if(r=e.changesetId,c=e.oldChangeset){u.next=16;break}return u.abrupt("continue",0);case 16:o=void 0,u.prev=17,u.t0=e.type,u.next=u.t0===ra.harmful?21:u.t0===ra.tag?26:31;break;case 21:return s=e.harmful,u.next=24,Object(T.b)(ba,{changesetId:r,oldChangeset:c,token:a,harmful:s,username:n});case 24:return o=u.sent,u.abrupt("break",32);case 26:return l=e.tag,i=e.remove,u.next=29,Object(T.b)(va,{changesetId:r,oldChangeset:c,token:a,tag:l,remove:i});case 29:return o=u.sent,u.abrupt("break",32);case 31:return u.abrupt("continue",0);case 32:u.next=40;break;case 34:return u.prev=34,u.t1=u.catch(17),u.next=38,Object(T.e)(oa(ra.revert,{changesetId:r,changeset:c}));case 38:return u.next=40,Object(T.e)(fe({error:u.t1}));case 40:if(!o){u.next=43;break}return u.next=43,Object(T.e)(oa(Tt.modify,{changesetId:r,changeset:o}));case 43:u.next=0;break;case 45:case"end":return u.stop()}},Zt,null,[[17,34]])}var ua=function(e){return e.changeset.getIn(["changesets"],Object(O.Map)())},pa=function(e){return e.auth.get("token")},ma=function(e){return e.routing.location};function da(e){var t,a,n,r;return I.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(T.f)(ua);case 2:if(t=c.sent,!(a=t.get(e))){c.next=8;break}return c.next=7,Object(T.e)(oa(na.change,{changesetId:e}));case 7:return c.abrupt("return");case 8:return c.next=10,Object(T.e)(oa(na.loading,{changesetId:e}));case 10:return c.prev=10,c.next=13,Object(T.f)(pa);case 13:return n=c.sent,c.next=16,Object(T.b)(ae,e,n);case 16:return a=c.sent,c.next=19,Object(T.e)(oa(na.fetched,{data:Object(O.fromJS)(a),changesetId:e}));case 19:c.next=31;break;case 21:return c.prev=21,c.t0=c.catch(10),c.next=25,Object(T.e)(oa(na.error,{changesetId:e,error:c.t0}));case 25:return c.next=27,Object(T.f)(ma);case 27:return r=c.sent,c.t0.name="Changeset:".concat(e," failed"),c.next=31,Object(T.e)(fe({error:c.t0,callback:s.c,callbackArgs:[r],callbackLabel:"Retry"}));case 31:case"end":return c.stop()}},$t,null,[[10,21]])}function ha(e){return Jt("getChangeset").then(function(t){return t(e)})}var fa=function(e){return e.changeset.getIn(["changesetMap"],Object(O.Map)())};function ga(e){var t,a,n;return I.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(T.f)(fa);case 2:if(t=r.sent,!(a=t.get(e))){r.next=8;break}return r.next=7,Object(T.e)(oa(ca.change,{changesetId:e}));case 7:return r.abrupt("return");case 8:return r.next=10,Object(T.e)(oa(ca.loading,{changesetId:e}));case 10:return r.prev=10,r.next=13,Object(T.b)(ha,e);case 13:return a=r.sent,r.next=16,Object(T.e)(oa(ca.fetched,{data:a,changesetId:e}));case 16:r.next=28;break;case 18:return r.prev=18,r.t0=r.catch(10),r.next=22,Object(T.e)(oa(ca.error,{changesetId:e,error:r.t0}));case 22:return r.next=24,Object(T.f)(ma);case 24:return n=r.sent,r.t0.name="Changeset:".concat(e," Map failed"),r.next=28,Object(T.e)(fe({error:r.t0,callback:s.c,callbackArgs:[n],callbackLabel:"Retry"}));case 28:case"end":return r.stop()}},ea,null,[[10,18]])}function ba(e){var t,a,n,r,c,o;return I.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.changesetId,a=e.oldChangeset,n=e.token,r=e.harmful,c=e.username,o=a.setIn(["properties","check_user"],-1===r?null:c).setIn(["properties","checked"],-1!==r).setIn(["properties","harmful"],-1===r?null:r),s.next=4,Object(T.e)(oa(ra.modify,{changesetId:t,changeset:o}));case 4:return s.next=6,Object(T.b)(ne,t,n,r);case 6:return s.abrupt("return",o);case 7:case"end":return s.stop()}},ta)}function va(e){var t,a,n,r,c,o,s,l;return I.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(t=e.changesetId,a=e.oldChangeset,n=e.token,r=e.tag,c=e.remove,!a.getIn(["properties","checked"])){i.next=11;break}return o=a,c?((s=a.getIn(["properties","tags"])).forEach(function(e,t){e.get("id")===r.value&&(l=t)}),o=a.setIn(["properties","tags"],s.delete(l))):(s=a.getIn(["properties","tags"]),o=a.setIn(["properties","tags"],s.push((new O.Map).set("id",r.value).set("name",r.label)))),i.next=6,Object(T.e)(oa(ra.modify,{changesetId:t,changeset:o}));case 6:return i.next=8,Object(T.b)(ce,t,n,r,c);case 8:return i.abrupt("return",o);case 11:throw new Error("Only allowed on checked changesets");case 12:case"end":return i.stop()}},aa)}var ya=I.a.mark(Ra),xa=I.a.mark(_a),Ea=I.a.mark(Ma),ka=I.a.mark(Pa),Oa=I.a.mark(Ua),Aa={postSocialToken:"AUTH_POST_SOCIAL_TOKEN",saveOAuth:"AUTH_SAVE_OAUTH_OBJ",getFinalToken:"AUTH_GET_FINAL_TOKEN",saveToken:"AUTH_SAVE_TOKEN",logout:"AUTH_LOGOUT",clearSession:"AUTH_CLEAR_SESSION",loginError:"AUTH_LOGIN_ERROR",userDetails:"AUTH_USER_DETAILS",clearUserDetails:"AUTH_CLEAR_USER_DETAILS",updateUserDetails:"UPDATE_USER_DETAILS"};function ja(e,t){return Object(S.a)({type:e},t)}var wa=function(e){return ja(Aa.getFinalToken,{oauth_verifier:e})},Na=function(){return ja(Aa.logout)},Ca=function(e){return e.auth.get("token")},Ia=function(e){return e.routing.location},Sa=function(e){return e.changeset.get("changesetId")},Ta=A.b,Da=1e3;function Ra(){return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(T.a)([Object(T.i)(Aa.updateUserDetails,Ua)]);case 2:case"end":return e.stop()}},ya)}function _a(){var e,t,a,n,r,c,o,s,l;return I.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return e=1e3,i.next=3,Object(T.f)(Ca);case 3:t=i.sent;case 4:if(i.prev=5,t){i.next=10;break}return i.next=9,Object(T.b)(Pa);case 9:t=i.sent;case 10:return i.t0=O.fromJS,i.next=13,Object(T.b)($,t);case 13:return i.t1=i.sent,a=(0,i.t0)(i.t1),n=a.get("whitelists"),i.t2=O.fromJS,i.next=19,Object(T.b)(oe,t);case 19:return i.t3=i.sent,r=(0,i.t2)(i.t3),i.t4=O.fromJS,i.next=24,Object(T.b)(te);case 24:return i.t5=i.sent,c=(0,i.t4)(i.t5),i.next=28,Object(T.e)(ja(Ae.define,{whitelist:n}));case 28:return i.next=30,Object(T.e)(ja(Me.define,{blacklist:r}));case 30:return i.next=32,Object(T.e)(ja(Aa.userDetails,{userDetails:a}));case 32:return i.next=34,Object(T.f)(Pt);case 34:if(!(o=i.sent)){i.next=38;break}return i.next=38,Object(T.e)(ja(Tt.fetch,{pageIndex:o}));case 38:return i.next=40,Object(T.f)(Sa);case 40:if(!(s=i.sent)){i.next=47;break}return i.next=44,Object(T.b)(ae,s,t);case 44:return l=i.sent,i.next=47,Object(T.e)(ja(na.fetched,{data:Object(O.fromJS)(l),changesetId:s}));case 47:if("success"===c.get("status")){i.next=50;break}return i.next=50,Object(T.e)(fe({title:"OSMCha Status",description:c.get("message"),kind:c.get("status"),autoDismiss:20,position:"bc"}));case 50:return i.next=52,Object(T.g)(Aa.logout);case 52:return e=Da,t=void 0,i.next=56,Object(T.b)(Ma);case 56:return i.next=58,Object(T.b)(Ta,e);case 58:i.next=78;break;case 60:return i.prev=60,i.t6=i.catch(5),console.log(i.t6),i.next=65,Object(T.e)(ja(Aa.loginError,i.t6));case 65:return i.next=67,Object(T.b)(Ta,e/2);case 67:return i.t6.name="Error",i.next=70,Object(T.e)(fe({error:i.t6,kind:"warning"}));case 70:return i.next=72,Object(T.g)(Aa.logout);case 72:return e*=4,t=void 0,i.next=76,Object(T.b)(Ma);case 76:return i.next=78,Object(T.b)(Ta,e);case 78:i.next=4;break;case 80:case"end":return i.stop()}},xa,null,[[5,60]])}function Ma(){var e,t;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(T.b)(N,"token");case 2:return a.next=4,Object(T.b)(N,"oauth_token");case 4:return a.next=6,Object(T.b)(N,"oauth_token_secret");case 6:return a.next=8,Object(T.e)(ja(Aa.clearSession));case 8:return a.next=10,Object(T.e)(ja(Ae.clear));case 10:return a.next=12,Object(T.f)(Pt);case 12:if(!(e=a.sent)){a.next=16;break}return a.next=16,Object(T.e)(ja(Tt.fetch,{pageIndex:e}));case 16:return a.next=18,Object(T.e)(ja(Aa.clearUserDetails));case 18:return a.next=20,Object(T.f)(Ia);case 20:return t=a.sent,a.next=23,Object(T.e)(Object(s.c)(Object(S.a)({},t,{pathname:"/"})));case 23:case"end":return a.stop()}},Ea)}function Pa(){var e,t,a,n,r,c,o;return I.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(T.b)(Z);case 2:return e=s.sent,t=e.oauth_token,a=e.oauth_token_secret,s.next=7,Object(T.e)(ja(Aa.saveOAuth,{oauth_token:t,oauth_token_secret:a}));case 7:return s.next=9,Object(T.g)(Aa.getFinalToken);case 9:return n=s.sent,r=n.oauth_verifier,s.next=13,Object(T.b)(X,t,a,r);case 13:if(c=s.sent,(o=c.token)&&""!==o){s.next=17;break}throw new Error("invalid token");case 17:return s.next=19,Object(T.b)(w,"token",o);case 19:return s.next=21,Object(T.b)(w,"oauth_token",t);case 21:return s.next=23,Object(T.b)(w,"oauth_token_secret",a);case 23:return s.next=25,Object(T.e)(ja(Aa.saveToken,{token:o,oauth_verifier:r}));case 25:return s.abrupt("return",o);case 26:case"end":return s.stop()}},ka)}function Ua(e){var t,a,n,r,c;return I.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.message_good,a=e.message_bad,n=e.comment_feature,o.prev=1,o.next=4,Object(T.f)(Ca);case 4:if(!(r=o.sent)){o.next=15;break}return o.t0=O.fromJS,o.next=9,Object(T.b)(ee,r,t,a,n);case 9:return o.t1=o.sent,c=(0,o.t0)(o.t1),o.next=13,Object(T.e)(ja(Aa.userDetails,{userDetails:c}));case 13:return o.next=15,Object(T.e)(fe({kind:"success",title:"User updated",description:"Your user preferences were updated successfully"}));case 15:o.next=22;break;case 17:return o.prev=17,o.t2=o.catch(1),console.error(o.t2),o.next=22,Object(T.e)(fe({error:o.t2}));case 22:case"end":return o.stop()}},Oa,null,[[1,17]])}var Fa=Object(O.fromJS)({oAuthToken:null,oAuthTokenSecret:null,error:null,token:null,userDetails:null});var Ba=Object(O.fromJS)({pageIndex:0,currentPage:null,loading:!1,error:null,diff:0,diffLoading:!1});var La=Object(O.fromJS)({changesetId:null,changesets:new O.Map,loading:!1,errorChangeset:null,changesetMap:new O.Map,loadingChangesetMap:!1,errorChangesetMap:null});var Ha=Object(O.fromJS)({error:null,kind:null,duration:null,title:null,dismiss:!0,autoDismiss:5,position:"tr",description:null,uid:null});var Ga=Object(O.fromJS)({filters:{},aoi:{},loading:!1,error:null});var Va=Object(O.fromJS)({whitelist:null,loading:!1});var Wa=Object(O.fromJS)({blacklist:Object(O.List)(),loading:!1});var Ja=Object(O.fromJS)({aoi:{},loading:!1,error:null});var za=I.a.mark(Ya);function Ya(){return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(T.a)([Mt(),Et(),lt(),sa(),_a(),Ra(),ia(),be(),Ie(),Le()]);case 2:case"end":return e.stop()}},za)}var Ka=Object(k.c)({changesetsPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ba,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Tt.updateNewCount:return e.set("diff",t.diff).set("diffLoading",!1);case Tt.checkNewLoading:return e.set("diffLoading",!0);case Tt.loading:return e.set("pageIndex",t.pageIndex).set("loading",!0).set("diff",0).set("diffLoading",!1).set("error",null);case Tt.fetched:return e.set("currentPage",t.data).set("pageIndex",t.pageIndex).set("loading",!1).set("error",null);case Tt.error:return e.set("pageIndex",t.pageIndex).set("diff",0).set("loading",!1).set("error",t.error);default:return e}},changeset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:La,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case na.change:return e.set("changesetId",t.changesetId).set("loading",!1).set("errorChangeset",null).set("errorChangesetMap",null);case na.loading:return e.set("changesetId",t.changesetId).set("loading",!0).set("errorChangeset",null);case na.fetched:var a=e.get("changesets").set(t.changesetId,t.data);return e.set("changesets",a).set("changesetId",t.changesetId).set("loading",!1).set("errorChangeset",null);case na.error:return e.set("changesetId",t.changesetId).set("loading",!1).set("errorChangeset",t.error);case ca.change:return e.set("changesetId",t.changesetId).set("errorChangesetMap",null).set("loadingChangesetMap",!1);case ca.fetched:var n=e.get("changesetMap").set(t.changesetId,t.data);return e.set("changesetMap",n).set("changesetId",t.changesetId).set("loadingChangesetMap",!1).set("errorChangesetMap",null);case ca.loading:return e.set("changesetId",t.changesetId).set("loadingChangesetMap",!0).set("errorChangesetMap",null);case ca.error:return e.set("changesetId",t.changesetId).set("loadingChangesetMap",!1).set("errorChangesetMap",t.error);case ra.modify:var r=e.get("changesets").set(t.changesetId,t.changeset);return e.set("changesets",r);case ra.revert:var c=e.get("changesets").set(t.changesetId,t.changeset);return e.set("changesets",c).set("errorChangeset",t.error);default:return e}},filters:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ga,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case vt.set:return e.set("filters",t.filters).set("loading",!1);default:return e}},aoi:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ja,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ot.loading:return e.set("loading",!0);case ot.clear:return e.set("aoi",Object(O.Map)()).set("loading",!1).set("error",null);case ot.fetched:return e.set("loading",!1).set("error",null).set("aoi",t.aoi);default:return e}},routing:s.f,auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Aa.saveOAuth:return e.set("oAuthToken",t.oauth_token).set("oAuthTokenSecret",t.oauth_token_secret).set("error",null);case Aa.saveToken:return e.set("token",t.token).set("error",null);case Aa.clearSession:return Object(O.fromJS)({error:e.get("error")});case Aa.loginError:return e.set("error",t.error);case Aa.userDetails:return e.set("userDetails",t.userDetails);case Aa.clearUserDetails:return e.set("userDetails",Object(O.Map)());default:return e}},modal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ha,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case me:return e.set("kind",t.kind).set("error",t.error).set("callbackLabel",t.callbackLabel).set("title",t.title).set("dismiss",t.dismiss).set("uid",t.uid).set("autoDismiss",t.autoDismiss).set("position",t.position).set("description",t.description);default:return e}},whitelist:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Va,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ae.define:return e.set("whitelist",t.whitelist).set("loading",!1);case Ae.add:return e.set("whitelist",e.get("whitelist").concat([t.whitelist_user])).set("loading",!1);case Ae.remove:return e.set("whitelist",e.get("whitelist").filter(function(e){return e!==t.whitelist_user})).set("loading",!1);case Ae.clear:return e.set("whitelist",Object(O.Map)()).set("loading",!1);default:return e}},blacklist:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Me.define:return e.set("blacklist",t.blacklist).set("loading",!1);case Me.add:return e.set("blacklist",e.get("blacklist").concat([Object(O.fromJS)(t.blacklist_user)])).set("loading",!1);case Me.remove:return e.set("blacklist",e.get("blacklist").filter(function(e){return e.get("uid")!=t.blacklist_user})).set("loading",!1);case Me.clear:return e.set("blacklist",Object(O.Map)()).set("loading",!1);default:return e}}}),Qa=Object(A.a)(),qa=[Qa,Object(s.e)(E)],Xa=k.a.apply(void 0,qa),Za={auth:Object(O.Map)({token:j("token"),oAuthToken:j("oauth_token"),oAuthTokenSecret:j("oauth_token_secret"),error:null})},$a=Object(k.d)(Ka,Za,Xa);Qa.run(Ya);a(264),a(265),a(266),a(267);var en=a(6),tn=a(8),an=a(7),nn=a(9),rn=a(5),cn=a(154),on=a(36),sn=a.n(on),ln=a(52),un=a.n(ln);function pn(e){var t=!1;return{promise:new Promise(function(a,n){e.then(function(e){return t?n({isCanceled:!0}):a(e)}).catch(function(e){return n(t?{isCanceled:!0}:e)})}),cancel:function(){t=!0}}}function mn(e){if(!e.ok)throw Error(e.statusText);return e}function dn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var hn=function(e){Object(an.a)(a,e);var t=dn(a);function a(){return Object(en.a)(this,a),t.apply(this,arguments)}return Object(tn.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"relative h-auto mt3 scroll-auto ".concat(this.props.className)},r.a.createElement("div",{style:this.props.style,className:"fixed block flex-parent flex-parent--column pb12 flex-parent--center-cross "},this.props.children))}}]),a}(r.a.PureComponent);function fn(e){var t=e.showZero;return r.a.createElement("div",{className:"flex-parent flex-parent--row flex-parent--wrap ".concat(e.className)},(e.create>-1||t)&&r.a.createElement("div",{className:"cmap-bg-create  color-white inline-block px6 txt-s txt-bold round unround-r"},e.create),(e.modify>-1||t)&&r.a.createElement("div",{className:"cmap-bg-modify-old  color-white inline-block px6  txt-s txt-bold unround"},e.modify),(e.delete>-1||t)&&r.a.createElement("div",{className:"cmap-bg-delete color-white inline-block px6 txt-s txt-bold round unround-l"},e.delete))}var gn=a(69),bn=a.n(gn);function vn(e){var t=e.url;return r.a.createElement("a",{className:"link",href:t,target:"_blank"},t)}function yn(e){var t=e.text;return r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",title:"Translate",href:"http://translate.google.com/#auto/en/".concat(encodeURIComponent(t)),className:"btn btn--xs border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition pl12 pr6"},"Translate",r.a.createElement("svg",{className:"icon h18 w18 inline-block align-middle pb3 pl3"},r.a.createElement("use",{xlinkHref:"#icon-share"})))}function xn(e){var t=e.reasons,a=e.underline,n=e.color,c=a?"txt-underline-dotted":"";return r.a.createElement("span",{className:"mb3"},t.map(function(e,t){return r.a.createElement("span",{key:t,className:"mr6"},r.a.createElement("span",{className:"color-".concat(n,"-dark inline-block bg-").concat(n,"-faint px6 txt-s txt-bold ").concat(c)},e.get("name")))}))}function En(e){var t=e.properties,a=e.changesetId,n=t.get("source"),c=t.get("editor"),o=t.get("imagery_used"),s=t.get("reasons"),l=t.get("comment"),i=new RegExp(/(?:(?:https?|ftp|file):\/\/|www\.|ftp\.)(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/gim),u=[];n&&n.indexOf("{switch:a,b,c}.")>-1&&(n=n.replace("{switch:a,b,c}.","")),n&&n.match(i)&&(u=n.match(i),n=n.replace(i,""));var p=[];return o&&o.match(i)&&(p=o.match(i),o=o.replace(i,"")),r.a.createElement("div",null,r.a.createElement("div",{className:"flex-parent flex-parent--column flex-parent--start flex-parent--wrap py12"},r.a.createElement("div",{className:"flex-parent flex-parent--row flex-parent--wrap mb3"},r.a.createElement("p",{className:"flex-child txt-subhead txt-l txt-break-url ".concat(l?"":"color-gray txt-em")},r.a.createElement(bn.a,{text:l||"".concat(a," does not have a comment.")},r.a.createElement(vn,null)))),r.a.createElement("div",{className:"flex-parent"},r.a.createElement(yn,{text:l}))),r.a.createElement("div",{className:"flex-parent flex-parent--column flex-parent--start flex-parent--wrap "},r.a.createElement(xn,{reasons:s,color:"blue"})),r.a.createElement("div",{className:"flex-parent flex-parent--row justify--space-between flex-parent--wrap pt12 pb6"},r.a.createElement("div",{className:"flex-parent flex-parent--column "},r.a.createElement("strong",{className:"wmax180 txt-s txt-uppercase"},"Source"),r.a.createElement("span",{className:"wmax180 txt-break-word txt-s"},n,r.a.createElement("span",null,r.a.createElement("br",null),u.map(function(e,t){return r.a.createElement("a",{href:u,title:u,key:t,className:"color-blue",target:"_blank"},Array.isArray(e.match(/^(?:https?:\/\/)?(?:[^@\/\n]+@)?(?:www\.)?([^:\/\n]+)/gim))?e.match(/^(?:https?:\/\/)?(?:[^@\/\n]+@)?(?:www\.)?([^:\/\n]+)/gim)[0]:r.a.createElement("svg",{className:"icon h18 w18 inline-block align-middle "},r.a.createElement("use",{xlinkHref:"#icon-share"})))})))),r.a.createElement("div",{className:"flex-parent flex-parent--column "},r.a.createElement("strong",{className:"wmax180 txt-s txt-uppercase"},"Editor"),r.a.createElement("span",{className:"wmax180 txt-break-word txt-s"},c)),r.a.createElement("div",{className:"flex-parent flex-parent--column"},r.a.createElement("strong",{className:"wmax180 txt-s txt-uppercase"},"Imagery"),r.a.createElement("span",{className:"wmax180 txt-break-word txt-s"},o,r.a.createElement("span",null,r.a.createElement("br",null),p.map(function(e,t){return r.a.createElement("a",{href:e,key:t,className:"color-blue"},Array.isArray(e.match(/^(?:https?:\/\/)?(?:[^@\/\n]+@)?(?:www\.)?([^:\/\n]+)/gim))?e.match(/^(?:https?:\/\/)?(?:[^@\/\n]+@)?(?:www\.)?([^:\/\n]+)/gim)[0]:r.a.createElement("svg",{className:"icon h18 w18 inline-block align-middle "},r.a.createElement("use",{xlinkHref:"#icon-share"})))}))))))}function kn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var On=function(e){Object(an.a)(a,e);var t=kn(a);function a(){return Object(en.a)(this,a),t.apply(this,arguments)}return Object(tn.a)(a,[{key:"render",value:function(){var e,t,a=this.props.properties.get("user"),n=this.props.properties.get("date"),c=this.props.properties.get("create"),o=this.props.properties.get("modify"),s=this.props.properties.get("delete");try{e=-1!==this.props.whitelisted.indexOf(a)}catch(l){e=!1}try{t=-1!==this.props.blacklisted.map(function(e){return e.get("uid")}).indexOf(this.props.properties.get("uid"))}catch(l){t=!1}return r.a.createElement("div",{className:"px12 py6"},r.a.createElement("div",{className:"flex-parent flex-parent--column flex-parent--start flex-parent--wrap"},r.a.createElement("div",{className:"flex-parent flex-parent--row justify--space-between"},r.a.createElement("h2",{className:"txt-m txt-uppercase txt-bold mr6 mb3"},"Details"),r.a.createElement("div",null,r.a.createElement(fn,{showZero:!0,className:"mr3 mt3",create:c,modify:o,delete:s}))),r.a.createElement("div",{className:"flex-parent flex-parent--row justify--space-between flex-parent--wrap"},r.a.createElement("span",{className:"txt-s"},r.a.createElement("strong",{className:"txt-underline-on-hover pointer"},r.a.createElement("a",{dir:"ltr",onClick:this.props.toggleUser},a)),e&&r.a.createElement("svg",{className:"icon inline-block align-middle pl3 w18 h18 color-gray"},r.a.createElement("use",{xlinkHref:"#icon-star"})),t&&r.a.createElement("svg",{className:"icon inline-block align-middle pl3 w18 h18 color-gray"},r.a.createElement("use",{xlinkHref:"#icon-alert"})),this.props.userEditCount>0&&r.a.createElement("span",{className:"txt-s txt-em"},"\xa0(",this.props.userEditCount," edits)"),"\xa0created\xa0",Je()(n).fromNow()))),r.a.createElement(En,{changesetId:this.props.changesetId,properties:this.props.properties}))}}]),a}(r.a.PureComponent);On=Object(l.b)(function(e,t){return{whitelisted:e.whitelist.get("whitelist"),blacklisted:e.blacklist.get("blacklist")}})(On);var An=a(98),jn=a(70),wn=a.n(jn),Nn=a(97),Cn=a.n(Nn);function In(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var Sn=function(e){Object(an.a)(a,e);var t=In(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={loaded:!1},e}return Object(tn.a)(a,[{key:"handleImageLoaded",value:function(){this.setState({loaded:!0})}},{key:"handleImageErrored",value:function(){this.setState({loaded:!1})}},{key:"componentWillReceiveProps",value:function(e){e.url!==this.props.url&&this.setState({loaded:!1})}},{key:"render",value:function(){var e=Cn.a;return this.props.url&&(e=this.props.url).indexOf("http://")>-1&&(e="https://"+e.slice(5)),r.a.createElement("div",{className:"p6 flex-parent flex-parent--center-main"},r.a.createElement("span",{style:{background:"url(".concat(this.state.loaded?this.props.url:Cn.a,") center center / ").concat(this.props.size,"px no-repeat")},className:"flex-child flex-child--no-shrink border border--2 border--gray h".concat(this.props.size," w").concat(this.props.size," bg-darken25 clip round-full")}),r.a.createElement("img",{alt:"",className:"none",src:this.props.url,onLoad:this.handleImageLoaded.bind(this),onError:this.handleImageErrored.bind(this)}))}}]),a}(r.a.PureComponent);function Tn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Authentication",t=arguments.length>1?arguments[1]:void 0,a=500,n=600,r=[["width",a],["height",n],["left",window.innerWidth.width/2-a/2],["top",window.innerHeight.height/2-n/2]].map(function(e){return e.join("=")}).join(","),c=window.open("about:blank",e,r);c&&(c.location=t)}var Dn=function(e){var t={};return e.split("&").forEach(function(e){var a=e.split("="),n=Object(Ve.a)(a,2),r=n[0],c=n[1];t[decodeURIComponent(r)]=decodeURIComponent(c)||null}),t};function Rn(){return new Promise(function(e,t){window.authComplete=function(t){var a=t.split("?")[1],n=Dn(a);return delete window.authComplete,e(n)}})}function _n(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var Mn=function(e){Object(an.a)(a,e);var t=_n(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).handleLoginClick=function(){var t=e.props.oAuthToken;t&&(Tn("oauth_popup",d||g?"/local-landing.html#".concat(t):"".concat(F,"?oauth_token=").concat(t)),Rn().then(function(t){e.props.getFinalToken(t.oauth_verifier)}))},e}return Object(tn.a)(a,[{key:"render",value:function(){var e=this.props.className?this.props.className:"border--darken5 border--darken25-on-hover bg-darken10 bg-darken5-on-hover color-gray";return r.a.createElement("button",{onClick:this.handleLoginClick,className:"btn btn--s border border--1 round transition ".concat(e)},r.a.createElement("svg",{className:"icon w18 h18 inline-block align-middle pr3"},r.a.createElement("use",{xlinkHref:"#icon-osm"})),this.props.text)}}]),a}(r.a.PureComponent);Mn=Object(l.b)(function(e,t){return{oAuthToken:e.auth.get("oAuthToken"),pageIndex:e.changesetsPage.get("pageIndex")||0}},{getFinalToken:wa,getChangeset:function(e){return oa(na.fetch,{changesetId:e})},getChangesetsPage:Rt})(Mn);a(286);var Pn=a(144),Un=a.n(Pn);function Fn(e){var t=e.onClick,a=e.children,n=e.iconName,c=e.className;return r.a.createElement("button",{onClick:t,className:"".concat(c||""," btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition ").concat(n&&a?"pl12 pr6":"")},a,n&&r.a.createElement("svg",{className:"icon w18 h18 inline-block align-middle ".concat(a?"pl3 pb3":"pb3")},r.a.createElement("use",{xlinkHref:"#icon-".concat(n)})))}function Bn(e,t){var a;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"===typeof e)return Ln(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ln(e,t)}(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==a.return||a.return()}finally{if(s)throw c}}}}function Ln(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function Hn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var Gn=function(e){Object(an.a)(a,e);var t=Hn(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).isActive=function(t){var a,n=Bn(e.props.value);try{for(n.s();!(a=n.n()).done;){if(a.value.label===t.label)return!0}}catch(r){n.e(r)}finally{n.f()}return!1},e.handleClick=function(t){if(t){var a=t.label;if(!a||!e.props.value||!e.props.onChange)return;var n=e.props.value,r=t;if(!r)return;for(var c=!1,o=0;o<n.length;o++)n[o].label===a&&(c=!0,e.props.onRemove(r),e.props.onChange(n.slice(0,o).concat(n.slice(o+1))));if(!c){var s=n.slice(0,n.length);e.props.multi||(s=[]),s.push(r),e.props.onAdd(r),e.props.onChange(s)}}e.props.multi||e.props.toggleDropdown()},e}return Object(tn.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"dropdown-content wmin96 round wmax240",style:{display:"block"}},this.props.options.map(function(t,a){return r.a.createElement("span",{key:a,onClick:e.handleClick.bind(null,t),className:"flex-parent flex-parent--row flex-parent--center-cross py6 px12"},e.props.multi&&r.a.createElement("input",{"data-label":t.label,"data-payload":JSON.stringify(t),type:"checkbox",checked:e.isActive(t),value:t.label,className:"cursor-pointer mt6"}),t.href?r.a.createElement("a",{target:"_blank",href:t.href,onClick:e.props.toggleDropdown,className:"txt-nowrap flex-child--grow cursor-pointer color-gray ".concat(e.isActive(t)?"is-active txt-bold":"")},t.label):r.a.createElement("a",{onClick:e.props.toggleDropdown,className:"txt-nowrap flex-child--grow cursor-pointer color-gray ".concat(e.isActive(t)?"is-active txt-bold":"")},t.label),e.props.deletable&&r.a.createElement("a",{onClick:function(a){a.preventDefault(),a.stopPropagation(),e.props.toggleDropdown(),e.props.deletable(t.value)}},"x"))}))}}]),a}(r.a.PureComponent),Vn=function(e){Object(an.a)(a,e);var t=Hn(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={display:!1},e.handleClickOutside=function(){e.setState({display:!1})},e.toggleDropdown=function(){e.setState({display:!e.state.display})},e.isActive=function(t){var a,n=Bn(e.props.value);try{for(n.s();!(a=n.n()).done;){if(a.value.label===t.label)return!0}}catch(r){n.e(r)}finally{n.f()}return!1},e}return Object(tn.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"dropdown mr3 pointer ".concat(this.props.className||"")},r.a.createElement(Fn,{iconName:"chevron-down",onClick:this.toggleDropdown,className:"wmin96"},r.a.createElement("span",null,this.props.display)),this.state.display&&r.a.createElement(Gn,Object.assign({},this.props,{eventTypes:["click","touchend"],toggleDropdown:this.toggleDropdown})))}}]),a}(r.a.PureComponent),Wn=Un()(Vn);function Jn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var zn=function(e){Object(an.a)(a,e);var t=Jn(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).handleVerify=function(t){var a=e.props.user.get("name"),n=e.props.user.get("uid");if(console.log(n),1===t.length)!1===t[0].value&&(console.log("blacklisting"),e.props.addToBlacklist({username:a,uid:n})),!0===t[0].value&&(console.log("whitelisting"),e.props.addToWhitelist(a));else if(t.length>1)throw new Error("verify array is big")},e.handleVerifyClear=function(){var t=-1!==e.props.whitelisted.indexOf(e.props.user.get("name"));-1!==e.props.blacklisted.map(function(e){return e.get("uid")}).indexOf(e.props.user.get("uid"))?e.props.removeFromBlacklist(e.props.user.get("uid")):t&&e.props.removeFromWhitelist(e.props.user.get("name"))},e}return Object(tn.a)(a,[{key:"render",value:function(){var e=this;return this.props.blacklisted.map(function(e){return e.get("uid")}).includes(this.props.user.get("uid"))?r.a.createElement("div",{className:"flex-parent-inline"},r.a.createElement("span",{className:"btn btn--s border border--1 round color-gray transition pl12 pr6 bg-lighten50 border--red-light"},r.a.createElement("span",null,r.a.createElement("svg",{className:"icon inline-block align-middle pl3 w18 h18 color-gray"},r.a.createElement("use",{xlinkHref:"#icon-alert"})),"Watchlisted user"),r.a.createElement("svg",{onClick:function(){return e.props.removeFromBlacklist(e.props.user.get("uid"))},className:"icon inline-block align-middle pl3 pb3 w18 h18 pointer color-gray"},r.a.createElement("use",{xlinkHref:"#icon-close"})))):this.props.whitelisted&&this.props.whitelisted.includes(this.props.user.get("name"))?r.a.createElement("div",{className:"flex-parent-inline"},r.a.createElement("span",{className:"btn btn--s border border--1 round color-gray transition pl12 pr6 bg-lighten50 border--green-light"},r.a.createElement("span",null,r.a.createElement("svg",{className:"icon inline-block align-middle pl3 w18 h18 color-gray"},r.a.createElement("use",{xlinkHref:"#icon-star"})),"Trusted user"),r.a.createElement("svg",{onClick:function(t){return e.props.removeFromWhitelist(e.props.user.get("name"))},className:"icon inline-block align-middle pl3 pb3 w18 h18 pointer color-gray"},r.a.createElement("use",{xlinkHref:"#icon-close"})))):r.a.createElement("div",{className:"select-container"},r.a.createElement(Wn,{eventTypes:["click","touchend"],value:[],onAdd:function(){},onRemove:function(){},options:[{value:!1,label:"Add to your watchlist"},{value:!0,label:"Add to your trusted users list"}],onChange:this.handleVerify,display:"Trust / Watch user"}))}}]),a}(r.a.PureComponent);function Yn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}zn=Object(l.b)(function(e,t){return{whitelisted:e.whitelist.get("whitelist"),blacklisted:e.blacklist.get("blacklist")}},{addToBlacklist:Fe,removeFromBlacklist:Be,addToWhitelist:Ne,removeFromWhitelist:Ce})(zn);var Kn=function(e){Object(an.a)(a,e);var t=Yn(a);function a(){return Object(en.a)(this,a),t.apply(this,arguments)}return Object(tn.a)(a,[{key:"render",value:function(){var e=new wn.a.Converter({noHeaderId:!0,simplifiedAutoLink:!0}).makeHtml(this.props.userDetails.get("description")||"");return r.a.createElement("div",{className:"px12 py6"},r.a.createElement("h2",{className:"txt-m txt-uppercase txt-bold mr6 mb3"},"User"," ",this.props.userDetails.get("uid")&&"/ ".concat(this.props.userDetails.get("uid"))),this.props.userDetails.get("name")?r.a.createElement("div",{className:"flex-parent flex-parent--column align-items--center justify--space-between mb6"},r.a.createElement("div",null,r.a.createElement(Sn,{size:96,url:this.props.userDetails.get("img")}),r.a.createElement("div",{className:"mt6 txt-bold color-gray align-center"},this.props.userDetails.get("name"))),r.a.createElement("div",null,r.a.createElement("p",{className:"txt-s color-gray align-center"},this.props.userDetails.get("accountCreated")&&"Joined ".concat(Je()(this.props.userDetails.get("accountCreated")).fromNow(!0)," ago |"),this.props.userDetails.get("count")?"".concat(this.props.userDetails.get("count")," edits"):"".concat(this.props.userDetails.get("changesets_in_osmcha")," edits registered on OSMCha"))),r.a.createElement("div",null,r.a.createElement("p",{className:"txt-s color-gray align-center"},this.props.userDetails.get("harmful_changesets")," Bad and \xa0",this.props.userDetails.get("checked_changesets")-this.props.userDetails.get("harmful_changesets")," ","Good Changesets")),r.a.createElement("div",{className:"mt6"},r.a.createElement(zn,{user:this.props.userDetails})),r.a.createElement("div",{className:"mt12"},r.a.createElement(An.a,{className:"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition",to:{search:$e("filters",{users:[{label:this.props.userDetails.get("name"),value:this.props.userDetails.get("name")}],date__gte:[{label:"",value:""}]}),pathname:"/"}},"OSMCha"),r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",title:"Open in OSM",className:"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition",href:"https://www.openstreetmap.org/user/".concat(this.props.userDetails.get("name"))},"OSM"),r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",title:"Open in HDYC",className:"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition",href:"https://hdyc.neis-one.org/?".concat(this.props.userDetails.get("name"))},"HDYC"),r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",title:"Open in Missing Maps",className:"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition",href:"https://www.missingmaps.org/users/#/".concat(this.props.userDetails.get("name"))},"Missing Maps")),this.props.whosThat.size>1&&r.a.createElement("div",{className:"txt-s color-gray"},"Past usernames: \xa0",this.props.whosThat.slice(0,-1).map(function(e,t){return r.a.createElement("span",{key:t,className:"txt-em"},e,"\xa0")})),r.a.createElement("div",{className:"mt12"},r.a.createElement("p",{className:"txt-subhead txt-s txt-break-url user-description",dangerouslySetInnerHTML:{__html:e}}))):r.a.createElement("div",{className:"flex-parent flex-parent--column align-items--center justify--space-between mb6"},r.a.createElement("div",null,r.a.createElement(Sn,{size:96,url:this.props.userDetails.get("img")}),r.a.createElement("div",{className:"mt6 txt-bold color-gray align-center"},this.props.userDetails.get("name"))),r.a.createElement("div",{className:"flex-parent flex-parent--column mt6 mb3"},r.a.createElement(Mn,{text:"Sign in to see the user details"}))))}}]),a}(r.a.PureComponent),Qn=a(41),qn=a.n(Qn),Xn=function(e){var t=e.height,a=e.className;return r.a.createElement("div",{style:{height:t||"auto"},className:"".concat(a," flex-parent flex-parent--column flex-parent--center-cross flex-parent--center-main flex-child--grow")},r.a.createElement("div",{className:"flex-child loading"}))};function Zn(){return r.a.createElement("div",{className:"flex-parent flex-parent--column flex-parent--center-cross bg-gray-faint hfull-55"},r.a.createElement("div",{className:"flex-child flex-child--grow"},"\xa0"),r.a.createElement("div",{className:"flex-parent flex-parent--column flex-parent--center-cross"},r.a.createElement("svg",{className:"icon h160 w160 inline-block align-middle pb3"},r.a.createElement("use",{xlinkHref:"#icon-osm"}))),r.a.createElement("div",{className:"flex-parent flex-parent--column align-center txt-l txt-bold pt12"},"Sign in with your OpenStreetMap account to use OSMCha."),r.a.createElement("div",{className:"flex-parent flex-parent--column align-center txt-l pt36"},r.a.createElement(Mn,{className:"border--darken5 border--darken25-on-hover bg-gray-light color-gray-dark",text:"Sign in"})),r.a.createElement("div",{className:"flex-child flex-child--grow"},"\xa0"))}function $n(e,t,a){var n=new CustomEvent(e,{detail:t});(a||document.body).dispatchEvent(n)}var er,tr;a(288);function ar(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var nr,rr,cr,or=700,sr=500;function lr(e){e&&nr&&nr.emit("selectFeature","node|way",e)}var ir=qn()(function(){var e=document.getElementById("container");e&&tr&&(rr?Promise.resolve(rr):Promise.all([Jt("render"),Jt("getMapInstance")]).then(function(e){return rr=e[0],cr=e[1],rr})).then(function(t){t&&(nr=t(e,er,{width:or+"px",height:Math.max(400,sr)+"px",data:tr,disableSidebar:!0}))})},250),ur=function(e){Object(an.a)(a,e);var t=ar(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={visible:!1,height:0,width:0},e.ref=null,e.setRef=function(t){e.ref=t,e.setDimensions()},e.setDimensions=function(){if(e.ref){var t=e.ref.parentNode.getBoundingClientRect();if(sr=parseInt(window.innerHeight-55,10),or=parseInt(t.width,10),e.setState({height:sr,width:or}),cr){var a=cr();a&&a.map&&a.map.resize()}}},e}return Object(tn.a)(a,[{key:"componentDidMount",value:function(){if(er=this.props.changesetId,tr=this.props.currentChangesetMap,this.ref){var e=this.ref.parentNode.getBoundingClientRect();sr=parseInt(window.innerHeight-55,10),or=parseInt(e.width,10)}window.onresize=qn()(this.setDimensions,100),ir()}},{key:"componentWillUnmount",value:function(){window.onresize=null,nr&&nr.emit("remove")}},{key:"componentDidUpdate",value:function(e){this.props.currentChangesetMap===e.currentChangesetMap&&this.props.token===e.token||ir()}},{key:"render",value:function(){return this.props.errorChangesetMap&&($n("showToast",{title:"changeset-map failed to load",content:"Try reloading osmcha",timeOut:5e3,type:"error"}),console.error(this.props.errorChangesetMap)),er=this.props.changesetId,tr=this.props.currentChangesetMap,this.props.token?r.a.createElement("div",{className:""},r.a.createElement("div",{className:"relative",ref:this.setRef},r.a.createElement("div",{id:"container",className:"absolute",style:{height:this.state.height,width:this.state.width,visibility:this.props.loadingChangesetMap||this.props.errorChangesetMap?"hidden":"visible"}}),r.a.createElement(sn.a,{transitionName:"map-hide",transitionAppearTimeout:300,transitionAppear:!0,transitionEnterTimeout:300,transitionLeaveTimeout:1e3},(this.props.loadingChangesetMap||this.props.errorChangesetMap)&&r.a.createElement("div",{key:0,id:"placeholder",className:"absolute z0\n                    ".concat(this.props.errorChangesetMap?"bg-red-faint":"bg-black","\n                    "),style:{height:this.state.height,width:this.state.width}},r.a.createElement(Xn,{height:this.state.height}))))):r.a.createElement(Zn,null)}}]),a}(r.a.PureComponent);ur=Object(l.b)(function(e,t){return{changesetId:e.changeset.get("changesetId"),currentChangesetMap:e.changeset.getIn(["changesetMap",e.changeset.get("changesetId")]),errorChangesetMap:e.changeset.get("errorChangesetMap"),loadingChangesetMap:e.changeset.get("loadingChangesetMap"),token:e.auth.get("token")}})(ur);var pr=function(e){var t,a=e.data,n=e.changesetReasons;return t=a.get("reasons").size&&"number"===typeof a.get("reasons").get(0)?n.filter(function(e){return a.get("reasons").contains(e.get("id"))}):a.get("reasons"),r.a.createElement("tr",{className:"txt-s"},r.a.createElement("td",null,a.get("osm_id")),r.a.createElement("td",null,a.get("name")),r.a.createElement("td",null,a.get("note")?r.a.createElement("abbr",{title:a.get("note")},r.a.createElement(xn,{reasons:t,underline:!0,color:"blue"})):r.a.createElement(xn,{reasons:t,color:"blue"})),r.a.createElement("td",null,r.a.createElement("strong",{onClick:function(){return lr(parseInt(a.get("osm_id"),10))},className:"cursor-pointer txt-underline-on-hover mr6"},"Map"),r.a.createElement("strong",{className:"cursor-pointer txt-underline-on-hover"},r.a.createElement("a",{target:"_blank",href:"http://localhost:8111/load_object?objects=".concat(a.getIn(["url"],"").charAt(0)).concat(a.get("osm_id"))},"JOSM"))))};function mr(e){var t=e.properties,a=e.changesetId,n=t.get("features");return r.a.createElement("div",{className:"px12 py6"},r.a.createElement("div",null,r.a.createElement("h2",{className:"txt-m txt-uppercase txt-bold mr6 mb3"},"Flagged Features ",0!==n.size?"(".concat(n.size,")"):""),0===n.size?r.a.createElement("div",{className:"flex-parent flex-parent--column flex-parent--center-cross mb12"},r.a.createElement("svg",{className:"icon icon--xxl color-darken25"},r.a.createElement("use",{xlinkHref:"#icon-alert"})),r.a.createElement("p",{className:"txt-m"},"No features were flagged for ".concat(a,"."))):r.a.createElement("table",{className:"table osmcha-custom-table my12"},r.a.createElement("thead",null,r.a.createElement("tr",{className:"txt-s txt-uppercase"},r.a.createElement("th",null,"OSM Id"),r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Reasons"),r.a.createElement("th",null,"Actions"))),r.a.createElement("tbody",null,n.map(function(e,a){return r.a.createElement(pr,{key:a,data:e,changesetReasons:t.get("reasons")})})))))}var dr=a(68);function hr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}function fr(e){var t=new Map,a=e.map(function(e){return function(e,t){var a=Object.keys(t.properties.tags),n=Object.keys(e.properties.tags),r=n.filter(function(e){return-1===a.indexOf(e)}),c=a.filter(function(e){return-1===n.indexOf(e)}),o=n.filter(function(e){return-1===r.indexOf(e)&&-1===c.indexOf(e)}).filter(function(a){return e.properties.tags[a]!==t.properties.tags[a]}),s=new Map;return s.set("id",e.properties.id).set("addedTags",r.map(function(e){return"Added tag ".concat(e)})).set("deletedTags",c.map(function(e){return"Deleted tag ".concat(e)})).set("changedValues",o.map(function(e){return"Changed value of tag ".concat(e)})),s}(e[0],e[1])}),n=["addedTags","changedValues","deletedTags"];return a.map(function(e){return n.map(function(a){return e.get(a).forEach(function(a){t.get(a)?t.set(a,t.get(a).concat([e.get("id")])):t.set(a,[e.get("id")])})})}),t}function gr(e){return r.a.createElement("li",null,r.a.createElement("span",{className:"pointer",onClick:function(){return lr(e.id)}},e.id))}var br=function(e){Object(an.a)(a,e);var t=hr(a);function a(e){var n;return Object(en.a)(this,a),(n=t.call(this,e)).state={opened:!1},n.tag=e.change[0],n.value=e.change[1],n.handleChange=n.handleChange.bind(Object(dr.a)(n)),n}return Object(tn.a)(a,[{key:"handleChange",value:function(){this.setState({opened:!this.state.opened})}},{key:"render",value:function(){var e=this.tag.lastIndexOf(" ")+1;return r.a.createElement("div",null,r.a.createElement("span",{className:"pointer",onClick:this.handleChange},this.state.opened?r.a.createElement("svg",{className:"icon h18 w18 inline-block",style:{verticalAlign:"text-bottom"}},r.a.createElement("use",{xlinkHref:"#icon-chevron-down"})):r.a.createElement("svg",{className:"icon h18 w18 inline-block",style:{verticalAlign:"text-bottom"}},r.a.createElement("use",{xlinkHref:"#icon-chevron-right"})),this.tag.slice(0,e),r.a.createElement("span",{className:"txt-code"},this.tag.slice(e)),r.a.createElement("strong",{className:"bg-blue-faint color-blue-dark mx6 px6 py3 txt-s round"},this.value.length)),r.a.createElement("ul",{className:"cmap-vlist",style:{display:this.state.opened?"block":"none"}},this.value.map(function(e,t){return r.a.createElement(gr,{id:e,key:t})})))}}]),a}(r.a.PureComponent),vr=function(e){Object(an.a)(a,e);var t=hr(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={changesetId:e.props.changesetId,changes:e.props.changes},e}return Object(tn.a)(a,[{key:"componentWillReceiveProps",value:function(e){Object(O.is)(this.props.changes,e.changes)||this.setState({changes:e.changes})}},{key:"render",value:function(){var e,t=[];if(this.state&&this.state.changes&&this.state.changes.get(this.props.changesetId)){var a=this.state.changes.get(this.props.changesetId).featureMap;fr((e=a,Object.keys(e).map(function(t){return e[t]})).filter(function(e){return 2===e.length&&"modify"===e[0].properties.action})).forEach(function(e,a){return t.push([a,e])})}return r.a.createElement("div",{className:"px12 py6"},r.a.createElement("h2",{className:"txt-m txt-uppercase txt-bold mr6 mb3"},"Tag changes"),t.length?t.sort().map(function(e,t){return r.a.createElement(br,{key:t,change:e})}):r.a.createElement("span",null,"No tags were changed in this changeset."))}}]),a}(r.a.PureComponent);vr=Object(l.b)(function(e,t){return{changes:e.changeset.get("changesetMap")}})(vr);var yr=function(e){var t=e.children,a=(e.pullDown,e.pullUp,e.className),n=e.style,c=e.bg;return r.a.createElement("div",{className:"mb3 z4 bg-gray-faint ".concat(a," "),style:n},r.a.createElement("div",{className:"".concat(c," scroll-styled scroll-auto hmax360 hmin186")},t))};function xr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var Er=function(e){Object(an.a)(a,e);var t=xr(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={success:!1,error:!1,value:""},e.onChange=function(t){e.setState({value:t.target.value}),e.state.error&&e.setState({error:!1}),e.state.success&&e.setState({success:!1})},e.postComment=function(t){t&&(e.postCommentPromise=pn(function(e,t,a){return fetch("".concat(y,"/changesets/").concat(e,"/comment/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:t?"Token ".concat(t):""},body:JSON.stringify({comment:a})}).then(J).then(function(e){return e.json()})}(e.props.changesetId,e.props.token,t)),e.postCommentPromise.promise.then(function(t){e.setState({success:!0}),e.setState({error:!1}),e.setState({value:""})}).catch(function(t){console.log(t),e.setState({error:!0}),e.setState({success:!1})}))},e.handleSubmit=function(t){e.postComment(e.state.value)},e}return Object(tn.a)(a,[{key:"componentWillUnmount",value:function(){this.postCommentPromise&&this.postCommentPromise.cancel()}},{key:"componentDidMount",value:function(){this.updateValue(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.updateValue(e)}},{key:"updateValue",value:function(e){var t=e.discussions.filter(function(t){return t.get("userName")===e.userDetails.get("username")}).size>0;""!==this.state.value||null===e.changesetIsHarmful||t||(e.changesetIsHarmful?this.setState({value:e.userDetails.get("message_bad")}):this.setState({value:e.userDetails.get("message_good")}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,this.props.token&&r.a.createElement("div",{className:"flex-parent flex-parent--column mt6 mb3"},this.state.success&&r.a.createElement("div",{className:"bg-green-faint color-green inline-block px6 py3 txt-s align-center round my12"},r.a.createElement("strong",null,"Comment successfully posted."),r.a.createElement("br",null),r.a.createElement("span",null,"It will appear on OSMCha after some minutes.")),this.state.error&&r.a.createElement("div",{className:"bg-red-faint color-red-dark inline-block px6 py3 txt-s align-center round my12"},r.a.createElement("strong",null,"It was not possible to post your comment.")),r.a.createElement("div",{className:"grid grid--gut12"},r.a.createElement("div",{className:"col col--12"},r.a.createElement("textarea",{placeholder:"Provide constructive feedback to the mapper with a changeset comment.",className:"textarea",ref:function(t){e.clicked&&(t&&t.select(),e.clicked=!1)},value:this.state.value,onChange:this.onChange}),r.a.createElement("div",{className:"pt6 fr"},r.a.createElement(Fn,{className:"input wmax120",onClick:this.handleSubmit},"Post Comment"))))))}}]),a}(r.a.PureComponent);function kr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var Or=function(e){Object(an.a)(a,e);var t=kr(a);function a(){return Object(en.a)(this,a),t.apply(this,arguments)}return Object(tn.a)(a,[{key:"renderComments",value:function(){var e=this.props,t=e.discussions,a=e.changesetId;return 0===t.size?r.a.createElement("div",{className:"flex-parent flex-parent--column flex-parent--center-cross mb12"},r.a.createElement("svg",{className:"icon icon--xxl color-darken25"},r.a.createElement("use",{xlinkHref:"#icon-contact"})),r.a.createElement("p",{className:"txt-m"},"No discussions found for changeset ".concat(a,"."))):r.a.createElement("div",{className:""},t.map(function(e,t){return r.a.createElement("div",{key:t,className:"flex-parent flex-parent--column justify--space-between border border--gray-light round p6 my6 mt12"},r.a.createElement("div",{className:"flex-parent flex-parent--row justify--space-between txt-s "},r.a.createElement("span",null,"By ",r.a.createElement("strong",null,e.get("userName"),"\xa0")),r.a.createElement("span",null,Je()(e.get("timestamp")).fromNow())),r.a.createElement("div",{className:"flex-parent flex-parent--column mt6 mb3"},r.a.createElement("p",{className:"txt-break-url"},r.a.createElement(bn.a,{text:e.get("comment")},r.a.createElement(vn,null)))),r.a.createElement("div",{className:"flex-parent justify--flex-end"},r.a.createElement(yn,{text:e.get("comment")})))}))}},{key:"render",value:function(){var e=this.props,t=e.discussions,a=e.changesetId,n=e.changesetIsHarmful;return r.a.createElement("div",{className:"px12 py6"},r.a.createElement("h2",{className:"txt-m txt-uppercase txt-bold mr6 mb3"},"Discussions"),this.props.token?this.renderComments():r.a.createElement("div",null,r.a.createElement("div",{className:"flex-parent flex-parent--column flex-parent--center-cross mb12"},r.a.createElement("svg",{className:"icon icon--xxl color-darken25"},r.a.createElement("use",{xlinkHref:"#icon-contact"}))),r.a.createElement("div",{className:"flex-parent flex-parent--inline flex-parent--center-main mt6 mb3"},r.a.createElement(Mn,{text:"Sign in to read and post comments"}))),this.props.token&&r.a.createElement("div",{className:"flex-parent flex-parent--column justify--space-between my6 mt12"},r.a.createElement(Er,{changesetId:a,changesetIsHarmful:n,discussions:t,token:this.props.token,userDetails:this.props.userDetails})))}}]),a}(r.a.PureComponent);function Ar(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}Or=Object(l.b)(function(e,t){return{token:e.auth.get("token"),userDetails:e.auth.get("userDetails")}})(Or);var jr=function(e){Object(an.a)(a,e);var t=Ar(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={actions:!0,type:!0,mapStyle:!0,user:!0},e.onChange=function(){Jt("getMapInstance").then(function(e){return e&&e()&&e().filterLayers()})},e.toggleSatellite=function(){Jt("getMapInstance").then(function(e){return e&&e()&&e().renderMap("mapbox://styles/openstreetmap/cjnd8lj0e10i42spfo4nsvoay")})},e.toggleDark=function(){Jt("getMapInstance").then(function(e){return e&&e()&&e().renderMap("mapbox://styles/mapbox/dark-v9")})},e.toggleStreet=function(){Jt("getMapInstance").then(function(e){return e&&e()&&e().renderMap("mapbox://styles/mapbox/streets-v9")})},e.toggleBing=function(){var e={version:8,sources:{"raster-tiles":{type:"raster",tiles:["https://ecn.t0.tiles.virtualearth.net/tiles/a{quadkey}.jpeg?g=587&mkt=en-gb&n=z","https://ecn.t1.tiles.virtualearth.net/tiles/a{quadkey}.jpeg?g=587&mkt=en-gb&n=z","https://ecn.t2.tiles.virtualearth.net/tiles/a{quadkey}.jpeg?g=587&mkt=en-gb&n=z","https://ecn.t3.tiles.virtualearth.net/tiles/a{quadkey}.jpeg?g=587&mkt=en-gb&n=z"],attribution:'\xa9 <a href="https://blog.openstreetmap.org/2010/11/30/microsoft-imagery-details">Microsoft Corporation</a>'}},layers:[{id:"simple-tiles",type:"raster",source:"raster-tiles",minzoom:0,maxzoom:22}]};Jt("getMapInstance").then(function(t){return t&&t()&&t().renderMap(e)})},e}return Object(tn.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"px12 py6"},r.a.createElement("h2",{className:"txt-m txt-uppercase txt-bold mr6 mb3"},"Map Controls"),r.a.createElement("section",{className:"cmap-filter-action-section cmap-pt3"},r.a.createElement("h6",{className:"cmap-heading pointer txt-bold"},"Filter by actions"),r.a.createElement("ul",{className:"cmap-hlist"},r.a.createElement("li",null,r.a.createElement("label",{className:"cmap-hlist-item cmap-noselect cmap-pointer"},r.a.createElement("input",{type:"checkbox",value:"added",defaultChecked:"true",id:"cmap-layer-selector-added",onChange:this.onChange}),r.a.createElement("span",{className:"cmap-label-text"},"Added"),r.a.createElement("span",{className:"cmap-color-box cmap-color-added"}))),r.a.createElement("li",null,r.a.createElement("label",{className:"cmap-hlist-item cmap-noselect cmap-pointer"},r.a.createElement("input",{type:"checkbox",value:"modified",defaultChecked:"true",onChange:this.onChange,id:"cmap-layer-selector-modified"}),r.a.createElement("span",{className:"cmap-label-text"},"Modified"),r.a.createElement("span",{className:"cmap-color-box cmap-color-modified-old"}),r.a.createElement("span",{className:"cmap-unicode"},"\u2192"),r.a.createElement("span",{className:"cmap-color-box cmap-color-modified-new"}))),r.a.createElement("li",null,r.a.createElement("label",{className:"cmap-hlist-item cmap-noselect cmap-pointer"},r.a.createElement("input",{type:"checkbox",value:"deleted",defaultChecked:"true",onChange:this.onChange,id:"cmap-layer-selector-deleted"}),r.a.createElement("span",{className:"cmap-label-text"},"Deleted"),r.a.createElement("span",{className:"cmap-color-box cmap-color-deleted"}))))),r.a.createElement("section",{className:"cmap-filter-type-section"},r.a.createElement("h6",{className:"cmap-heading pointer txt-bold"},"Filter by type"),r.a.createElement("ul",{className:"cmap-hlist"},r.a.createElement("li",null,r.a.createElement("label",{className:"cmap-hlist-item cmap-noselect cmap-pointer"},r.a.createElement("input",{type:"checkbox",value:"nodes",defaultChecked:"true",id:"cmap-type-selector-nodes",onChange:this.onChange}),r.a.createElement("span",{className:"cmap-label-text"},"Nodes"))),r.a.createElement("li",null,r.a.createElement("label",{className:"cmap-hlist-item cmap-noselect cmap-pointer"},r.a.createElement("input",{type:"checkbox",value:"ways",defaultChecked:"true",id:"cmap-type-selector-ways",onChange:this.onChange}),r.a.createElement("span",{className:"cmap-label-text"},"Ways"))),r.a.createElement("li",null,r.a.createElement("label",{className:"cmap-hlist-item cmap-noselect cmap-pointer"},r.a.createElement("input",{type:"checkbox",value:"relations",defaultChecked:"true",id:"cmap-type-selector-relations",onChange:this.onChange}),r.a.createElement("span",{className:"cmap-label-text"},"Relations"))))),r.a.createElement("section",{className:"cmap-map-style-section cmap-pb3"},r.a.createElement("h6",{className:"cmap-heading pointer txt-bold"},"Map style"),r.a.createElement("ul",{className:"cmap-hlist"},r.a.createElement("li",null,r.a.createElement("label",{className:"cmap-hlist-item cmap-noselect pointer"},r.a.createElement("input",{type:"radio",value:"satellite",defaultChecked:"true",name:"baselayer",id:"cmap-baselayer-satellite",onClick:this.toggleSatellite}),r.a.createElement("span",{className:"cmap-label-text"},"Satellite"))),r.a.createElement("li",null,r.a.createElement("label",{className:"cmap-hlist-item cmap-noselect pointer"},r.a.createElement("input",{type:"radio",value:"streets",name:"baselayer",id:"cmap-baselayer-streets",onClick:this.toggleStreet}),r.a.createElement("span",{className:"cmap-label-text"},"Streets"))),r.a.createElement("li",null,r.a.createElement("label",{className:"cmap-hlist-item cmap-noselect pointer"},r.a.createElement("input",{type:"radio",value:"dark",name:"baselayer",id:"cmap-baselayer-dark",onClick:this.toggleDark}),r.a.createElement("span",{className:"cmap-label-text"},"Dark"))),r.a.createElement("li",null,r.a.createElement("label",{className:"cmap-hlist-item cmap-noselect pointer"},r.a.createElement("input",{type:"radio",value:"bing",name:"baselayer",id:"cmap-baselayer-bing",onClick:this.toggleBing}),r.a.createElement("span",{className:"cmap-label-text cmap-pointer"},"Bing"))))))}}]),a}(r.a.PureComponent);function wr(e){var t=e.active,a=e.onClick,n=e.children,c=(e.bg,e.className);return r.a.createElement("a",{className:"".concat(c," mx6 cursor-pointer txt-s inline-block txt-bold round p6 transition color-darken75\n                  ").concat(t?"bg-gray-faint":"bg-white-on-hover bg-lighten50"),onClick:a},n)}var Nr={label:"FILTER_BINDING",bindings:["\\"]},Cr={label:"HELP_BINDING",bindings:["/","?"]},Ir={label:"NEXT_CHANGESET",bindings:["down","right","space"]},Sr={label:"PREV_CHANGESET",bindings:["up","left"]},Tr={label:"REFRESH_CHANGESETS",bindings:["R","r"]},Dr={label:"CHANGESET_DETAILS_DETAILS",bindings:["1"]},Rr={label:"CHANGESET_DETAILS_SUSPICIOUS",bindings:["2"]},_r={label:"CHANGESET_DETAILS_TAGS",bindings:["3"]},Mr={label:"CHANGESET_DETAILS_DISCUSSIONS",bindings:["4"]},Pr={label:"CHANGESET_DETAILS_USER",bindings:["5"]},Ur={label:"CHANGESET_DETAILS_MAP",bindings:["6"]},Fr={label:"VERIFY_GOOD",bindings:["G","g"]},Br={label:"VERIFY_BAD",bindings:["B","b"]},Lr={label:"VERIFY_CLEAR",bindings:["C","c","u","U"]},Hr={label:"OPEN_IN_JOSM",bindings:["J","j"]},Gr={label:"OPEN_IN_ID",bindings:["I","i"]},Vr={label:"OPEN_IN_OSM",bindings:["O","o"]},Wr={label:"OPEN_IN_LEVEL0",bindings:["L","l"]},Jr={label:"OPEN_IN_ACHAVI",bindings:["V","v"]},zr={label:"OPEN_IN_HDYC",bindings:["H","h"]},Yr={label:"FILTER_BY_USER",bindings:["A","a"]};function Kr(e){var t=e.bindingsState,a=e.features,n=e.discussions,c=e.toggleDetails,o=e.toggleFeatures,s=e.toggleTags,l=e.toggleDiscussions,i=e.toggleUser,u=e.toggleMapOptions;return r.a.createElement(hn,{style:{marginTop:8,marginLeft:5}},r.a.createElement(wr,{active:t.get(Dr.label),onClick:c,bg:"gray-faint",className:"unround-r unround-bl"},r.a.createElement("svg",{className:"icon h18 w18 inline-block align-middle "},r.a.createElement("use",{xlinkHref:"#icon-eye"}))),r.a.createElement(wr,{active:t.get(Rr.label),onClick:o,bg:"gray-faint",className:"unround"},r.a.createElement("svg",{className:"icon h18 w18 inline-block align-middle ".concat(a&&0==a.size?"color-darken25":"color-black")},r.a.createElement("use",{xlinkHref:"#icon-alert"}))),r.a.createElement(wr,{active:t.get(_r.label),onClick:s,bg:"gray-faint",className:"unround"},r.a.createElement("svg",{className:"icon h18 w18 inline-block align-middle"},r.a.createElement("use",{xlinkHref:"#icon-hash"}))),r.a.createElement(wr,{active:t.get(Mr.label),onClick:l,bg:"white",className:"unround"},r.a.createElement("svg",{className:"icon h18 w18 inline-block align-middle ".concat(0==n.size?"color-darken25":"color-black")},r.a.createElement("use",{xlinkHref:"#icon-contact"}))),r.a.createElement(wr,{active:t.get(Pr.label),onClick:i,bg:"white",className:"unround"},r.a.createElement("svg",{className:"icon h18 w18 inline-block align-middle"},r.a.createElement("use",{xlinkHref:"#icon-user"}))),r.a.createElement(wr,{active:t.get(Ur.label),onClick:u,bg:"white",className:"unround-r unround-tl"},r.a.createElement("svg",{className:"icon h18 w18 inline-block align-middle"},r.a.createElement("use",{xlinkHref:"#icon-map"}))))}function Qr(e){return e.displayName||e.name||"Component"}function qr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}function Xr(e,t,a){var n,c;return c=n=function(n){Object(an.a)(o,n);var c=qr(o);function o(){var e;Object(en.a)(this,o);for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return(e=c.call.apply(c,[this].concat(a))).state={bindings:Object(O.Map)(),lastKeyStroke:Object(O.Map)()},e.toggleKey=function(t){var a=e.state.bindings,n=Object(O.Map)().set(t,!a.get(t));a=a.set(t,!a.get(t)),e.setState({bindings:a,lastKeyStroke:n})},e.exclusiveKeyToggle=function(t){var a=Object(O.Map)(),n=e.state.bindings.get(t);a=a.set(t,!n),e.setState({bindings:a,lastKeyStroke:a})},e}return Object(tn.a)(o,[{key:"componentDidMount",value:function(){var a=this;t.forEach(function(t){return un.a.bind(t.bindings,function(n){if(n.preventDefault(),e)return a.exclusiveKeyToggle(t.label);a.toggleKey(t.label)})})}},{key:"componentWillUnmount",value:function(){t.forEach(function(e){return e.bindings.forEach(function(e){un.a.unbind(e)})})}},{key:"render",value:function(){return r.a.createElement(a,Object.assign({},this.props,{bindingsState:this.state.bindings,lastKeyStroke:this.state.lastKeyStroke,toggleKey:this.toggleKey,exclusiveKeyToggle:this.exclusiveKeyToggle}))}}]),o}(r.a.PureComponent),n.displayName="HOCKeyboard".concat(Qr(a)),c}function Zr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}function $r(e,t,a){var n,c;return c=n=function(n){Object(an.a)(o,n);var c=Zr(o);function o(t){var a;return Object(en.a)(this,o),(a=c.call(this,t)).state={data:Object(O.Map)()},a._initFetching=function(t){a.fetchedData=e(t),Object.keys(a.fetchedData).forEach(function(e){a.fetchedData[e].promise.then(function(t){var n=a.state.data;n=n.set(e,Object(O.fromJS)(t)),a.setState({data:n})}).catch(function(e){return console.error(e)})})},a.reloadData=function(){a.initFetching(a.props)},a.initFetching=qn()(a._initFetching,500),a}return Object(tn.a)(o,[{key:"componentDidMount",value:function(){this.initFetching(this.props)}},{key:"componentWillReceiveProps",value:function(e){t(e,this.props)&&this.initFetching(e)}},{key:"componentWillUnmount",value:function(){var e=this;this.fetchedData&&Object.keys(this.fetchedData).forEach(function(t){e.fetchedData[t]&&e.fetchedData[t].cancel()})}},{key:"render",value:function(){return r.a.createElement(a,Object.assign({},this.props,{data:this.state.data,reloadData:this.reloadData}))}}]),o}(r.a.PureComponent),n.displayName="HOCFetchData".concat(Qr(a)),c}function ec(e,t){var a={},n=fetch("".concat(B,"/user/").concat(e)).then(function(e){return e.text()}).then(function(e){var t=(new DOMParser).parseFromString(e,"text/xml");t.getElementsByTagName("osm");var n=t.getElementsByTagName("osm")[0]&&t.getElementsByTagName("osm")[0].getElementsByTagName("user")[0];return a.count=n.getElementsByTagName("changesets")[0]&&n.getElementsByTagName("changesets")[0].getAttribute("count"),a.uid=n.getAttribute("id"),a.accountCreated=n.getAttribute("account_created"),a.description=n.getElementsByTagName("description")[0]&&n.getElementsByTagName("description")[0].innerHTML,a.img=n.getElementsByTagName("img")[0]&&n.getElementsByTagName("img")[0].getAttribute("href"),a.name=n.getAttribute("display_name"),a}).catch(function(e){return a}).then(function(e){return Object(O.fromJS)(e)}),r=fetch("".concat(y,"/user-stats/").concat(e,"/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:t?"Token ".concat(t):""}}).then(function(e){return e.json()}).then(function(e){return Object(O.fromJS)(e)}).catch(function(e){return new O.Map});return Promise.all([r,n]).then(function(e){var t=Object(Ve.a)(e,2),a=t[0],n=t[1];return a.merge(n)})}function tc(e){return fetch("".concat(L).concat(e),{method:"GET"}).then(J).then(function(e){return e.json()})}function ac(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var nc=function(e){Object(an.a)(a,e);var t=ac(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).state={userDetails:null,whosThat:null},e.showFloaters=function(){var t=e.props,a=t.changesetId,n=t.currentChangeset,c=t.bindingsState,o=t.data;if(c&&o){var s=n.get("properties");return r.a.createElement(sn.a,{name:"floaters",transitionName:"floaters",transitionAppearTimeout:300,transitionAppear:!0,transitionEnterTimeout:300,transitionLeaveTimeout:250},c.get(Dr.label)&&r.a.createElement(yr,{key:3,className:" responsive-box round-tr round-br"},r.a.createElement(On,{toggleUser:e.toggleUser,changesetId:a,properties:s,userEditCount:null!=e.state.userDetails?e.state.userDetails.get("count"):o.getIn(["userDetails","count"],0)})),c.get(Rr.label)&&r.a.createElement(yr,{key:2,className:" responsive-box round-tr round-br"},r.a.createElement(mr,{changesetId:a,properties:s})),c.get(_r.label)&&r.a.createElement(yr,{key:5,className:" responsive-box round-tr round-br"},r.a.createElement(vr,{changesetId:a})),c.get(Mr.label)&&r.a.createElement(yr,{key:1,className:" responsive-box  round-tr round-br"},r.a.createElement(Or,{changesetId:a,discussions:o.getIn(["osmComments"],Object(O.List)()),changesetIsHarmful:s.get("harmful")})),c.get(Pr.label)&&r.a.createElement(yr,{key:0,className:"responsive-box round-tr round-br"},r.a.createElement(Kn,{userDetails:o.getIn(["userDetails","name"])?o.getIn(["userDetails"],Object(O.Map)()):Object(O.Map)([["uid",e.props.currentChangeset.getIn(["properties","uid"])],["name",e.props.currentChangeset.getIn(["properties","user"])],["harmful_changesets",o.getIn(["userDetails","harmful_changesets"])],["checked_changesets",o.getIn(["userDetails","checked_changesets"])],["changesets_in_osmcha",o.getIn(["userDetails","changesets_in_osmcha"])]]),whosThat:o.getIn(["userDetails","name"])?o.getIn(["whosThat",0,"names"],Object(O.List)()):e.state.whosThat||Object(O.List)(),changesetUsername:!0})),c.get(Ur.label)&&r.a.createElement(yr,{key:4,className:"responsive-box round-tr round-br"},r.a.createElement(jr,null)))}},e.toggleFeatures=function(){e.props.exclusiveKeyToggle&&e.props.exclusiveKeyToggle(Rr.label)},e.toggleTags=function(){e.props.exclusiveKeyToggle&&e.props.exclusiveKeyToggle(_r.label)},e.toggleDiscussions=function(){e.props.exclusiveKeyToggle&&e.props.exclusiveKeyToggle(Mr.label)},e.toggleDetails=function(){e.props.exclusiveKeyToggle&&e.props.exclusiveKeyToggle(Dr.label)},e.toggleUser=function(){e.props.exclusiveKeyToggle&&e.props.exclusiveKeyToggle(Pr.label)},e.toggleMapOptions=function(){e.props.exclusiveKeyToggle&&e.props.exclusiveKeyToggle(Ur.label)},e}return Object(tn.a)(a,[{key:"componentDidMount",value:function(){this.toggleDetails()}},{key:"componentDidUpdate",value:function(e){var t=this;!e.currentChangeset.getIn(["properties","uid"])&&this.props.currentChangeset.getIn(["properties","uid"])&&(this.getUserDetailsPromise=pn(ec(this.props.currentChangeset.getIn(["properties","uid"],null),this.props.token)),this.getUserDetailsPromise.promise.then(function(e){t.setState({userDetails:e})}).catch(function(e){return console.log(e)}),this.getWhosThatPromise=pn(tc(this.props.currentChangeset.getIn(["properties","uid"],""))),this.getWhosThatPromise.promise.then(function(e){t.setState({whosThat:Object(O.List)(e[0].names)})}).catch(function(e){return console.log(e)}))}},{key:"render",value:function(){var e=this.props,t=e.data,a=e.bindingsState,n=e.currentChangeset.getIn(["properties","features"]);return r.a.createElement("div",{className:"flex-child clip"},r.a.createElement(Kr,{toggleDetails:this.toggleDetails,toggleFeatures:this.toggleFeatures,toggleTags:this.toggleTags,toggleDiscussions:this.toggleDiscussions,toggleUser:this.toggleUser,toggleMapOptions:this.toggleMapOptions,features:n,bindingsState:a,discussions:t&&t.getIn(["osmComments"],Object(O.List)())}),r.a.createElement(hn,{style:{marginTop:5,marginLeft:41}},this.showFloaters()))}}]),a}(r.a.PureComponent);nc.defaultProps={data:Object(O.Map)()};var rc=Xr(!0,[Dr,Rr,_r,Pr,Mr,Ur],nc);function cc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}rc=$r(function(e){return{userDetails:pn(ec(e.currentChangeset.getIn(["properties","uid"],null),e.token)),osmComments:(t="".concat(y,"/changesets/").concat(e.changesetId,"/comment/"),a=e.token,pn(a?fetch(t,{headers:{"Content-Type":"application/json",Authorization:a?"Token ".concat(a):""}}).then(mn).then(function(e){return e.json()}):fetch(t).then(mn).then(function(e){return e.json()}))),whosThat:pn(tc(e.currentChangeset.getIn(["properties","uid"],"")))};var t,a},function(e,t){return t.changesetId!==e.changesetId},rc),rc=Object(l.b)(function(e,t){return{token:e.auth.get("token")}})(rc);var oc=function(e){Object(an.a)(a,e);var t=cc(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).filterChangesetsByUser=function(){if(e.props.currentChangeset){var t=e.props.currentChangeset.getIn(["properties","user"]);e.props.applyFilters((new O.Map).set("users",Object(O.fromJS)([{label:t,value:t}])))}},e.showChangeset=function(){var t=e.props,a=t.loading,n=t.errorChangeset,c=t.currentChangeset,o=t.changesetId,s=t.token;return a||!c?null:n?($n("showToast",{title:"changeset:".concat(o," failed to load"),content:"Try reloading osmcha",timeOut:5e3,type:"error"}),console.error(n),null):r.a.createElement(rc,{changesetId:o,currentChangeset:c,token:s})},e}return Object(tn.a)(a,[{key:"componentDidMount",value:function(){un.a.bind(Yr.bindings,this.filterChangesetsByUser)}},{key:"componentWillUnmount",value:function(){Yr.bindings.forEach(function(e){return un.a.unbind(e)})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"flex-parent flex-parent--column clip"},this.showChangeset()))}}]),a}(r.a.PureComponent);function sc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}oc=Object(l.b)(function(e,t){return{changeset:e.changeset,location:t.location,changesetId:parseInt(t.match.params.id,10),currentChangeset:e.changeset.getIn(["changesets",parseInt(t.match.params.id,10)]),errorChangeset:e.changeset.get("errorChangeset"),loading:e.changeset.get("loading"),token:e.auth.get("token")}},{applyFilters:xt})(oc);var lc=new wn.a.Converter({ghCompatibleHeaderId:!0,extensions:[{type:"output",regex:/a href=/g,replace:'a class="link" href='},{type:"output",regex:/\<h3/g,replace:'<h3 class="txt-l txt-bold mt18"'},{type:"output",regex:/\<h2/g,replace:'<h2 class="txt-xl txt-bold mt24 mb12 border-b border--gray-light border--1"'},{type:"output",regex:/\<h1/g,replace:'<h1 class="txt-xl txt-bold mt24 mb12 border-b border--gray-light border--1"'},{type:"output",regex:/\<ul\>/g,replace:'<ul class="pl24">'},{type:"output",regex:/\<li\>/g,replace:'<li style="list-style-type: circle;">'},{type:"output",regex:/img src=/g,replace:'img\n      class="py12 my12 border border--gray-light border--2"\n      style="margin-left: auto;\n             margin-right: auto;\n             display: block;\n            " src='}]});lc.setFlavor("github"),lc.setOption("simpleLineBreaks",!1);var ic=function(e){Object(an.a)(a,e);var t=sc(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={about:null},e.cancellablePromise=null,e}return Object(tn.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.cancellablePromise=pn(fetch("https://raw.githubusercontent.com/mapbox/osmcha-frontend/master/ABOUT.md").then(function(e){return e.text()})),this.cancellablePromise.promise.then(function(t){return e.setState({about:lc.makeHtml(t)})}).catch(function(e){})}},{key:"componentWillUnmount",value:function(){this.cancellablePromise&&this.cancellablePromise.cancel()}},{key:"render",value:function(){return r.a.createElement("div",{className:"scroll-auto about-page-height flex-parent flex-parent--column pb12 flex-parent--center-cross"},r.a.createElement("div",{id:"guide",className:"pb36 px12 wmax720",dangerouslySetInnerHTML:{__html:this.state.about}}))}}]),a}(r.a.PureComponent),uc=function(){return r.a.createElement("div",null," stats here ")},pc=a(27);function mc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var dc=function(e){Object(an.a)(a,e);var t=mc(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).onChangeLocal=function(t){if(!t||""===t.value)return e.props.onChange(e.props.name);e.props.onChange(e.props.name,Object(O.fromJS)([t]))},e}return Object(tn.a)(a,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.options,n=e.placeholder,c=e.value;return r.a.createElement(pc.c,{name:t,value:c&&c.get(0)&&c.get(0).toJS(),options:a,placeholder:n,className:"",onChange:this.onChangeLocal})}}]),a}(r.a.PureComponent);function hc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var fc=function(e){Object(an.a)(a,e);var t=hc(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={isValid:!0},e.handleFormChange=function(t){var a=t.target,n="checkbox"===a.type?a.checked:a.value,r=a.name;if(e.setState({isValid:a.validity.valid}),!n||""===n)return e.props.onChange(r);e.props.onChange(r,Object(O.fromJS)([{label:n,value:n}]))},e}return Object(tn.a)(a,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.type,n=e.placeholder,c=e.display,o=e.value,s=e.className,l=e.min,i=e.max,u=this.state.isValid;return r.a.createElement("input",{name:t,className:"input ".concat(s," ").concat(u?"":"border border--1 border--red"),value:o&&o.getIn([0,"value"])||"",onChange:this.handleFormChange,type:a,placeholder:n||c,min:l,max:i})}}]),a}(r.a.Component);function gc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}fc.defaultProps={className:""};var bc=function(e){Object(an.a)(a,e);var t=gc(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).state={allToggle:"all_"===e.props.name.slice(0,4)},e.getAsyncOptions=function(){if(e.props.dataURL)return fetch("".concat(y,"/").concat(e.props.dataURL,"/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:e.props.token?"Token ".concat(e.props.token):""}}).then(function(e){return e.json()}).then(function(e){return{options:e.filter(function(e){return e.for_changeset}).map(function(e){return Object(S.a)({},e,{label:e.name,value:e.id})})}})},e.onChangeLocal=function(t){Array.isArray(t)&&e.sendData(e.state.allToggle,t)},e.sendData=function(t,a){var n="all_"===e.props.name.slice(0,4)?e.props.name.slice(4):e.props.name;if(n="".concat(t?"all_":"").concat(n),0===a.length)return e.props.onChange(n);var r=a.map(function(e){return{label:e.label,value:e.value}});e.props.onChange(n,Object(O.fromJS)(r))},e.renderSelect=function(){var t=e.props,a=t.name,n=t.options,c=t.placeholder,o=t.value,s=t.display;return t.dataURL?r.a.createElement(pc.a,{multi:!0,promptTextCreator:function(e){return"Add ".concat(e," to ").concat(s)},name:a,className:"",value:o&&o.toJS(),loadOptions:e.getAsyncOptions,onChange:e.onChangeLocal,placeholder:c}):r.a.createElement(pc.b,{multi:!0,promptTextCreator:function(e){return"Add ".concat(e," to ").concat(s)},name:a,value:o&&o.toJS(),options:n,onChange:e.onChangeLocal,placeholder:c})},e.handleToggle=function(t){var a=e.props.value;(a=a&&a.toJS())&&e.sendData(!e.state.allToggle,a),e.setState({allToggle:!e.state.allToggle})},e}return Object(tn.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:""},this.props.showAllToggle&&r.a.createElement("span",{className:"relative fr"},r.a.createElement("span",{className:"absolute",style:{left:-95,top:-30}},r.a.createElement("div",{className:"toggle-group txt-s mr18"},r.a.createElement("label",{className:"toggle-container"},r.a.createElement("input",{checked:!this.state.allToggle,name:"toggle".concat(this.props.name),type:"radio",onClick:this.handleToggle}),r.a.createElement("div",{className:"toggle toggle--gray-light"},"OR")),r.a.createElement("label",{className:"toggle-container"},r.a.createElement("input",{name:"toggle".concat(this.props.name),type:"radio",checked:this.state.allToggle,onClick:this.handleToggle}),r.a.createElement("div",{className:"toggle toggle--gray-light"},"AND"))))),this.renderSelect())}}]),a}(r.a.PureComponent),vc=function(e){Object(an.a)(a,e);var t=gc(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).getAsyncOptions=function(){if(e.props.dataURL)return fetch("".concat(y,"/").concat(e.props.dataURL,"/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:e.props.token?"Token ".concat(e.props.token):""}}).then(function(e){return e.json()}).then(function(e){return{options:e.map(function(e){return e.trusted?Object(S.a)({},e,{label:"".concat(e.name," (verified)"),value:e.name}):Object(S.a)({},e,{label:e.name.replace("(verified)",""),value:e.name})})}})},e.sendData=function(t,a){var n="all_"===e.props.name.slice(0,4)?e.props.name.slice(4):e.props.name;if(n="".concat(t?"all_":"").concat(n),0===a.length)return e.props.onChange(n);var r=a.map(function(e){return{label:e.label,value:e.value}});e.props.onChange(n,Object(O.fromJS)(r))},e}return a}(bc),yc=a(146),xc=a.n(yc),Ec=a(152),kc=a(147),Oc=a.n(kc);function Ac(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var jc=function(e){Object(an.a)(a,e);var t=Ac(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).state={geometry:Object,location:"",queryType:"q",lastSearch:new Date},e.queryTypeOptions=[{value:"q",label:"Any"},{value:"city",label:"City"},{value:"county",label:"County"},{value:"state",label:"State"},{value:"country",label:"Country"}],e.map=null,e.draw=null,e.clearBeforeDraw=function(t){"draw_polygon"===t.mode&&(e.clearMap(),e.draw.changeMode("draw_polygon"))},e.clearMap=function(){e.draw.deleteAll(),e.props.onChange(e.props.name,null),e.map.getSource("feature")&&e.map.getSource("feature").setData({}),e.map.getLayer("geometry")&&e.map.removeLayer("geometry")},e.drawingUpdate=function(t){var a=e.draw.getAll();a&&a.features.length&&a.features[0].geometry?e.updateMap(a.features[0].geometry):e.clearMap()},e.getAsyncOptions=function(t,a){return t.length>3?function(e,t){return fetch("".concat(H,"?polygon_geojson=1&format=json&").concat(t,"=").concat(e),{method:"GET"}).then(J).then(function(e){return e.json()})}(t,e.state.queryType).then(function(e){if(!Array.isArray(e))return a(null,{options:[]});var t=e.map(function(e){return{label:e.display_name,value:e.geojson}});return a(null,{options:t})}).catch(function(e){return a(e,null)}):a(null,{options:[]})},e.onChangeLocal=function(t){if(t){e.draw.deleteAll();var a=Object(Ec.a)(t.value,{tolerance:.1});e.updateMap(a)}},e.handleQueryTypeChange=function(t){e.setState({queryType:t})},e.renderSelect=function(){var t=e.props,a=t.name,n=t.placeholder,c=t.value;return r.a.createElement(pc.a,{name:a,className:"",value:c,loadOptions:e.getAsyncOptions,onChange:e.onChangeLocal,placeholder:n})},e}return Object(tn.a)(a,[{key:"updateMap",value:function(e){this.map.getSource("feature")?this.map.getSource("feature").setData(e):this.map.addSource("feature",{type:"geojson",data:{type:"Feature",geometry:e}}),void 0===this.map.getLayer("geometry")&&this.map.addLayer({id:"geometry",type:"fill",source:"feature",paint:{"fill-color":"#088","fill-opacity":.6}}),this.setState({geometry:e}),this.props.onChange(this.props.name,Object(O.fromJS)([{label:e,value:e}]));var t=xc()(e);this.map.fitBounds([t.slice(0,2),t.slice(2)],{padding:20})}},{key:"componentDidMount",value:function(){var e=this;Jt("getGL").then(function(t){if(t){var a=t();a.accessToken=M;var n=new a.Map({container:"geometry-map",style:"mapbox://styles/mapbox/light-v9"});e.map=n,e.draw=new Oc.a({displayControlsDefault:!1,controls:{polygon:!0}}),n.addControl(e.draw),n.on("draw.create",e.drawingUpdate),n.on("draw.modechange",e.clearBeforeDraw),n.on("draw.delete",e.drawingUpdate),n.on("draw.update",e.drawingUpdate),n.on("style.load",function(){try{e.updateMap(e.props.value.get("0").get("value").toJS())}catch(t){TypeError}})}})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"grid grid--gut12"},r.a.createElement("div",{className:"col col--4"},r.a.createElement(pc.c,{onChange:this.handleQueryTypeChange,options:this.queryTypeOptions,simpleValue:!0,value:this.state.queryType,placeholder:"Place Type"})),r.a.createElement("div",{className:"col col--8 pl3"},this.renderSelect())),r.a.createElement("div",{className:"grid grid--gut12 pt6"},r.a.createElement("div",{className:"col col--12 map-select"},r.a.createElement("div",{id:"geometry-map"},r.a.createElement("div",{onClick:this.clearMap,className:"pointer z5 m3 inline-block px6 py3 txt-s bg-white txt-bold round absolute fl",style:{zIndex:2}},"Clear All")))))}}]),a}(r.a.PureComponent);function wc(e){var t=e.display,a=e.children,n=e.description,c=e.handleFocus,o=void 0===c?function(){}:c,s=e.name,l=e.hasValue;return r.a.createElement("div",{className:"ml3 my12 flex-parent flex-parent--column",onClick:function(){return o(s)},onFocus:function(){return o(s)}},r.a.createElement("div",{className:"flex-parent flex-parent--row flex-parent--center-cross mt12 mb6 "},r.a.createElement("span",{className:"relative"},l&&r.a.createElement("svg",{style:{left:-18,top:-9},className:"absolute icon inline-block align-middle color-blue"},r.a.createElement("use",{xlinkHref:"#icon-circle"}))),r.a.createElement("strong",{className:"txt-truncate pointer"},t,"\xa0")),r.a.createElement("div",{className:"grid"},r.a.createElement("span",{className:"col col--6-mxl col--6-ml col--12-mm col--12"},a),window.innerWidth>800&&r.a.createElement("span",{className:"col col--3-mxl col--3-ml col--1-mm"},r.a.createElement("span",{className:"desc block relative ml12 wmin120"},r.a.createElement(sn.a,{transitionName:"filters-desc",transitionAppearTimeout:300,transitionEnterTimeout:300,transitionLeaveTimeout:200},n&&r.a.createElement("span",{key:0,className:"absolute wmin300 bg-white",style:{marginTop:-5}},n))))))}function Nc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var Cc=function(e){Object(an.a)(a,e);var t=Nc(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).handleChange=function(t){var a=e.props.activeFilters;a||(a=new O.Map),e.props.metaOf.forEach(function(e){a=a.delete(e)}),t&&t.value&&(a=a.merge(Object(O.fromJS)(t.value))),e.props.replaceFiltersState(a)},e.findCurrentValue=function(){var t,a=e.props.activeFilters;return a&&a.forEach(function(a,n){e.props.options.forEach(function(e){Object.keys(e.value)[0]===n&&a.getIn([0,"value"])===e.value[n][0].value&&(t=e)})}),t},e}return Object(tn.a)(a,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.placeholder,n=this.findCurrentValue();return r.a.createElement(pc.c,{name:t,value:n,options:this.props.options,placeholder:a,className:"",onChange:this.handleChange})}}]),a}(r.a.PureComponent),Ic=a(148),Sc=a.n(Ic);a(293);function Tc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var Dc=function(e){Object(an.a)(a,e);var t=Tc(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).handleDateChange=function(t){var a=t?t.format("YYYY-MM-DD"):null,n=e.props.name;a?e.props.onChange(n,Object(O.fromJS)([{label:a,value:a}])):e.props.onChange(n)},e}return Object(tn.a)(a,[{key:"render",value:function(){var e=this.props,t=e.placeholder,a=e.display,n=e.value,c=e.className,o=e.min,s=e.max,l=n&&n.getIn([0,"value"]);return r.a.createElement(Sc.a,{className:"input ".concat(c," date-width-full"),dateFormat:"YYYY-MM-DD",isClearable:!0,selected:l?Je()(n.getIn([0,"value"])):null,placeholderText:t||a,onChange:this.handleDateChange,minDate:o&&Je()(o),maxDate:s&&Je()(s)})}}]),a}(r.a.Component);function Rc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}Dc.defaultProps={className:""};var _c=function(e){Object(an.a)(a,e);var t=Rc(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).update=qn()(function(){if(e.map){var t=e.map&&e.map.getBounds(),a=t.getSouth().toFixed(4),n=t.getWest().toFixed(4),r=t.getNorth().toFixed(4),c=[n,a,t.getEast().toFixed(4),r].join(",");e.props.onChange(e.props.name,Object(O.fromJS)([{label:c,value:c}]))}},600),e.map=null,e.clearBbox=function(){e.props.onChange(e.props.name,null)},e}return Object(tn.a)(a,[{key:"componentDidMount",value:function(){var e=this;Jt("getGL").then(function(t){if(t){var a=t();a.accessToken=M,e.props.value;var n=new a.Map({container:"map",style:"mapbox://styles/mapbox/light-v9"});n.on("dragend",e.update),n.on("zoomend",e.update),n.on("touchend",e.update),e.map=n}})}},{key:"componentWillUnmount",value:function(){this.map&&this.map.remove()}},{key:"render",value:function(){return r.a.createElement("div",{className:"map-select border border--1  border--gray-light"},r.a.createElement("div",{onClick:this.clearBbox,className:"pointer z5 m3 inline-block px6 py3 txt-s bg-gray-light txt-bold round absolute fl"},"Clear"),r.a.createElement("div",{id:"map",style:{height:300,width:300}}))}}]),a}(r.a.Component);function Mc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}function Pc(e){return function(t){Object(an.a)(n,t);var a=Mc(n);function n(){return Object(en.a)(this,n),a.apply(this,arguments)}return Object(tn.a)(n,[{key:"render",value:function(){return this.props.loading?r.a.createElement(Xn,null):r.a.createElement(e,this.props)}}]),n}(r.a.PureComponent)}var Uc=a(59);function Fc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var Bc=Ye().getIn(["date__gte"]),Lc=Uc.filter(function(e){return!e.ignore}),Hc=function(e){Object(an.a)(a,e);var t=Fc(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).renderFilters=function(t,a){var n={name:t.name,type:t.type,display:t.display,value:e.props.filters.get(t.name),placeholder:t.placeholder,options:t.options||[],onChange:e.props.handleChange,dataURL:t.data_url,min:t.min,max:t.max},c={name:t.name,handleFocus:e.props.handleFocus,hasValue:e.props.filters.has(t.name),display:t.display,key:a,description:e.props.active===t.name&&t.description};if(t.range&&"number"===t.type){var o=e.props.filters.get(t.name+"__gte"),s=e.props.filters.get(t.name+"__lte");return r.a.createElement(wc,Object.assign({},c,{hasValue:e.props.filters.has(t.name+"__gte")||e.props.filters.has(t.name+"__lte")}),r.a.createElement("span",{className:"flex-parent flex-parent--row  "},r.a.createElement(fc,Object.assign({},n,{className:"mr3",name:t.name+"__gte",value:o,placeholder:"from",max:s&&s.getIn([0,"value"]),min:"0"})),r.a.createElement(fc,Object.assign({},n,{name:t.name+"__lte",value:s,placeholder:"to",min:o&&o.getIn([0,"value"])}))))}if(!t.range&&"number"===t.type)return r.a.createElement(wc,c,r.a.createElement(fc,Object.assign({},n,{className:"mr3",min:1,max:100})));if(t.range&&"date"===t.type){var l=e.props.filters.get(t.name+"__gte");"date"===t.name&&(l=e.props.filters.get(t.name+"__gte")||Bc);var i=e.props.filters.get(t.name+"__lte"),u=Je()().format("YYYY-MM-DD");return r.a.createElement(wc,Object.assign({},c,{hasValue:e.props.filters.has(t.name+"__gte")||e.props.filters.has(t.name+"__lte")}),r.a.createElement("span",{className:"flex-parent flex-parent--row h36"},r.a.createElement(Dc,Object.assign({},n,{name:t.name+"__gte",value:l,placeholder:"From",max:i&&i.getIn([0,"value"])||u})),r.a.createElement(Dc,Object.assign({},n,{name:t.name+"__lte",value:i,placeholder:"To",min:l&&l.getIn([0,"value"]),max:u}))))}if("location"===t.type)return r.a.createElement(wc,c,r.a.createElement(jc,n));if("text"===t.type)return r.a.createElement(wc,c,r.a.createElement(fc,n));if("radio"===t.type)return r.a.createElement(wc,c,r.a.createElement(dc,n));if("meta"===t.type)return r.a.createElement(wc,Object.assign({},c,{hasValue:t.metaOf.find(function(t){return e.props.filters.has(t)})}),r.a.createElement(Cc,Object.assign({},n,{replaceFiltersState:e.props.replaceFiltersState,metaOf:t.metaOf,activeFilters:e.props.filters})));if("text_comma"===t.type){var p=n.name,m=n.value,d=n.onChange;return t.all&&(d=e.props.handleToggleAll),t.all&&e.props.filters.has("all_".concat(t.name))&&(p="all_".concat(t.name),m=e.props.filters.get(p)),r.a.createElement(wc,Object.assign({},c,{name:p,hasValue:e.props.filters.has(p),description:e.props.active===t.name&&t.description}),p.endsWith("_teams")?r.a.createElement(vc,Object.assign({},n,{name:p,value:m,onChange:d,showAllToggle:t.all,token:e.props.token})):r.a.createElement(bc,Object.assign({},n,{name:p,value:m,onChange:d,showAllToggle:t.all,token:e.props.token})))}return"map"===t.type?r.a.createElement(wc,Object.assign({},c,{description:e.props.active===t.name&&r.a.createElement(_c,{onChange:e.props.handleChange,name:t.name,value:e.props.filters.get(t.name)})}),r.a.createElement(fc,n)):void 0},e}return Object(tn.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"px30 flex-child filters-scroll"},r.a.createElement("h2",{className:"txt-xl mr6 txt-bold mt24   border-b border--gray-light border--1"},"Basic"),Lc.slice(0,5).map(function(t,a){return e.renderFilters(t,a)}),r.a.createElement("h2",{className:"txt-xl mr6 txt-bold mt30  border-b border--gray-light border--1"},"Flags"),Lc.slice(5,7).map(function(t,a){return e.renderFilters(t,a)}),r.a.createElement("span",{className:"flex-child flex-child--grow wmin420 wmax435"}),r.a.createElement("h2",{className:"txt-xl mr6 txt-bold mt30  border-b border--gray-light border--1"},"Review"),Lc.slice(7,11).map(function(t,a){return e.renderFilters(t,a)}),r.a.createElement("span",{className:"flex-child flex-child--grow wmin420 wmax435"}),r.a.createElement("h2",{className:"txt-xl mr6 txt-bold mt30  border-b border--gray-light border--1"},"Users & Teams"),Lc.slice(11,17).map(function(t,a){return e.renderFilters(t,a)}),r.a.createElement("span",{className:"flex-child flex-child--grow wmin420 wmax435"}),r.a.createElement("h2",{className:"txt-xl mr6 txt-bold mt30  border-b border--gray-light border--1"},"Changeset Details"),Lc.slice(17).map(function(t,a){return e.renderFilters(t,a)}),r.a.createElement("span",{className:"flex-child flex-child--grow wmin420 wmax435"}))}}]),a}(r.a.PureComponent);function Gc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}Hc=Pc(Hc);var Vc,Wc=function(e){Object(an.a)(a,e);var t=Gc(a);function a(e){var n;return Object(en.a)(this,a),(n=t.call(this,e)).clicked=!1,n.onClick=function(e){n.clicked=!0,n.setState({editing:!0,value:n.props.name})},n.onChange=function(e){n.setState({value:e.target.value})},n.onKeyDown=function(e){13===e.keyCode?n.handleSubmit(e):27===e.keyCode&&(n.setState({editing:!1,value:n.props.name}),n.clicked=!1)},n.handleSubmit=function(e){n.setState({editing:!1});var t=n.props.aoiList.filter(function(e){return e.value===n.props.aoiId});n.props.aoiId&&t.length?n.props.updateAOI(n.props.aoiId,n.state.value):n.props.createAOI(n.state.value)},n.state={editing:!1,value:e.name},n}return Object(tn.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("span",null,this.state.editing?r.a.createElement("span",null,r.a.createElement("input",{ref:function(t){e.clicked&&(t.select(),e.clicked=!1)},value:this.state.value,onChange:this.onChange,onKeyDown:this.onKeyDown}),r.a.createElement(Fn,{onClick:this.handleSubmit,className:"mx3"},"Confirm Save")):r.a.createElement(Fn,{onClick:this.onClick,className:"border--0 bg-transparent"},"Save"))}}]),a}(r.a.PureComponent),Jc=function(e){Object(an.a)(a,e);var t=Gc(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={aoiList:[]},e.onAoiSelect=function(t){if(1===t.length)e.props.push(Object(S.a)({},e.props.location,{search:"aoi=".concat(t[0].value),path:"/filters"}));else if(t.length>1)throw new Error("filter select array is big")},e}return Object(tn.a)(a,[{key:"componentDidMount",value:function(){this.getAois()}},{key:"componentWillUnmount",value:function(){this.getAoisPromise&&this.getAoisPromise.cancel()}},{key:"getAois",value:function(){var e=this;this.props.token&&(this.getAoisPromise=pn(K(this.props.token)),this.getAoisPromise.promise.then(function(t){var a=t.features.map(function(e){return{label:e.properties.name,value:e.id}});e.setState({aoiList:a})}).catch(function(e){return console.log(e)}))}},{key:"renderRssLink",value:function(){if(this.props.aoiId)return r.a.createElement("a",{className:"txt--s pl6",href:"".concat(y,"/aoi/").concat(this.props.aoiId,"/changesets/feed/"),title:"RSS Feed"},r.a.createElement("svg",{className:"icon icon--s mt-neg3 inline-block align-middle bg-gray-faint color-darken25 color-darken50-on-hover transition"},r.a.createElement("use",{xlinkHref:"#icon-rss"})))}},{key:"renderAoiLink",value:function(){var e=this;if(this.props.aoiId)return r.a.createElement("a",{className:"txt--s pl6 pointer",onClick:function(t){return navigator.clipboard.writeText("".concat(y.replace("/api/v1",""),"/?aoi=").concat(e.props.aoiId))},title:"Copy filter URL"},r.a.createElement("svg",{className:"icon icon--s mt-neg3 inline-block align-middle bg-gray-faint color-darken25 color-darken50-on-hover transition"},r.a.createElement("use",{xlinkHref:"#icon-link"})))}},{key:"renderFilterInfo",value:function(){var e=r.a.createElement(Wn,{display:"My Filters",options:this.state.aoiList,onChange:this.onAoiSelect,value:[],onAdd:function(){},onRemove:function(){}});if(this.props.token&&this.state.aoiList.length)return r.a.createElement("span",null,e)}},{key:"render",value:function(){var e="";return this.props.token&&(e=r.a.createElement(Wc,{name:this.props.aoiName,aoiId:this.props.aoiId,aoiList:this.state.aoiList,createAOI:this.props.createAOI,updateAOI:this.props.updateAOI})),r.a.createElement("header",{className:"h55 hmin55 flex-parent px30 bg-gray-faint flex-parent--center-cross justify--space-between color-gray border-b border--gray-light border--1"},r.a.createElement("span",{className:"txt-s color-gray--dark"},this.renderFilterInfo()),r.a.createElement("span",{className:"txt-l txt-bold color-gray--dark"},r.a.createElement("span",null,"Filters",this.props.aoiId&&r.a.createElement("span",null," / ",this.props.aoiName),this.renderAoiLink(),this.renderRssLink())),r.a.createElement("span",{className:"txt-l color-gray--dark"},e,r.a.createElement(Fn,{className:"border--0 bg-transparent",onClick:this.props.handleClear},"Reset"),r.a.createElement(Fn,{onClick:this.props.handleApply,className:"mx3"},"Apply"),r.a.createElement(An.a,{to:{search:this.props.search,pathname:"/"},className:"mx3 pointer"},r.a.createElement("svg",{className:"icon icon--m inline-block align-middle bg-gray-faint color-darken25 color-darken50-on-hover transition"},r.a.createElement("use",{xlinkHref:"#icon-close"})))))}}]),a}(r.a.Component);function zc(e){Vc&&Vc.pageview(e)}function Yc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}Jc=Object(l.b)(function(e,t){return{location:t.location}},{push:s.c})(Jc),f&&(Vc=a(93));var Kc="unnamed *",Qc=Object(O.fromJS)({date__gte:[{label:"",value:""}]}),qc=function(e){Object(an.a)(a,e);var t=Yc(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={filters:e.props.filters,active:""},e.handleFocus=function(t){e.setState({active:t})},e.handleApply=function(){if(JSON.stringify(e.state.filters.toJSON()).length>7e3)e.props.modal({kind:"error",title:"Use Save Filter",description:"Your filter is too big to be applied. You need to Save your Filter to be able to see the results."});else{if(Object(O.is)(e.state.filters,e.props.filters))return void e.props.push(Object(S.a)({},e.props.location,{pathname:"/"}));e.props.applyFilters(e.state.filters,"/"),e.sendToAnalytics(),(t=3e3,pn(new Promise(function(e){return setTimeout(e,t)}))).promise.then(function(){return e.props.checkForNewChangesets(!0)})}var t},e.sendToAnalytics=function(){e.state.filters.forEach(function(e,t){e.forEach(function(e){var a;a={category:"Filters",action:t,label:e.get("label")},Vc&&Vc.event(a)})})},e.handleChange=function(t,a){var n=e.state.filters;return n="date__gte"===t&&null==a?n.merge(Qc):null==a?n.delete(t):n.set(t,a),e.setState({filters:n})},e.handleToggleAll=function(t,a){var n=e.state.filters;return n="all_"===t.slice(0,4)?n.delete(t.slice(4)):n.delete("all_"+t),n=a?n.set(t,a):n.delete(t),e.setState({filters:n})},e.replaceFiltersState=function(t){e.setState({filters:t})},e.handleClear=function(){e.props.applyFilters(new O.Map,"/")},e.loadAoiId=function(t){e.props.push(Object(S.a)({},e.props.location,{search:"aoi=".concat(t)}))},e.getAOIName=function(){return e.props.loading?"":e.props.aoi.getIn(["properties","name"],Kc)},e.getAOIId=function(t){return e.props.loading?"":e.props.aoi.get("id")},e.removeAOI=function(t){t===e.props.aoi.get("id")&&e.handleClear(),q(e.props.token,t).catch(function(e){return console.error(e)})},e.createAOI=function(t){e.props.applyCreateAOI(t,e.state.filters)},e.updateAOI=function(t,a){e.props.applyUpdateAOI(t,a,e.state.filters)},e}return Object(tn.a)(a,[{key:"componentWillReceiveProps",value:function(e){Object(O.is)(this.props.filters,e.filters)||this.setState({filters:e.filters})}},{key:"render",value:function(){var e=window.innerWidth;return r.a.createElement("div",{className:"flex-parent flex-parent--column changesets-filters bg-white ".concat(e<800?"viewport-full":"")},r.a.createElement(Jc,{createAOI:this.createAOI,updateAOI:this.updateAOI,removeAOI:this.removeAOI,loading:this.props.loading,token:this.props.token,aoiName:this.getAOIName(),aoiId:this.props.loading?"":this.props.aoi.get("id"),loadAoiId:this.loadAoiId,handleApply:this.handleApply,handleClear:this.handleClear,search:this.props.location.search}),r.a.createElement(Hc,{loading:this.props.loading,filters:this.state.filters,active:this.state.active,handleFocus:this.handleFocus,handleChange:this.handleChange,handleToggleAll:this.handleToggleAll,replaceFiltersState:this.replaceFiltersState,token:this.props.token}))}}]),a}(r.a.PureComponent);qc=Object(l.b)(function(e,t){return{filters:e.filters.get("filters"),aoi:e.aoi.get("aoi"),loading:e.filters.get("loading"),features:e.changesetsPage.getIn(["currentPage","features"]),location:t.location,token:e.auth.get("token")}},{checkForNewChangesets:_t,applyFilters:xt,applyCreateAOI:function(e,t){return st(ot.create,{name:e,filters:t})},applyUpdateAOI:function(e,t,a){return st(ot.update,{aoiId:e,name:t,filters:a})},push:s.c,modal:fe})(qc);var Xc=a(155),Zc=a(48),$c=a.n(Zc),eo=a(49),to=a.n(eo);function ao(e){var t=e.changesetId,a=(e.date,e.properties);return r.a.createElement("span",{className:"flex-parent flex-parent--row justify--space-between txt-light txt-s color-gray"},r.a.createElement("span",null,r.a.createElement("span",{className:"mr6"},t),a.get("checked")?r.a.createElement("span",null,a.get("harmful")?r.a.createElement("img",{src:to.a,alt:"Marked as bad",className:"icon inline-block"}):r.a.createElement("img",{src:$c.a,alt:"Marked as good",className:"icon inline-block"}),a.get("check_user")&&r.a.createElement("span",{className:"pl6"},"by ".concat(a.get("check_user")))):null),r.a.createElement("span",{className:"flex-parent flex-parent--row"},r.a.createElement(fn,{showZero:!0,className:"mr3",create:a.get("create"),modify:a.get("modify"),delete:a.get("delete")})))}function no(e){var t=e.reasons,a=e.comment,n=e.tags;return r.a.createElement("span",{className:"flex-parent flex-parent--column"},r.a.createElement("p",{className:"flex-child truncate-3-lines my6 txt-break-url"},a),r.a.createElement(xn,{reasons:t,color:"blue"}),r.a.createElement(xn,{reasons:n,color:"red"}))}function ro(e){var t=e.properties,a=(e.wasOpen,e.date);return r.a.createElement("div",null,r.a.createElement("span",{className:"flex-parent flex-parent--row justify--space-between align-items--center"},r.a.createElement("strong",{className:"txt-m mt3 mr6"},t.get("user")||r.a.createElement("i",null,"OSM User")),r.a.createElement("span",{className:"txt-s mr3"},"\xa0",Je()(a).fromNow())))}function co(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var oo=function(e){Object(an.a)(a,e);var t=co(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).wasOpen=!1,e}return Object(tn.a)(a,[{key:"shouldComponentUpdate",value:function(e){return e.properties!==this.props.properties||this.props.active||e.active}},{key:"render",value:function(){var e=this.props,t=e.properties,a=e.changesetId,n=e.active,c=e.inputRef,o=Object(Xc.a)(e,["properties","changesetId","active","inputRef"]);this.wasOpen||(this.wasOpen=this.props.active);var s="border-l border-l--4 border-color-neutral";!0===t.get("harmful")&&(s="border-l border-l--4 border-color-bad"),!1===t.get("harmful")&&(s="border-l border-l--4 border-color-good");var l="";return l+=n?"light-blue":this.wasOpen?" bg-darken5 ":"",r.a.createElement(An.a,{to:{search:window.location.search,pathname:"/changesets/".concat(a)}},r.a.createElement("div",{className:"".concat(l," ").concat(s),ref:c},r.a.createElement("div",Object.assign({},o,{className:"p12 cursor-pointer flex-parent flex-parent--column border-b border-b--1 border--gray-light"}),r.a.createElement("div",{className:"flex-parent flex-parent--column"},r.a.createElement("div",null,r.a.createElement(ro,{properties:t,wasOpen:this.wasOpen,date:t.get("date")})),r.a.createElement("div",null,r.a.createElement(no,{reasons:t.get("reasons"),tags:t.get("tags"),comment:t.get("comment")})),r.a.createElement("div",null,r.a.createElement(ao,{changesetId:a,properties:t,date:t.get("date")}))))))}}]),a}(r.a.PureComponent);function so(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var lo=function(e){Object(an.a)(a,e);var t=so(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).handleScroll=function(e){e&&(function(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=window.innerHeight&&t.right<=window.innerWidth}(e)||e.scrollIntoView({block:"end",behavior:"smooth"}))},e}return Object(tn.a)(a,[{key:"shouldComponentUpdate",value:function(e){return e.activeChangesetId!==this.props.activeChangesetId||e.currentPage!==this.props.currentPage}},{key:"render",value:function(){var e=this;return!this.props.token&&["/about","/filters","/user","/"].includes(this.props.location)?r.a.createElement("div",{className:"flex-parent flex-parent--column scroll-styled flex-child--grow py36"},r.a.createElement("div",{className:"flex-parent flex-parent--column flex-parent--center-cross"},r.a.createElement("svg",{className:"icon h60 w60 inline-block align-middle pb3"},r.a.createElement("use",{xlinkHref:"#icon-osm"}))),r.a.createElement("div",{className:"flex-parent flex-parent--center-main align-center txt-l pt36"},r.a.createElement(Mn,{text:"Sign in with your OpenStreetMap account"}))):r.a.createElement("ul",{className:"flex-parent flex-parent--column scroll-styled flex-child--grow"},r.a.createElement("div",null,this.props.currentPage&&this.props.currentPage.get("features").map(function(t,a){return r.a.createElement(oo,{active:t.get("id")===e.props.activeChangesetId,properties:t.get("properties"),changesetId:t.get("id"),inputRef:t.get("id")===e.props.activeChangesetId?e.handleScroll:null,key:a})})))}}]),a}(r.a.PureComponent);function io(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}lo=Pc(lo),lo=Object(l.b)(function(e,t){return{token:e.auth.get("token")}})(lo);var uo=function(e){Object(an.a)(a,e);var t=io(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r)))._onClick=function(){e.props.getChangesetsPage(e.props.pageIndex)},e}return Object(tn.a)(a,[{key:"render",value:function(){return r.a.createElement("button",{onClick:this._onClick,disabled:this.props.disabled,className:"flex-child btn btn--s color-gray round bg-gray-faint bg-darken10-on-active bg-darken5-on-hover\n          ".concat(this.props.active&&"is-active ","\n          ")},"number"===typeof this.props.page?this.props.page+1:r.a.createElement("svg",{className:"icon icon--s inline-block align-middle "},r.a.createElement("use",{xlinkHref:"#icon-".concat(this.props.page)})))}}]),a}(r.a.PureComponent),po=6;function mo(e){var t,a,n=e.pageIndex,c=e.getChangesetsPage,o=e.count,s=parseInt(n/po,10)*po,l=0;return o&&!Number.isNaN(o)&&(l=Math.ceil(o/_)),r.a.createElement("footer",{className:"hmin55 p12 border-t border--gray-light bg-gray-faint txt-s flex-parent justify--space-around"},r.a.createElement(uo,{page:"arrow-left",pageIndex:n-1,disabled:n-1===-1,active:!1,getChangesetsPage:c}),(t=s,a=Math.min(s+po,l),Object(O.Range)(t,a).map(function(e,a){return a+t})).map(function(e){return r.a.createElement(uo,{key:e,page:e,pageIndex:e,active:e===n,getChangesetsPage:c})}),r.a.createElement(uo,{page:"arrow-right",disabled:n+1>=l,pageIndex:n+1,active:!1,getChangesetsPage:c}))}var ho=a(299);function fo(e){var t=e.filters,a=e.handleFilterOrderBy,n=e.location,c=e.diffLoading,o=e.diff,s=e.currentPage,l=e.reloadCurrentPage,i=[],u=Uc.filter(function(e){return"order_by"===e.name})[0].options;return t.get("order_by")&&u.forEach(function(e){t.getIn(["order_by",0,"value"])===e.value&&i.push(e)}),r.a.createElement("div",null,r.a.createElement("header",{className:"px12 hmin36 border-b border--gray-light bg-gray-faint txt-s flex-parent justify--space-between align-items--center"},r.a.createElement(Wn,{onAdd:function(){},onRemove:function(){},onChange:a,value:i,options:Uc.filter(function(e){return"order_by"===e.name})[0].options,display:i[0]&&i[0].label||"Order by"}),r.a.createElement(ho.a,{activeStyle:{fontWeight:"bold"},to:{search:n.search,pathname:n.pathname.indexOf("/filters")>-1?"/":"/filters"}},r.a.createElement(Fn,{className:"mx3"},"Filters ",t.size>0&&"(".concat(t.size,")")))),r.a.createElement("header",{className:"px12 border-l border-b border-b--1 border--gray-light px12 py6 ".concat(o>0?"bg-darken10":"bg-gray-faint"," flex-child align-items--center")},r.a.createElement("span",{className:"flex-parent flex-parent--row justify--space-between color-gray txt-s txt-bold"},r.a.createElement("span",null,s&&s.getIn(["count"],0).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")||0," ","changesets."),r.a.createElement("span",{className:"flex-parent flex-parent--row"},c?r.a.createElement("span",{className:"loading loading--s inline"}):r.a.createElement(Fn,{className:"mx3 btn--xs",iconName:"rotate",onClick:l},o>0?"".concat(o," new"):"")))))}function go(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var bo,vo=function(e){Object(an.a)(a,e);var t=go(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).checkUpdate=null,e.maxPageCount=1/0,e.goUpDownToChangeset=function(t){if(e.props.currentPage){var a=e.props.currentPage.get("features");if(a){var n=a.findIndex(function(t){return t.get("id")===e.props.activeChangesetId});n+=t;var r=a.get(n);if(r){var c=Object(S.a)({},e.props.location,{pathname:"/changesets/".concat(r.get("id"))});e.props.push(c)}}}},e.handleFilterOrderBy=function(t){var a;a=e.props.filters.set("order_by",Object(O.fromJS)(t)),e.props.applyFilters(a)},e.reloadCurrentPage=function(){e.props.getChangesetsPage(e.props.pageIndex,!0)},e}return Object(tn.a)(a,[{key:"componentWillUnmount",value:function(){this.checkUpdate&&this.checkUpdate.cancel()}},{key:"toggleFilters",value:function(){if(this.props.location&&"/filters"===this.props.location.pathname){var e=Object(S.a)({},this.props.location,{pathname:"/"});this.props.push(e)}else{var t=Object(S.a)({},this.props.location,{pathname:"/filters"});this.props.push(t)}}},{key:"toggleHelp",value:function(){if(this.props.location&&this.props.location.pathname.startsWith("/about")){var e=Object(S.a)({},this.props.location,{pathname:"/"});this.props.push(e)}else{var t;(t=console).log.apply(t,Object(ie.a)(this.props.location));var a=Object(S.a)({},this.props.location,{pathname:"/about"});this.props.push(a)}}},{key:"componentWillReceiveProps",value:function(e){var t=e.lastKeyStroke;if(!Object(O.is)(this.props.lastKeyStroke,t))switch(t.keySeq().first()){case Nr.label:this.toggleFilters();break;case Cr.label:this.toggleHelp();break;case Ir.label:this.goUpDownToChangeset(1);break;case Sr.label:this.goUpDownToChangeset(-1);break;case Tr.label:this.reloadCurrentPage();break;default:return}}},{key:"render",value:function(){var e=this.props,t=e.filters,a=e.currentPage,n=e.loading,c=e.location,o=e.diff,s=e.diffLoading,l=e.activeChangesetId,i=e.pageIndex,u=e.getChangesetsPage;return r.a.createElement("div",{className:"flex-parent flex-parent--column changesets-list"},r.a.createElement(fo,{filters:t,handleFilterOrderBy:this.handleFilterOrderBy,location:c,currentPage:a,diff:o,diffLoading:s,reloadCurrentPage:this.reloadCurrentPage}),r.a.createElement(lo,{activeChangesetId:l,loading:n,currentPage:a,pageIndex:i,location:c.pathname?c.pathname:null}),r.a.createElement(mo,{pageIndex:i,getChangesetsPage:u,count:a&&a.get("count")}))}}]),a}(r.a.PureComponent);function yo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}vo=Xr(!1,[Ir,Sr,Nr,Cr,Tr],vo),vo=Object(l.b)(function(e,t){return{location:e.routing.location,loading:e.changesetsPage.get("loading"),error:e.changesetsPage.get("error"),currentPage:e.changesetsPage.get("currentPage"),diff:e.changesetsPage.get("diff"),diffLoading:e.changesetsPage.get("diffLoading"),pageIndex:e.changesetsPage.get("pageIndex")||0,activeChangesetId:e.changeset.get("changesetId"),filters:e.filters.get("filters"),aoiId:e.aoi.get("aoi").get("id")}},{getChangesetsPage:Rt,checkForNewChangesets:_t,applyFilters:xt,push:s.c})(vo);var xo=function(e){Object(an.a)(a,e);var t=yo(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={allTags:{},options:[]},e.tagsData=bo,e.getAsyncOptions=function(){return e.tagsData||(e.tagsData=pn(fetch("".concat(y,"/tags/")).then(function(e){return e.json()}))),e.tagsData.promise.then(function(t){var a={},n=t.filter(function(e){return e.is_visible&&e.for_changeset});n.forEach(function(e){a[e.name]=Object(S.a)({},e,{value:e.id,label:e.name})}),e.setState({allTags:a,options:n.map(function(e){return{label:e.name,value:e.id}})})}).catch(function(e){})},e.onAdd=function(t){if(t){var a=e.props,n=a.changesetId,r=a.currentChangeset;(0,a.handleChangesetModifyTag)(n,r,t,!1)}},e.onRemove=function(t){if(t){var a=e.props,n=a.changesetId,r=a.currentChangeset;(0,a.handleChangesetModifyTag)(n,r,t,!0)}},e.defaultValue=new O.Map,e}return Object(tn.a)(a,[{key:"componentDidMount",value:function(){this.getAsyncOptions()}},{key:"componentWillUnmount",value:function(){this.tagsData&&(bo=this.tagsData,this.tagsData.cancel())}},{key:"render",value:function(){if(!this.props.currentChangeset)return null;var e=this.props.currentChangeset.getIn(["properties","tags"],this.defaultValue).toJS().map(function(e){return{value:e.id,label:e.name}});return this.state.options?r.a.createElement(Wn,{eventTypes:["click","touchend"],multi:!0,onAdd:this.onAdd,onRemove:this.onRemove,disabled:this.props.disabled,className:"".concat(this.props.disabled?"cursor-notallowed":""),value:e,options:this.state.options,onChange:function(){},display:"Tags".concat(e.length>0?" (".concat(e.length,")"):"")}):null}}]),a}(r.a.PureComponent);function Eo(e){var t=e.title,a=e.className,n=e.buttons;return r.a.createElement("div",{className:"h55 hmin55 flex-parent px12 py6 bg-gray-dark flex-parent--center-cross justify--space-between ".concat(a)},r.a.createElement("span",{className:"flex-child flex-child--grow"},t||""),r.a.createElement("span",{className:"flex-child"},n))}function ko(e){var t=e.changeset,a=e.options,n=(e.className,e.onChange),c=(e.value,e.onClear),o=(e.username,e.checkUser);if(t.getIn(["properties","checked"])){var s=t.getIn(["properties","harmful"]);return r.a.createElement("div",{className:"flex-parent-inline"},r.a.createElement("span",{className:"btn btn--s border border--1 round color-gray transition pl12 pr6 ".concat(s?"bg-lighten50 border--red-light":"bg-lighten50 border--green-light")},r.a.createElement("span",null,r.a.createElement("img",{src:s?to.a:$c.a,alt:"Marked as ".concat(s?"bad":"good"),className:"icon inline-block mt3 w14 h14"}),o?r.a.createElement("span",{className:"ml6 mt3"},o):r.a.createElement("span",{className:"ml6 txt-em"},"Verified")),r.a.createElement("svg",{onClick:c,className:"icon inline-block align-middle pl3 pb3 w18 h18 pointer color-gray"},r.a.createElement("use",{xlinkHref:"#icon-close"}))))}return r.a.createElement("div",{className:"select-container"},r.a.createElement(Wn,{eventTypes:["click","touchend"],value:[],onAdd:function(){},onRemove:function(){},options:a,onChange:n,display:"Verify"}))}function Oo(e){var t=e.changesetId,a=e.coordinates,n=e.className;return r.a.createElement("div",{className:"select-container ".concat(n)},r.a.createElement(Wn,{onAdd:function(){},onRemove:function(){},value:[],options:[{label:"JOSM",value:"JOSM",href:"http://127.0.0.1:8111/import?url=https://www.openstreetmap.org/api/0.6/changeset/".concat(t,"/download")},{label:"iD",value:"iD",href:"https://www.openstreetmap.org/edit?editor=id&changeset=".concat(t,"#map=15/").concat(a&&a.get("1"),"/").concat(a&&a.get("0"))},{label:"OSM",value:"OSM",href:"https://www.openstreetmap.org/changeset/".concat(t)},{label:"Achavi",value:"Achavi",href:"https://overpass-api.de/achavi/?changeset=".concat(t,"&relations=true")},{label:"Level 0",value:"Level 0",href:"http://level0.osmz.ru/?url=changeset/".concat(t)}],display:"Open with"}))}function Ao(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var jo=function(e){Object(an.a)(a,e);var t=Ao(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).handleVerify=function(t){if(1===t.length)e.props.handleChangesetModifyHarmful(e.props.changesetId,e.props.currentChangeset,t[0].value);else if(t.length>1)throw new Error("verify array is big")},e.handleVerifyClear=function(){e.props.handleChangesetModifyHarmful(e.props.changesetId,e.props.currentChangeset,-1)},e}return Object(tn.a)(a,[{key:"componentWillReceiveProps",value:function(e){if(this.props.currentChangeset){var t=e.lastKeyStroke;if(!Object(O.is)(this.props.lastKeyStroke,t))switch(t.keySeq().first()){case Br.label:this.props.handleChangesetModifyHarmful(this.props.changesetId,this.props.currentChangeset,!0);break;case Lr.label:this.props.handleChangesetModifyHarmful(this.props.changesetId,this.props.currentChangeset,-1);break;case Fr.label:this.props.handleChangesetModifyHarmful(this.props.changesetId,this.props.currentChangeset,!1);break;case Hr.label:if(!this.props.changesetId)return;var a="http://127.0.0.1:8111/import?url=https://www.openstreetmap.org/api/0.6/changeset/".concat(this.props.changesetId,"/download");window.open(a,"_blank");break;case Gr.label:if(!this.props.changesetId||!this.props.currentChangeset)return;var n=this.props.currentChangeset.getIn(["geometry","coordinates",0,0]),r="https://www.openstreetmap.org/edit?changeset=".concat(this.props.changesetId,"#map=15/").concat(n&&n.get("1"),"/").concat(n&&n.get("0"));window.open(r,"_blank");break;case Vr.label:if(!this.props.changesetId)return;var c="https://www.openstreetmap.org/changeset/".concat(this.props.changesetId);window.open(c,"_blank");break;case Wr.label:if(!this.props.changesetId)return;var o="http://level0.osmz.ru/?url=changeset/".concat(this.props.changesetId);window.open(o,"_blank");break;case Jr.label:if(!this.props.changesetId)return;var s="https://overpass-api.de/achavi/?changeset=".concat(this.props.changesetId);window.open(s,"_blank");break;case zr.label:var l=this.props.currentChangeset.getIn(["properties","user"],""),i="https://hdyc.neis-one.org/?".concat(l);window.open(i,"_blank");break;default:return}}}},{key:"render",value:function(){var e=this,t=window.innerWidth;return r.a.createElement(Eo,{className:"bg-gray-faint color-gray border-b border--gray-light border--1 px30",title:r.a.createElement("div",{className:"flex-parent flex-parent--row justify--space-between flex-parent--wrap"},r.a.createElement("span",{className:"flex-parent align-items--center"},t<800&&r.a.createElement(An.a,{to:{search:this.props.location.search,pathname:"/"}},"<  "),r.a.createElement("span",{className:"txt-l color-gray--dark"},r.a.createElement("strong",null,"Changeset:")," ",r.a.createElement("span",{className:"txt-underline mr12"},r.a.createElement("a",{href:"https://www.openstreetmap.org/changeset/".concat(this.props.changesetId),target:"_blank",rel:"noopener noreferrer",title:"See on OSM"},this.props.changesetId),r.a.createElement("a",{className:"txt--s pl6 pointer",onClick:function(t){return navigator.clipboard.writeText("".concat(y.replace("/api/v1",""),"/changesets/").concat(e.props.changesetId))},title:"Copy OSMCha Changeset URL"},r.a.createElement("svg",{className:"icon icon--s mt-neg3 inline-block align-middle bg-gray-faint color-darken25 color-darken50-on-hover transition"},r.a.createElement("use",{xlinkHref:"#icon-link"}))))),r.a.createElement(Oo,{changesetId:this.props.changesetId,className:"ml3",coordinates:this.props.currentChangeset&&this.props.currentChangeset.getIn(["geometry","coordinates",0,0])})),r.a.createElement("span",null,this.props.currentChangeset&&r.a.createElement("span",null,this.props.currentChangeset.getIn(["properties","check_user"])&&r.a.createElement(xo,{changesetId:this.props.changesetId,currentChangeset:this.props.currentChangeset,disabled:!1,handleChangesetModifyTag:this.props.handleChangesetModifyTag}),r.a.createElement(ko,{changeset:this.props.currentChangeset,placeholder:"Verify",value:[],onChange:this.handleVerify,onClear:this.handleVerifyClear,username:this.props.username,checkUser:this.props.currentChangeset.getIn(["properties","check_user"]),options:[{value:!1,label:"Good"},{value:!0,label:"Bad"}],className:"select--s"}))))})}}]),a}(r.a.PureComponent);function wo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}jo=Xr(!1,[Br,Fr,Lr,Hr,Gr,Vr,Wr,Jr,zr],jo),jo=Object(l.b)(function(e,t){return{location:t.location,changesetId:parseInt(e.changeset.get("changesetId"),10),currentChangeset:e.changeset.getIn(["changesets",parseInt(e.changeset.get("changesetId"),10)]),username:e.auth.getIn(["userDetails","username"])}},{handleChangesetModifyTag:function(e,t,a,n){return oa(ra.tag,{oldChangeset:t,changesetId:e,tag:a,remove:n})},handleChangesetModifyHarmful:function(e,t,a){return oa(ra.harmful,{oldChangeset:t,changesetId:e,harmful:a})}})(jo);var No=function(e){Object(an.a)(a,e);var t=wo(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={isMenuOpen:!1},e.handleLoginClick=function(){var t=e.props.oAuthToken;t&&(Tn("oauth_popup",d||g?"/local-landing.html#".concat(t):"".concat(F,"?oauth_token=").concat(t)),Rn().then(function(t){e.props.getFinalToken(t.oauth_verifier)}))},e.onUserMenuSelect=function(t){if(1===t.length)"/logout"===t[0].url?e.props.logUserOut():(console.log(e.props.push),e.props.push(Object(S.a)({},e.props.location,{search:e.props.location.search,pathname:t[0].url})));else if(t.length>1)throw new Error("filter select array is big")},e.openMenu=function(){e.setState({isMenuOpen:!e.state.isMenuOpen})},e}return Object(tn.a)(a,[{key:"renderUserMenuOptions",value:function(){var e=this.props.username;return r.a.createElement(Wn,{display:e?e.slice(0,10):"User",options:[{label:"Account settings",url:"/user"},{label:"My saved filters",url:"/saved-filters"},{label:"My teams",url:"/teams"},{label:"My trusted users list",url:"/trusted-users"},{label:"My watchlist",url:"/watchlist"},{label:"Logout",url:"/logout"}],onChange:this.onUserMenuSelect,value:[],onAdd:function(){},onRemove:function(){}})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Eo,{className:"navbar-logo bg-gray-faint border-b border--gray-light border--1",title:r.a.createElement("span",{className:"color-gray"},r.a.createElement(An.a,{to:{search:window.location.search,pathname:"/"}},r.a.createElement("span",{className:"txt-xl"},r.a.createElement("strong",{className:"color-blue"},"OSM"),"Cha")),r.a.createElement("span",{className:"relative"},r.a.createElement("span",{className:"txt-xs txt-mono absolute w72",style:{top:17,left:-118}},"v",b,d&&" Dev",g&&" Local",h&&" Staging"))),buttons:r.a.createElement("div",{className:"flex-parent flex-parent--row"},r.a.createElement(An.a,{className:"pr3 pointer",to:{search:window.location.search,pathname:"/about"}},r.a.createElement("svg",{className:"icon icon--m inline-block align-middle color-darken25 color-darken50-on-hover transition"},r.a.createElement("use",{xlinkHref:"#icon-question"}))),this.props.token?r.a.createElement("div",{className:"mr3 pointer"},this.renderUserMenuOptions()):r.a.createElement(Fn,{onClick:this.handleLoginClick,disable:!this.props.oAuthToken,iconName:"osm"},"Sign in"))}))}}]),a}(r.a.PureComponent);No=Object(l.b)(function(e,t){return{location:e.routing.location,changesetId:parseInt(e.changeset.get("changesetId"),10),currentChangeset:e.changeset.getIn(["changesets",parseInt(e.changeset.get("changesetId"),10)]),oAuthToken:e.auth.get("oAuthToken"),token:e.auth.get("token"),username:e.auth.getIn(["userDetails","username"]),avatar:e.auth.getIn(["userDetails","avatar"])}},{getOAuthToken:function(){return ja(Aa.postSocialToken)},getFinalToken:wa,logUserOut:Na,push:s.c})(No);var Co=a(149),Io=a.n(Co),So=a(150),To=a.n(So);function Do(){return r.a.createElement("div",{className:"flex-parent flex-parent--column flex-parent--center-cross h-full"},r.a.createElement("div",{className:"flex-child flex-child--grow"},"\xa0"),r.a.createElement("div",{className:"flex-parent flex-parent--column flex-parent--center-cross "},r.a.createElement("img",{src:Io.a,className:"osmcha-logo",alt:"OSMCHA"}),r.a.createElement("img",{src:To.a,className:"pt36 workflow-img",alt:"Validation tool for OpenStreetmap"})),r.a.createElement("div",{className:"flex-child flex-child--grow"},"\xa0"),r.a.createElement("div",{className:"flex-parent flex-parent--column align-center txt-l"},r.a.createElement("div",{className:"txt-xl"},"v",b,d&&" Dev",h&&" Staging",g&&" Local"),r.a.createElement("div",{className:"flex-parent flex-parent--row flex-parent--center-main"},r.a.createElement(An.a,{className:"link link--gray flex-parent flex-parent--row flex-parent--center-cross mx6",to:"/about"},r.a.createElement("svg",{className:"icon"},r.a.createElement("use",{xlinkHref:"#icon-info"}))," ",r.a.createElement("span",null,"Guide"))," ","|"," ",r.a.createElement("a",{target:"__blank",className:"link link--gray  flex-parent flex-parent--row flex-parent--center-cross mx6",href:"https://github.com/mapbox/osmcha-frontend/blob/master/CONTRIBUTING.md"},r.a.createElement("svg",{className:"icon"},r.a.createElement("use",{xlinkHref:"#icon-github"}))," ",r.a.createElement("span",null,"GitHub"))," ","|"," ",r.a.createElement("a",{target:"__blank",className:"link link--gray  flex-parent flex-parent--row flex-parent--center-cross mx6",href:"https://github.com/mapbox/osmcha-frontend/issues"},r.a.createElement("svg",{className:"icon"},r.a.createElement("use",{xlinkHref:"#icon-bug"}))," ",r.a.createElement("span",null,"File an issue")))),r.a.createElement("div",{className:"flex-child flex-child--grow"},"\xa0"))}var Ro=a(151),_o=a.n(Ro);function Mo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var Po=function(e){Object(an.a)(a,e);var t=Mo(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).ref=null,e.sendNotification=function(t){var a=t.uid;e.ref&&e.ref.addNotification({uid:a,title:t.title,message:t.error&&t.error.message||t.description,level:t.kind,autoDismiss:t.autoDismiss,position:t.position,dismissible:t.dismiss,action:t.callbackLabel&&{label:t.callbackLabel,callback:function(){return t.activateModalCallback(a)}},onRemove:function(){t.dismissModalCallback(a)}})},e.addRef=function(t){e.ref=t},e}return Object(tn.a)(a,[{key:"componentDidMount",value:function(){this.props.error&&this.sendNotification(this.props)}},{key:"componentWillUpdate",value:function(e){this.sendNotification(e)}},{key:"render",value:function(){return r.a.createElement(_o.a,{ref:this.addRef})}}]),a}(r.a.PureComponent);function Uo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}Po.defaultProps={title:"Error",description:"Oops there was a problem. Please reload the app.",autoDismiss:5,dismiss:!0,position:"tr",kind:"error"},Po=Object(l.b)(function(e){return{error:e.modal.get("error"),callback:e.modal.get("callback"),callbackLabel:e.modal.get("callbackLabel"),title:e.modal.get("title"),description:e.modal.get("description"),dismiss:e.modal.get("dismiss"),position:e.modal.get("position"),autoDismiss:e.modal.get("autoDismiss"),kind:e.modal.get("kind"),uid:e.modal.get("uid")}},{dismissModalCallback:function(e){return ge(he,{uid:e})},activateModalCallback:function(e){return ge(de,{uid:e})}})(Po);var Fo=function(e){Object(an.a)(a,e);var t=Uo(a);function a(e){var n;return Object(en.a)(this,a),(n=t.call(this,e)).onChangeMessageGood=function(e){n.setState({message_good:e.target.value})},n.onChangeMessageBad=function(e){n.setState({message_bad:e.target.value})},n.handleSubmit=function(e){n.props.applyUpdateUserDetails(n.state.message_good,n.state.message_bad,n.state.comment_feature)},n.state={message_good:e.userDetails.get("message_good"),message_bad:e.userDetails.get("message_bad"),comment_feature:e.userDetails.get("comment_feature")},n}return Object(tn.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState({message_good:e.userDetails.get("message_good")}),this.setState({message_bad:e.userDetails.get("message_bad")}),this.setState({comment_feature:e.userDetails.get("comment_feature")})}},{key:"renderGoodBadImg",value:function(e){return r.a.createElement("img",{src:e?$c.a:to.a,alt:"".concat(e?"good":"bad"),className:"icon inline-block mt3"})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("span",{className:"ml12 flex-parent flex-parent--row my3 pt12"},r.a.createElement("p",{className:"flex-child txt-m"},"Default comment for changesets reviewed as GOOD"," ",this.renderGoodBadImg(!0),":")),r.a.createElement("textarea",{placeholder:"Define a default message to the changesets you review as good. You can edit it before post a comment.",className:"textarea ml12",value:this.state.message_good,onChange:this.onChangeMessageGood}),r.a.createElement("span",{className:"ml12 flex-parent flex-parent--row my3 pt18"},r.a.createElement("p",{className:"flex-child txt-m"},"Default comment for changesets reviewed as BAD"," ",this.renderGoodBadImg(),":")),r.a.createElement("textarea",{placeholder:"Define a default message to the changesets you review as bad. You can edit it before post a comment.",className:"textarea ml12",value:this.state.message_bad,onChange:this.onChangeMessageBad}),r.a.createElement(Fn,{className:"input wmax180 ml12 mt6",onClick:this.handleSubmit},"Save Preferences"))}}]),a}(r.a.PureComponent);function Bo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}Fo=Object(l.b)(function(e,t){return{userDetails:e.auth.getIn(["userDetails"],Object(O.Map)())}},{applyUpdateUserDetails:function(e,t,a){return ja(Aa.updateUserDetails,{message_good:e,message_bad:t,comment_feature:a})}})(Fo);var Lo=function(e){Object(an.a)(a,e);var t=Bo(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={userValues:null},e.onUserChange=function(t){if(Array.isArray(t)&&0===t.length)return e.setState({userValues:null});e.setState({userValues:t})},e}return Object(tn.a)(a,[{key:"render",value:function(){var e=this,t=this.props.userDetails;return r.a.createElement("div",{className:"flex-parent flex-parent--column changesets-filters bg-white".concat(window.innerWidth<800?"viewport-full":"")},r.a.createElement("header",{className:"h55 hmin55 flex-parent px30 bg-gray-faint flex-parent--center-cross justify--space-between color-gray border-b border--gray-light border--1"},r.a.createElement("span",{className:"txt-l txt-bold color-gray--dark"},r.a.createElement("span",null,"Account Settings")),r.a.createElement("span",{className:"txt-l color-gray--dark"},r.a.createElement(Fn,{onClick:this.props.logUserOut,className:"bg-white-on-hover"},"Logout"))),r.a.createElement("div",{className:"px30 flex-child  pb60  filters-scroll"},r.a.createElement("span",{className:"flex-parent flex-parent--row align justify--space-between  mr6 txt-bold mt24"},r.a.createElement(Sn,{size:72,url:this.props.avatar}),r.a.createElement("span",{className:"flex-child flex-child--grow pl24  pt18",style:{alignSelf:"center"}},r.a.createElement("h2",{className:"txt-xl"},"Welcome,"," ",t.get("username")?t.get("username"):"stranger","!"),r.a.createElement("div",{className:"flex-child flex-child--grow"},"\xa0"))),r.a.createElement("div",{className:"flex-parent flex-parent--column align justify--space-between"},r.a.createElement("h2",{className:"pl12 txt-xl mr6 txt-bold mt24 mb12 border-b border--gray-light border--1"},"Info"),r.a.createElement("span",{className:"ml12 flex-parent flex-parent--row my3"},r.a.createElement("p",{className:"flex-child txt-bold w120"},"OSMCha ID: "),r.a.createElement("p",{className:"flex-child"},t.get("id"))),r.a.createElement("span",{className:"ml12 flex-parent flex-parent--row my3"},r.a.createElement("p",{className:"flex-child txt-bold w120"},"OSM ID: "),r.a.createElement("p",{className:"flex-child"},t.get("uid"))),r.a.createElement("span",{className:"ml12 flex-parent flex-parent--row my3"},r.a.createElement("p",{className:"flex-child txt-bold w120"},"Username: "),r.a.createElement("p",{className:"flex-child"},t.get("username"))),t.get("is_staff")&&r.a.createElement("span",{className:"ml12 flex-parent flex-parent--row my3"},r.a.createElement("p",{className:"flex-child txt-bold w120"},"Staff: "),r.a.createElement("p",{className:"flex-child"},"Yes")),r.a.createElement("span",{className:"ml12 flex-parent flex-parent--row my3"},r.a.createElement("p",{className:"flex-child txt-bold w120"},"API key: "),r.a.createElement("p",{className:"flex-child"},r.a.createElement("span",{className:"pre pb6 pt6"},"Token ",this.props.token),r.a.createElement("a",{className:"txt--s pl6 pointer",onClick:function(t){return navigator.clipboard.writeText("Token ".concat(e.props.token))},title:"Copy Authorization Token"},r.a.createElement("svg",{className:"icon icon--m mt-neg3 inline-block align-middle color-darken25 color-darken50-on-hover transition"},r.a.createElement("use",{xlinkHref:"#icon-clipboard"}))))),this.props.token&&r.a.createElement("div",null,r.a.createElement("div",{className:"mt24 mb12"},r.a.createElement("h2",{className:"pl12 txt-xl mr6 txt-bold border-b border--gray-light border--1"},"Review Comments Template"),r.a.createElement(Fo,null))))))}}]),a}(r.a.PureComponent);function Ho(e){var t=e.href,a=(e.children,e.iconName),n=e.className;return r.a.createElement("a",{href:t,className:"".concat(n||""," btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition"),target:"_blank"},a&&r.a.createElement("svg",{className:"icon inline-block align-middle"},r.a.createElement("use",{xlinkHref:"#icon-".concat(a)})))}Lo=Object(l.b)(function(e,t){return{location:t.location,changesetId:parseInt(e.changeset.get("changesetId"),10),currentChangeset:e.changeset.getIn(["changesets",parseInt(e.changeset.get("changesetId"),10)]),oAuthToken:e.auth.get("oAuthToken"),token:e.auth.get("token"),userDetails:e.auth.getIn(["userDetails"],Object(O.Map)()),avatar:e.auth.getIn(["userDetails","avatar"])}},{logUserOut:Na,modal:fe,push:s.c})(Lo);var Go=function(e){var t=e.children;return r.a.createElement("div",{className:"flex-child flex-child--grow bg-gray-faint mx12 round p12 my6"},r.a.createElement("div",{className:"flex-parent flex-parent--row  justify--space-between"},t))};function Vo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var Wo=function(e){Object(an.a)(a,e);var t=Vo(a);function a(e){var n;return Object(en.a)(this,a),(n=t.call(this,e)).clicked=!1,n.onClick=function(e){n.clicked=!0,n.setState({editing:!0})},n.onChange=function(e){n.setState({value:e.target.value})},n.onKeyDown=function(e){13===e.keyCode?(n.setState({editing:!1}),n.props.onCreate(n.state.value)):27===e.keyCode&&(n.setState({editing:!1}),n.clicked=!1)},n.onSave=function(e){n.setState({editing:!1}),n.props.onCreate(n.state.value)},n.state={editing:!1},n}return Object(tn.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("span",null,this.state.editing?r.a.createElement("span",{className:"flex-parent flex-parent--row "},r.a.createElement("input",{placeholder:this.props.placeholder,className:"input wmax120 ml12",ref:function(t){e.clicked&&(t&&t.select(),e.clicked=!1)},value:this.state.value,onChange:this.onChange,onKeyDown:this.onKeyDown}),r.a.createElement(Fn,{className:"input wmax120 ml6",onClick:this.onSave},"Save")):r.a.createElement(Fn,{className:"input wmax120 ml12",onClick:this.onClick},"Add+"))}}]),a}(r.a.PureComponent),Jo=function(e){var t=e.data,a=e.activeAoiId,n=e.removeAoi;return r.a.createElement(Go,null,r.a.createElement("span",null,r.a.createElement("span",{className:"".concat(a===t.getIn(["id"])?"txt-bold":"")},t.getIn(["properties","name"]),a===t.getIn(["id"])?"*":""),r.a.createElement("span",{className:"txt-em color-gray pl6"},"(",t.getIn(["id"]),")")),r.a.createElement("span",null,r.a.createElement(An.a,{className:"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition",to:{search:"aoi=".concat(t.getIn(["id"])),pathname:"/filters"}},a===t.getIn(["id"])?"Active":"Load"),r.a.createElement(Fn,{className:"mr3",onClick:function(){return n(t.getIn(["id"]))}},"Remove"),r.a.createElement(Ho,{href:"".concat(y,"/aoi/").concat(t.getIn(["id"]),"/changesets/feed/"),className:"mr3",iconName:"rss"})))},zo=function(e){e.onAdd,e.onRemove;var t=e.data,a=e.TargetBlock,n=e.propsToPass,c=e.SaveComp;return r.a.createElement("div",null,t.map(function(e,t){return r.a.createElement(a,Object.assign({key:t,data:e},n))}),c)},Yo=function(e){Object(an.a)(a,e);var t=Vo(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={userValues:null},e.addToBlackList=function(t){var a=t.username,n=t.uid;a&&n&&e.props.addToBlacklist({username:a,uid:n})},e.removeFromBlackList=function(t){t&&e.props.removeFromBlacklist(t)},e.addToWhiteList=function(t){var a=t.username;a&&e.props.addToWhitelist(a)},e.removeFromWhiteList=function(t){t&&e.props.removeFromWhitelist(t)},e.loadAoiId=function(t){t&&e.props.push(Object(S.a)({},e.props.location,{search:"aoi=".concat(t),path:"/filters"}))},e.createAOI=function(t){""!==t&&t&&(e.createAOIPromise=pn(z(e.props.token,t,e.props.filters)),e.createAOIPromise.promise.then(function(t){return t&&e.loadAoiId(t.id)}).catch(function(e){return console.error(e)}))},e.removeAOI=function(t){t&&q(e.props.token,t).then(function(a){t===e.props.aoiId?e.props.applyFilters(new O.Map,"/user"):e.props.reloadData(),e.props.modal({kind:"success",title:"Filter Deleted ",description:"The ".concat(t," was deleted")})}).catch(function(t){e.props.reloadData(),e.props.modal({kind:"error",title:"Deletion failed ",error:t})})},e.onUserChange=function(t){if(Array.isArray(t)&&0===t.length)return e.setState({userValues:null});e.setState({userValues:t})},e}return Object(tn.a)(a,[{key:"componentWillUnmount",value:function(){this.createAOIPromise&&this.createAOIPromise.cancel()}},{key:"render",value:function(){return r.a.createElement("div",{className:"flex-parent flex-parent--column changesets-filters bg-white".concat(window.innerWidth<800?"viewport-full":"")},r.a.createElement("header",{className:"h55 hmin55 flex-parent px30 bg-gray-faint flex-parent--center-cross justify--space-between color-gray border-b border--gray-light border--1"},r.a.createElement("span",{className:"txt-l txt-bold color-gray--dark"},r.a.createElement("span",{className:"fl"},r.a.createElement(Sn,{size:36,url:this.props.avatar})),r.a.createElement("span",{className:"pl6 line45"},"Saved filters")),r.a.createElement("span",{className:"txt-l color-gray--dark"},r.a.createElement(Fn,{onClick:this.props.logUserOut,className:"bg-white-on-hover"},"Logout"))),r.a.createElement("div",{className:"px30 flex-child  pb60  filters-scroll"},r.a.createElement("div",{className:"flex-parent flex-parent--column align justify--space-between"},this.props.token&&r.a.createElement("div",null,r.a.createElement("div",{className:"mt24 mb12"},r.a.createElement("h2",{className:"pl12 txt-xl mr6 txt-bold border-b border--gray-light border--1"},"My saved filters"),r.a.createElement(zo,{data:this.props.data.getIn(["aoi","features"],Object(O.List)()),TargetBlock:Jo,propsToPass:{activeAoiId:this.props.aoiId,removeAoi:this.removeAOI},SaveComp:r.a.createElement(Wo,{onCreate:this.createAOI})}))))))}}]),a}(r.a.PureComponent);function Ko(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}Yo=$r(function(e){return{aoi:pn(K(e.token))}},function(e,t){return!0},Yo),Yo=Object(l.b)(function(e,t){return{location:t.location,filters:e.filters.get("filters"),oAuthToken:e.auth.get("oAuthToken"),token:e.auth.get("token"),userDetails:e.auth.getIn(["userDetails"],Object(O.Map)()),avatar:e.auth.getIn(["userDetails","avatar"]),aoiId:e.filters.getIn(["aoi","id"],null)}},{applyFilters:xt,logUserOut:Na,modal:fe,push:s.c})(Yo);var Qo=function(e){Object(an.a)(a,e);var t=Ko(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={username:"",uid:"",isValidUsername:!0,isValidUid:!0,verified:!1},e.setUsername=function(t){var a=t.target.value;e.setState({username:a,isValidUsername:!0,verified:!1})},e.setUid=function(t){var a=t.target.value;e.setState({uid:a,isValidUid:!0,verified:!1})},e.fetchUsername=function(t){return fetch("https://osm-comments-api.mapbox.com/api/v1/users/name/".concat(e.state.username)).then(J).then(function(e){return e.json()})},e.fetchUid=function(e){return fetch("https://osm-comments-api.mapbox.com/api/v1/users/id/".concat(e)).then(J).then(function(e){return e.json()})},e.verifyInput=function(){e.state.uid.length>0&&0===e.state.username.length?e.fetchUid(e.state.uid).then(function(e){return e}).then(function(e){return{uid:e.id.toString(),username:e.name}}).then(function(t){return e.setState({username:t.username,uid:t.uid,verified:!0,isValidUsername:!0,isValidUid:!0})}).catch(function(t){return e.setState({isValidUid:!1,verified:!1})}):e.state.username.length>0&&0===e.state.uid.length?e.fetchUsername(e.state.username).then(function(e){return{uid:e.id.toString(),username:e.name}}).then(function(e){return e}).then(function(t){return e.setState({username:t.username,uid:t.uid,verified:!0,isValidUsername:!0,isValidUid:!0})}).catch(function(t){return e.setState({isValidUsername:!1,verified:!1})}):e.state.uid.length>0&&e.state.username.length>0&&Promise.all([e.fetchUid(e.state.uid).then(function(e){return{uid:e.id,username:e.name}}),e.fetchUsername(e.state.username).then(function(e){return{uid:e.id,username:e.name}})]).then(function(t){t[0].uid===t[1].uid&&t[0].username===t[1].username?(window.alert("The user is valid"),e.setState({verified:!0})):e.setState({isValidUsername:!1,isValidUid:!1})}).catch(function(t){return e.setState({isValidUsername:!1,isValidUid:!1})})},e.onAdd=function(){var t=e.state.username,a=e.state.uid;t&&t.length>0&&a&&a.length>0?e.props.onSave(t,a):e.setState({isValidUsername:!1,isValidUid:!1})},e}return Object(tn.a)(a,[{key:"render",value:function(){return r.a.createElement("span",{className:"flex-parent flex-parent--row"},r.a.createElement("input",{className:"input ".concat(this.state.isValidUsername?"":"border border--1 border--red"),value:this.state.username,onChange:this.setUsername,placeholder:"Username",type:"text"}),r.a.createElement("input",{className:"input ".concat(this.state.isValidUid?"":"border border--1 border--red"),value:this.state.uid,onChange:this.setUid,placeholder:"UID",type:"text"}),r.a.createElement(Fn,{className:"btn max120 ml12 ",onClick:this.verifyInput},this.state.verified?"Verified":"Verify"),r.a.createElement(Fn,{className:"btn wmax120 ml12 ".concat(this.state.verified?"btn--green":""),onClick:this.onAdd},"Add"))}}]),a}(r.a.Component);function qo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var Xo=function(e){Object(an.a)(a,e);var t=qo(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={username:""},e.onAdd=function(){var t=e.state.username;t&&t.length>0&&(e.props.onSave(t),e.setState({username:""}))},e}return Object(tn.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("span",{className:"flex-parent flex-parent--row"},r.a.createElement("input",{className:"input",onChange:function(t){return e.setState({username:t.target.value})},placeholder:"Username",type:"text"}),r.a.createElement(Fn,{className:"btn wmax120 ml12",onClick:this.onAdd},"Add"))}}]),a}(r.a.Component);function Zo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var $o=function(e){Object(an.a)(a,e);var t=Zo(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={showInput:!1},e.onSave=function(t,a){if(e.props.forBlacklist){if(!t||!a)return;e.props.onCreate({username:t,uid:a}),e.setState({showInput:!1})}else{if(!t)return;e.props.onCreate({username:t}),e.setState({showInput:!1})}},e}return Object(tn.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("span",null,this.state.showInput?r.a.createElement("span",{className:"flex-parent flex-parent--row "},this.props.forBlacklist?r.a.createElement(Qo,{onSave:this.onSave}):r.a.createElement(Xo,{onSave:this.onSave})):r.a.createElement(Fn,{className:"input wmax120 ml12",onClick:function(){return e.setState({showInput:!0})}},"Add+"))}}]),a}(r.a.PureComponent);function es(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}var ts=function(e){var t=e.data,a=e.removeFromWhiteList;return r.a.createElement(Go,null,r.a.createElement("span",null,r.a.createElement("span",null,t)),r.a.createElement("span",null,r.a.createElement(An.a,{className:"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition",to:{search:$e("filters",{users:[{label:t,value:t}]})}},"OSMCha"),r.a.createElement(Fn,{className:"mr3",onClick:function(){return a(t)}},"Remove")))},as=function(e){e.onAdd,e.onRemove;var t=e.data,a=e.TargetBlock,n=e.propsToPass,c=e.SaveComp;return r.a.createElement("div",null,t.map(function(e,t){return r.a.createElement(a,Object.assign({key:t,data:e},n))}),c)},ns=function(e){Object(an.a)(a,e);var t=es(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={userValues:null},e.addToWhiteList=function(t){var a=t.username;a&&e.props.addToWhitelist(a)},e.removeFromWhiteList=function(t){t&&e.props.removeFromWhitelist(t)},e.onUserChange=function(t){if(Array.isArray(t)&&0===t.length)return e.setState({userValues:null});e.setState({userValues:t})},e}return Object(tn.a)(a,[{key:"render",value:function(){var e=this.props.whitelisted?this.props.whitelisted:Object(O.List)();return e=e.sortBy(function(e){return e},function(e,t){return e.localeCompare(t)}),r.a.createElement("div",{className:"flex-parent flex-parent--column changesets-filters bg-white".concat(window.innerWidth<800?"viewport-full":"")},r.a.createElement("header",{className:"h55 hmin55 flex-parent px30 bg-gray-faint flex-parent--center-cross justify--space-between color-gray border-b border--gray-light border--1"},r.a.createElement("span",{className:"txt-l txt-bold color-gray--dark"},r.a.createElement("span",{className:"fl"},r.a.createElement(Sn,{size:36,url:this.props.avatar})),r.a.createElement("span",{className:"pl6 line45"},"Trusted users")),r.a.createElement("span",{className:"txt-l color-gray--dark"},r.a.createElement(Fn,{onClick:this.props.logUserOut,className:"bg-white-on-hover"},"Logout"))),r.a.createElement("div",{className:"px30 flex-child  pb60  filters-scroll"},r.a.createElement("div",{className:"flex-parent flex-parent--column align justify--space-between"},this.props.token&&r.a.createElement("div",null,r.a.createElement("div",{className:"mt24 mb12"},r.a.createElement("h2",{className:"pl12 txt-xl mr6 txt-bold mt24 mb12 border-b border--gray-light border--1"},"My trusted users list"),r.a.createElement(as,{data:e,TargetBlock:ts,propsToPass:{removeFromWhiteList:this.removeFromWhiteList},SaveComp:r.a.createElement($o,{onCreate:this.addToWhiteList})}))))))}}]),a}(r.a.PureComponent);function rs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}ns=Object(l.b)(function(e,t){return{location:t.location,whitelisted:e.whitelist.get("whitelist"),oAuthToken:e.auth.get("oAuthToken"),token:e.auth.get("token"),userDetails:e.auth.getIn(["userDetails"],Object(O.Map)()),avatar:e.auth.getIn(["userDetails","avatar"])}},{logUserOut:Na,modal:fe,push:s.c,addToWhitelist:Ne,removeFromWhitelist:Ce})(ns);var cs=function(e){var t=e.data,a=e.removeFromBlackList;return r.a.createElement(Go,null,r.a.createElement("span",null,r.a.createElement("span",null,t.getIn(["username"])),r.a.createElement("span",{className:"txt-em color-gray pl6"},"(",t.getIn(["uid"]),")")),r.a.createElement("span",null,r.a.createElement(An.a,{className:"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition",to:{search:$e("filters",{users:[{label:t.getIn(["username"]),value:t.getIn(["username"])}]})}},"OSMCha"),r.a.createElement(Fn,{className:"mr3",onClick:function(){return a(t.getIn(["uid"]))}},"Remove")))},os=function(e){e.onAdd,e.onRemove;var t=e.data,a=e.TargetBlock,n=e.propsToPass,c=e.SaveComp;return r.a.createElement("div",null,t.map(function(e,t){return r.a.createElement(a,Object.assign({key:t,data:e},n))}),c)},ss=function(e){Object(an.a)(a,e);var t=rs(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={userValues:null},e.addToBlackList=function(t){var a=t.username,n=t.uid;a&&n&&e.props.addToBlacklist({username:a,uid:n})},e.removeFromBlackList=function(t){t&&e.props.removeFromBlacklist(t)},e.onUserChange=function(t){if(Array.isArray(t)&&0===t.length)return e.setState({userValues:null});e.setState({userValues:t})},e}return Object(tn.a)(a,[{key:"render",value:function(){var e=this.props.blacklisted?this.props.blacklisted:Object(O.List)();return e=e.sortBy(function(e){return e.get("username")},function(e,t){return e.localeCompare(t)}),r.a.createElement("div",{className:"flex-parent flex-parent--column changesets-filters bg-white".concat(window.innerWidth<800?"viewport-full":"")},r.a.createElement("header",{className:"h55 hmin55 flex-parent px30 bg-gray-faint flex-parent--center-cross justify--space-between color-gray border-b border--gray-light border--1"},r.a.createElement("span",{className:"txt-l txt-bold color-gray--dark"},r.a.createElement("span",{className:"fl"},r.a.createElement(Sn,{size:36,url:this.props.avatar})),r.a.createElement("span",{className:"pl6 line45"},"Watchlist")),r.a.createElement("span",{className:"txt-l color-gray--dark"},r.a.createElement(Fn,{onClick:this.props.logUserOut,className:"bg-white-on-hover"},"Logout"))),r.a.createElement("div",{className:"px30 flex-child  pb60  filters-scroll"},r.a.createElement("div",{className:"flex-parent flex-parent--column align justify--space-between"},this.props.token&&r.a.createElement("div",null,r.a.createElement("div",{className:"mt24 mb12"},r.a.createElement("h3",{className:"pl12 txt-xl mr6 txt-bold mt24 mb12 border-b border--gray-light border--1"},"My watchlist"),r.a.createElement(os,{data:e,TargetBlock:cs,propsToPass:{removeFromBlackList:this.removeFromBlackList},SaveComp:r.a.createElement($o,{onCreate:this.addToBlackList,forBlacklist:!0})}))),this.props.token&&r.a.createElement("span",null,r.a.createElement(An.a,{className:"input wmax140 ml12 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition",to:{search:$e("filters",{blacklist:[{label:"Yes",value:"True"}]})}},"Filter changesets")))))}}]),a}(r.a.PureComponent);function ls(e,t){return fetch("".concat(y,"/mapping-team/").concat(t,"/"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""}}).then(J)}function is(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}ss=Object(l.b)(function(e,t){return{location:t.location,blacklisted:e.blacklist.get("blacklist"),oAuthToken:e.auth.get("oAuthToken"),token:e.auth.get("token"),userDetails:e.auth.getIn(["userDetails"],Object(O.Map)()),avatar:e.auth.getIn(["userDetails","avatar"])}},{logUserOut:Na,modal:fe,push:s.c,addToBlacklist:Fe,removeFromBlacklist:Be})(ss);var us=function(e){Object(an.a)(a,e);var t=is(a);function a(e){var n;return Object(en.a)(this,a),(n=t.call(this,e)).clicked=!1,n.onClick=function(e){n.clicked=!0,n.setState({editing:!0})},n.onChangeTeamName=function(e){n.setState({teamName:e.target.value})},n.onChangeTeamUsers=function(e){n.setState({teamUsers:e.target.value})},n.onKeyDown=function(e){27===e.keyCode&&void 0===n.props.activeTeam&&(n.setState({editing:!1}),n.clicked=!1)},n.onSave=function(e){var t=n.validateData();t.valid?n.props.activeTeam?(n.props.onChange(n.props.activeTeam.get("id"),n.state.teamName,JSON.parse(n.state.teamUsers)),n.setState({validationErrorMessage:""})):(n.props.onCreate(n.state.teamName,JSON.parse(n.state.teamUsers)),n.setState({editing:!1,validationErrorMessage:""})):n.setState({validationErrorMessage:t.error})},n.state={editing:e.editing||!1,teamName:"",teamUsers:[],validationErrorMessage:""},n}return Object(tn.a)(a,[{key:"componentWillReceiveProps",value:function(e){e.activeTeam&&(this.setState({teamName:e.activeTeam.get("name")}),this.setState({teamUsers:JSON.stringify(Array.from(e.activeTeam.get("users")).map(function(e){return Object.fromEntries(e)}))}))}},{key:"validateData",value:function(){if(!this.state.teamName)return{valid:!1,error:"Team name cannot be empty."};if(!this.state.teamUsers)return{valid:!1,error:"Users cannot be empty"};try{var e=JSON.parse(this.state.teamUsers);return"object"!==typeof e?{valid:!1,error:"User must be a JSON array"}:e.filter(function(e){return e.hasOwnProperty("username")}).length===e.length?{valid:!0}:{valid:!1,error:"Each object inside the array needs to have a username property."}}catch(t){return{valid:!1,error:"Verify if you pasted a correctly formated JSON array in the users field."}}}},{key:"render",value:function(){var e=this;return r.a.createElement("span",null,this.state.editing?r.a.createElement("div",{className:"pt18"},this.props.activeTeam?r.a.createElement("span",null):r.a.createElement("h3",{className:"txt-h4 txt-bold"},"Add a new mapping team"),r.a.createElement("strong",{className:"txt-truncate pt6"},"Name"),r.a.createElement("input",{placeholder:"New team name",className:"input wmax180",ref:function(t){e.clicked&&(t&&t.select(),e.clicked=!1)},value:this.state.teamName,onChange:this.onChangeTeamName,onKeyDown:this.onKeyDown,disabled:!this.props.userIsOwner}),r.a.createElement("strong",{className:"txt-truncate pt6"},"Users"),r.a.createElement("textarea",{placeholder:'[{"username": "name"}, {"username": "other_user"}]',className:"textarea h180",ref:function(t){e.clicked&&(t&&t.select(),e.clicked=!1)},value:this.state.teamUsers,onChange:this.onChangeTeamUsers,onKeyDown:this.onKeyDown,disabled:!this.props.userIsOwner}),r.a.createElement("span",{className:"txt-light txt-truncate pt6"},"Check the"," ",r.a.createElement("a",{className:"link",href:"https://github.com/mapbox/osmcha-frontend/wiki/Mapping-Teams",target:"_blank",rel:"noopener noreferrer"},"reference")," ","about the users field JSON format."),r.a.createElement("p",{className:"txt-light txt-truncate pt6"},"The mapping team members are ",r.a.createElement("strong",null,"public")," and can be visualized by any logged in OSMCha user."),this.state.validationErrorMessage&&r.a.createElement("span",{className:"flex-parent flex-parent--row mt12 color-red-dark txt-bold"},this.state.validationErrorMessage),r.a.createElement("span",{className:"flex-parent flex-parent--row mt12"},this.props.userIsOwner&&r.a.createElement(Fn,{className:"input wmax120 ml6",onClick:this.onSave},"Save"),this.props.activeTeam?r.a.createElement(An.a,{to:{pathname:"/teams"},className:"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition input wmax120 ml6"},"Back to teams"):r.a.createElement(Fn,{className:"input wmax120 ml6",onClick:function(){return e.setState({editing:!1})}},"Cancel"))):r.a.createElement(Fn,{className:"input wmax120 ml12",onClick:this.onClick},"Add+"))}}]),a}(r.a.PureComponent),ps=function(e){var t=e.data,a=e.removeTeam;e.editTeam;return r.a.createElement(Go,null,r.a.createElement("span",null,r.a.createElement("span",null,t.get("name"))),r.a.createElement("span",null,r.a.createElement(An.a,{className:"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition",to:{search:'filters={"mapping_teams":[{"label":"'.concat(t.getIn(["name"]),'","value":"').concat(t.getIn(["name"]),'"}]}'),pathname:"/filters"}},"Filter team changesets"),r.a.createElement(An.a,{className:"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition",to:{pathname:"/teams/".concat(t.getIn(["id"]))}},"Edit"),r.a.createElement(Fn,{className:"mr3",onClick:function(){return a(t.getIn(["id"]))}},"Remove")))},ms=function(e){e.onAdd,e.onRemove;var t=e.data,a=e.TargetBlock,n=e.propsToPass,c=e.SaveComp;return r.a.createElement("div",null,t.map(function(e,t){return r.a.createElement(a,Object.assign({key:t,data:e},n))}),c)},ds=function(e){Object(an.a)(a,e);var t=is(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={userValues:null,addingTeam:!1},e.createTeam=function(t,a){""!==t&&t&&a&&(e.setState({addingTeam:!0}),e.createTeamPromise=pn(function(e,t,a){return fetch("".concat(y,"/mapping-team/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""},body:JSON.stringify({name:t,users:a})}).then(J).then(function(e){return e.json()})}(e.props.token,t,a)),e.createTeamPromise.promise.then(function(a){e.props.modal({kind:"success",title:"Team Created ",description:"The team ".concat(t," was created successfully!")}),e.props.reloadData(),e.setState({addingTeam:!1})}).catch(function(e){return console.error(e)}))},e.removeTeam=function(t){t&&ls(e.props.token,t).then(function(a){e.props.modal({kind:"success",title:"Team Deleted ",description:"The team with id ".concat(t," was deleted")}),e.props.reloadData()}).catch(function(t){e.props.reloadData(),e.props.modal({kind:"error",title:"Deletion failed ",error:t})})},e}return Object(tn.a)(a,[{key:"componentWillUnmount",value:function(){this.createTeamPromise&&this.createTeamPromise.cancel()}},{key:"render",value:function(){return r.a.createElement("div",{className:"flex-parent flex-parent--column changesets-filters bg-white".concat(window.innerWidth<800?"viewport-full":"")},r.a.createElement("header",{className:"h55 hmin55 flex-parent px30 bg-gray-faint flex-parent--center-cross justify--space-between color-gray border-b border--gray-light border--1"},r.a.createElement("span",{className:"txt-l txt-bold color-gray--dark"},r.a.createElement("span",{className:"fl"},r.a.createElement(Sn,{size:36,url:this.props.userDetails.get("avatar")})),r.a.createElement("span",{className:"pl6 line45"},"My Mapping Teams")),r.a.createElement("span",{className:"txt-l color-gray--dark"},r.a.createElement(Fn,{onClick:this.props.logUserOut,className:"bg-white-on-hover"},"Logout"))),r.a.createElement("div",{className:"px30 flex-child  pb60  filters-scroll"},r.a.createElement("div",{className:"flex-parent flex-parent--column align justify--space-between"},this.props.token&&r.a.createElement("div",null,r.a.createElement("div",{className:"mt24 mb12"},r.a.createElement("h2",{className:"pl12 txt-xl mr6 txt-bold border-b border--gray-light border--1"},"My mapping teams"),r.a.createElement(ms,{data:this.props.data.getIn(["teams"],Object(O.List)()),TargetBlock:ps,propsToPass:{removeTeam:this.removeTeam},SaveComp:r.a.createElement(us,{onCreate:this.createTeam,editing:this.state.addingTeam,userIsOwner:!0})}))))))}}]),a}(r.a.PureComponent);function hs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}ds=$r(function(e){return{teams:pn((t=e.token,a=e.userDetails.get("username"),fetch("".concat(y,"/mapping-team/?owner=").concat(a),{method:"GET",headers:{"Content-Type":"application/json",Authorization:t?"Token ".concat(t):""}}).then(J).then(function(e){return e.json()})))};var t,a},function(e,t){return!0},ds),ds=Object(l.b)(function(e,t){return{location:t.location,oAuthToken:e.auth.get("oAuthToken"),token:e.auth.get("token"),userDetails:e.auth.getIn(["userDetails"],Object(O.Map)())}},{modal:fe,logUserOut:Na,push:s.c})(ds);var fs=function(e){Object(an.a)(a,e);var t=hs(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={userValues:null},e.editTeam=function(t,a,n){""!==a&&a&&n&&(e.updateTeamPromise=pn(function(e,t,a,n){return fetch("".concat(y,"/mapping-team/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:e?"Token ".concat(e):""},body:JSON.stringify({name:a,users:n})}).then(J).then(function(e){return e.json()})}(e.props.token,t,a,n)),e.updateTeamPromise.promise.then(function(t){e.props.modal({kind:"success",title:"Team Updated ",description:"The team ".concat(a," was updated successfully!")}),e.props.reloadData()}).catch(function(t){e.props.modal({kind:"error",title:"Update failed ",error:t}),console.error(t)}))},e.removeTeam=function(t){t&&ls(e.props.token,t).then(function(a){e.props.modal({kind:"success",title:"Team Deleted ",description:"The team with id ".concat(t," was deleted")}),e.props.reloadData()}).catch(function(t){e.props.reloadData(),e.props.modal({kind:"error",title:"Deletion failed ",error:t})})},e}return Object(tn.a)(a,[{key:"componentWillUnmount",value:function(){this.createTeamPromise&&this.createTeamPromise.cancel()}},{key:"render",value:function(){return r.a.createElement("div",{className:"flex-parent flex-parent--column changesets-filters bg-white".concat(window.innerWidth<800?"viewport-full":"")},r.a.createElement("header",{className:"h55 hmin55 flex-parent px30 bg-gray-faint flex-parent--center-cross justify--space-between color-gray border-b border--gray-light border--1"},r.a.createElement("span",{className:"txt-l txt-bold color-gray--dark"},r.a.createElement("span",{className:"fl"},r.a.createElement(Sn,{size:36,url:this.props.userDetails.get("avatar")})),r.a.createElement("span",{className:"pl6 line45"},"Edit Mapping Team")),r.a.createElement("span",{className:"txt-l color-gray--dark"},r.a.createElement(Fn,{onClick:this.props.logUserOut,className:"bg-white-on-hover"},"Logout"))),this.props.token?r.a.createElement("div",{className:"px30 flex-child  pb60  filters-scroll"},r.a.createElement("div",{className:"flex-parent flex-parent--column align justify--space-between"},r.a.createElement("div",null,r.a.createElement("div",{className:"mt24 mb12"},r.a.createElement("h2",{className:"pl12 txt-xl mr6 border-b border--gray-light border--1"},r.a.createElement("strong",null,"Editing mapping team: "),this.props.data.getIn(["team","name"])),r.a.createElement(us,{onChange:this.editTeam,editing:!0,activeTeam:this.props.data.get("team"),userIsOwner:this.props.data.getIn(["team","owner"])===this.props.userDetails.get("username")}))))):r.a.createElement(Zn,null))}}]),a}(r.a.PureComponent);function gs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=Object(rn.a)(e);if(t){var r=Object(rn.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(nn.a)(this,a)}}fs=$r(function(e){return{team:pn((t=e.token,a=e.teamId,fetch("".concat(y,"/mapping-team/").concat(a,"/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:t?"Token ".concat(t):""}}).then(J).then(function(e){return e.json()})))};var t,a},function(e,t){return!0},fs),fs=Object(l.b)(function(e,t){return{location:t.location,teamId:parseInt(t.match.params.id,10),oAuthToken:e.auth.get("oAuthToken"),token:e.auth.get("token"),userDetails:e.auth.getIn(["userDetails"],Object(O.Map)())}},{modal:fe,logUserOut:Na,push:s.c})(fs);var bs=function(e){Object(an.a)(a,e);var t=gs(a);function a(){var e;Object(en.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).resize=null,e}return Object(tn.a)(a,[{key:"componentDidMount",value:function(){if(document&&document.body){var e=Ze(window.location.search).getIn(["filters"],Object(O.Map)());e&&e.size>0?(e=e.keySeq().sort(function(e,t){return e.localeCompare(t)}).join(","),zc("/?filters=".concat(e))):zc("/")}}},{key:"render",value:function(){return window.innerWidth>800?r.a.createElement("div",null,r.a.createElement("div",{className:"grid"},r.a.createElement("div",{className:"col col--3-mxl col--4-ml bg-gray--faint border-r border--gray-light border--1"},r.a.createElement(No,null),r.a.createElement(vo,null)),r.a.createElement("div",{className:"col col--9-mxl col--8-ml col--12-mm"},r.a.createElement(cn.a,{render:function(e){var t=e.location;return r.a.createElement(sn.a,{transitionName:"filters",transitionEnterTimeout:300,transitionLeaveTimeout:300},r.a.createElement(cn.a,{exact:!0,path:"/",component:Do}),r.a.createElement(cn.a,{location:t,path:"/filters",component:qc,key:t.key}),r.a.createElement(cn.a,{path:"/changesets",component:jo}),r.a.createElement(cn.a,{path:"/changesets",render:function(){return r.a.createElement(ur,{className:"z0 fixed bottom right"})}}),r.a.createElement(cn.a,{path:"/changesets/:id",component:oc}),r.a.createElement(cn.a,{path:"/about",component:ic}),r.a.createElement(cn.a,{path:"/stats",component:uc}),r.a.createElement(cn.a,{path:"/user",component:Lo}),r.a.createElement(cn.a,{exact:!0,path:"/teams",component:ds}),r.a.createElement(cn.a,{path:"/teams/:id",component:fs}),r.a.createElement(cn.a,{path:"/saved-filters",component:Yo}),r.a.createElement(cn.a,{path:"/trusted-users",component:ns}),r.a.createElement(cn.a,{path:"/watchlist",component:ss}))}}))),r.a.createElement(Po,null)):r.a.createElement("div",null,r.a.createElement("div",{className:"col"},r.a.createElement(No,null),r.a.createElement(cn.a,{exact:!0,path:"/",component:vo}),r.a.createElement(cn.a,{path:"/changesets",render:function(){return r.a.createElement(ur,{className:"z0 fixed bottom right"})}}),r.a.createElement(cn.a,{path:"/changesets/:id",component:oc}),r.a.createElement(cn.a,{path:"/about",component:ic}),r.a.createElement(cn.a,{path:"/stats",component:uc}),r.a.createElement(cn.a,{path:"/filters",component:qc}),r.a.createElement(cn.a,{path:"/user",component:Lo}),r.a.createElement(cn.a,{path:"/saved-filters",component:Yo}),r.a.createElement(cn.a,{path:"/trusted-users",component:ns}),r.a.createElement(cn.a,{path:"/watchlist",component:ss}),r.a.createElement(cn.a,{exact:!0,path:"/teams",component:ds}),r.a.createElement(cn.a,{path:"/teams/:id",component:fs})),r.a.createElement(Po,null))}}]),a}(n.Component);i.default.initialize("UA-100686765-1",{gaOptions:{anonymizeIp:!0,screenResolution:"".concat(window.screen.availWidth,"X").concat(window.screen.availHeight),appName:"PRODUCTION"}}),p.a.config("https://5637ef87f5794e2fb9e1e5fe9119688d@sentry.io/175926",{release:b,environment:"production",debug:d}).install(),o.a.render(r.a.createElement(l.a,{store:$a},r.a.createElement(s.a,{history:E},r.a.createElement(bs,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},48:function(e,t,a){e.exports=a.p+"static/media/thumbs-up.13d765c5.svg"},49:function(e,t,a){e.exports=a.p+"static/media/thumbs-down.7e04a82a.svg"},59:function(e){e.exports=[{name:"date",icontains:!1,all:!1,range:!0,display:"Date",type:"date",description:"Set the date range to view changesets created during that duration.",placeholder:"YYYY-MM-DD"},{name:"comment",icontains:!0,all:!1,range:!1,display:"Comment",type:"text",description:" Filter changesets that mention a particular keyword in its comment. This is not case-sensitive.",placeholder:"Enter a keyword like hotosm, import or fixme"},{name:"geometry",icontains:!1,range:!1,all:!1,display:"Location",type:"location",description:"Filter changesets whose bbox intersect with a location boundary.",placeholder:"Type a place on the world"},{name:"in_bbox",icontains:!1,all:!1,range:!1,display:"Bounding Box (BBox)",type:"map",description:"Scroll",placeholder:"Pan to the location of interest in the map"},{name:"area_lt",icontains:!1,range:!1,all:!1,display:"BBox size bound",type:"number",description:"Filter changesets that have a bbox area lower than X times the area of your BBox or geometry filter. For example, if the geometry you defined in your filter has an area of 1 degree and you set the 'BBox size bound' to 2, it will filter the changesets whose bbox area is lower than 2 degrees.",placeholder:"Upper bound of bbox area"},{name:"is_suspect",icontains:!1,range:!1,all:!1,display:"Show Flagged",type:"radio",options:[{label:"Yes",value:"True"},{label:"No",value:"False"}],description:"Choose to view only changesets that have been flagged, not flagged, or all. Read more about automated flagging on our About page.",placeholder:"yes / no"},{name:"reasons",icontains:!1,range:!1,all:!0,data_url:"suspicion-reasons",display:"Reasons for Flagging",type:"text_comma",description:" Select one or multiple reasons that a changeset might be flagged for.",placeholder:"Start typing to pick reasons"},{name:"checked_&_harmful",icontains:!1,range:!1,all:!1,display:"Review Status",type:"meta",metaOf:["harmful","checked"],options:[{label:"Bad only",value:{harmful:[{label:"Show Bad only",value:"True"}]}},{label:"Good only",value:{harmful:[{label:"Show Good only",value:"False"}]}},{label:"Both Good or Bad",value:{checked:[{label:"Both Good or Bad",value:"True"}]}},{label:"Not Reviewed",value:{checked:[{label:"Not Reviewed",value:"False"}]}}],placeholder:"Filter by the type of review",description:"Filter for changesets that have been manually reviewed and marked (either good or bad)"},{name:"check_date",icontains:!1,all:!1,range:!0,display:"Review Date",type:"date",description:"Set the date range to view changesets reviewed within that duration.",placeholder:"YYYY-MM-DD"},{name:"checked_by",icontains:!1,all:!1,range:!1,display:"Reviewed by",cache:!0,type:"text_comma",description:"Filter changesets that were reviewed by a user. Start typing to select one or more users. This filter requires authentication to work.",placeholder:"Enter OSM usernames"},{name:"tags",icontains:!1,range:!1,all:!0,display:"Tags",type:"text_comma",data_url:"tags",description:"Filter changesets that have one or more manually assigned Tags. Start typing to select tags.",placeholder:"Add tags"},{name:"users",icontains:!1,all:!1,range:!1,display:"Users",cache:!0,type:"text_comma",description:"Show changesets created by the users. Start typing to select one or more users.",placeholder:"Enter OSM usernames"},{name:"hide_whitelist",icontains:!1,range:!1,all:!1,display:"Hide trusted users",type:"radio",options:[{label:"Yes",value:"True"},{label:"No",value:"False"}],description:"If Yes, it will exclude the changesets created by users that you added to your trusted users list",placeholder:"Exclude changesets created by trusted users"},{name:"blacklist",icontains:!1,range:!1,all:!1,display:"Watchlisted users",type:"radio",options:[{label:"Yes",value:"True"},{label:"No",value:"False"}],description:"If Yes, it will Filter changesets created by users that you added to your Watchlist.",placeholder:"Filter changesets created by users from your Watchlist"},{name:"mapping_teams",icontains:!1,all:!1,range:!1,display:"Mapping teams",data_url:"mapping-team",type:"text_comma",description:"Show changesets created by users that are part of a Mapping Team. Start typing to select one or more teams.",placeholder:"Enter mapping teams"},{name:"exclude_teams",icontains:!1,all:!1,range:!1,display:"Hide mapping teams",data_url:"mapping-team",type:"text_comma",description:"Exclude changesets created by users that are part of a Mapping Team. Start typing to select one or more teams.",placeholder:"Enter mapping teams"},{name:"exclude_trusted_teams",icontains:!1,range:!1,all:!1,display:"Hide verified mapping teams",type:"radio",options:[{label:"Yes",value:"True"},{label:"No",value:"False"}],description:"If Yes, it will exclude the changesets created by users that are part of verified mapping teams",placeholder:"Exclude changesets created by users from verified teams"},{name:"create",icontains:!1,all:!1,range:!0,display:"Objects Created",type:"number",description:"Filter changesets whose number of elements created are greater than or equal to and/or lesser than or equal to a number.",placeholder:"eg. 500"},{name:"modify",icontains:!1,all:!1,range:!0,display:"Objects Modified",type:"number",description:"Filter changesets whose number of elements modified are greater than or equal to and/or lesser than or equal to a number.",placeholder:"eg. 500"},{name:"delete",icontains:!1,all:!1,range:!0,display:"Objects Deleted",type:"number",description:"Filter changesets whose number of elements deleted are greater than or equal to and/or lesser than or equal to a number.",placeholder:"eg. 500"},{name:"source",icontains:!0,all:!1,range:!1,display:"Source",type:"text",description:"Filter changesets by text in its source field. This is not case-sensitive.",placeholder:"eg. Bing, Local"},{name:"editor",icontains:!0,all:!1,range:!1,display:"Editor",type:"text",description:"Filter changesets by text in its source field. This is not case-sensitive.",placeholder:"eg. iD, JOSM"},{name:"imagery_used",icontains:!0,all:!1,range:!1,display:"Imagery used",type:"text",description:"Filter changesets by text in its imagery_used field. This is not case-sensitive.",placeholder:"eg. Bing, Mapbox"},{name:"ids",icontains:!1,range:!1,all:!1,display:"Changeset IDs",type:"text_comma",description:"Filter changesets by its ID. Use commas to search for more than one id.",placeholder:"Enter Changeset IDs"},{name:"metadata",icontains:!1,all:!1,range:!1,display:"Other metadata",type:"text",description:"Filter changesets by any other metadata that is not present on the fields above. You can combine more than one filter, separated by commas.",placeholder:"eg. changesets_count__max=50,hashtags=#hotosm-project"},{name:"order_by",icontains:!1,range:!1,all:!1,display:"Order by",type:"radio",options:[{label:"Ascending ID",value:"id"},{label:"Ascending Date",value:"date"},{label:"Ascending check date",value:"check_date"},{label:"Ascending object created",value:"create"},{label:"Ascending object modified",value:"modify"},{label:"Ascending object deleted",value:"delete"},{label:"Descending ID",value:"-id"},{label:"Descending Date",value:"-date"},{label:"Descending check date",value:"-check_date"},{label:"Descending object created",value:"-create"},{label:"Descending object modified",value:"-modify"},{label:"Descending object deleted",value:"-delete"}],description:"Order the Changesets by one of the following fields: id, date, check_date, create, modify or delete. Use a minus sign (-) before the field name to reverse the ordering. Default ordering is '-id'.",placeholder:"Asceding/Descending "},{name:"powerfull_editor",ignore:!0,icontains:!1,range:!1,all:!1,display:"Powerful editor",type:"text",description:"Filter changesets that were created using a software editor considered powerful (those that allow to create, modify or delete data in a batch).",placeholder:""}]},97:function(e,t){e.exports="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4gIcSUNDX1BST0ZJTEUAAQEAAAIMbGNtcwIQAABtbnRyUkdCIFhZWiAH3AABABkAAwApADlhY3NwQVBQTAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9tYAAQAAAADTLWxjbXMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAApkZXNjAAAA/AAAAF5jcHJ0AAABXAAAAAt3dHB0AAABaAAAABRia3B0AAABfAAAABRyWFlaAAABkAAAABRnWFlaAAABpAAAABRiWFlaAAABuAAAABRyVFJDAAABzAAAAEBnVFJDAAABzAAAAEBiVFJDAAABzAAAAEBkZXNjAAAAAAAAAANjMgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB0ZXh0AAAAAElYAABYWVogAAAAAAAA9tYAAQAAAADTLVhZWiAAAAAAAAADFgAAAzMAAAKkWFlaIAAAAAAAAG+iAAA49QAAA5BYWVogAAAAAAAAYpkAALeFAAAY2lhZWiAAAAAAAAAkoAAAD4QAALbPY3VydgAAAAAAAAAaAAAAywHJA2MFkghrC/YQPxVRGzQh8SmQMhg7kkYFUXdd7WtwegWJsZp8rGm/fdPD6TD////bAEMAAgMDAwQDBAUFBAYGBgYGCAgHBwgIDQkKCQoJDRMMDgwMDgwTERQRDxEUER4YFRUYHiMdHB0jKiUlKjUyNUVFXP/bAEMBAgMDAwQDBAUFBAYGBgYGCAgHBwgIDQkKCQoJDRMMDgwMDgwTERQRDxEUER4YFRUYHiMdHB0jKiUlKjUyNUVFXP/AABEIAEAAQAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/AP2YooooAKKz7u8ito9z9T0UdSa4eXWb1z8pCD0Az+poA9IorzeLWb1D8xDj0Ix+oruLS8iuY9ydR1U9QaANCiiigAooooA8v1Scy3snPCHaPwrHq3d/8fU//XRv51UoAK2NLnMV7Hzw52n8ax6t2n/H1B/10X+dAHrtFFFABRRTHdEUszBQO5OBQBwOs2jJOZgPlfr7N/8AXrmK9En1ixAK4MgPUAcH8689JBY4GBk4FADa6fRrRnnExHyp092/+tXNAgMMjIyMivQoNYsSAuDGB0BHA/KgDpKKYjo6hlYMD3ByKfQBmX17Haxbjyx4VfU/4V5rcXM1w+6Rs+g7D6CtLWJGe+cHogCj+dYVABRRRQAUUUUAW7e5mt33Rtj1HY/UV6VY3sd1FuHDDhl9D/hXlVbujyMl8gHRwVP86AP/2Q=="}},[[157,1,2]]]);
//# sourceMappingURL=main.3f4a15fa.chunk.js.map